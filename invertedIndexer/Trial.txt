
<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">
<head>
<meta charset="UTF-8" />
<title>Inverted index - Rosetta Code</title>
<script src="/cdn-cgi/apps/head/7qaJovFEYxjqsAZAxmfekTkNrFg.js"></script><script type="text/javascript">
//<![CDATA[
window.__cfRocketOptions = {byc:0,p:0,petok:"af94a2beb526d3c634909145e78c4656aef01939-1520191471-1800"};
//]]>
</script>
<script type="text/javascript" src="https://ajax.cloudflare.com/cdn-cgi/scripts/935cb224/cloudflare-static/rocket.min.js"></script>
<script type="text/rocketscript">document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script type="text/rocketscript">window.RLQ = window.RLQ || []; window.RLQ.push( function () {
mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":!1,"wgNamespaceNumber":0,"wgPageName":"Inverted_index","wgTitle":"Inverted index","wgCurRevisionId":255072,"wgRevisionId":255072,"wgArticleId":7088,"wgIsArticle":!0,"wgIsRedirect":!1,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["Programming Tasks","Classic CS problems and programs","Search","Ada","AutoHotkey","BBC BASIC","C","C++","C sharp","Clojure","CoffeeScript","Common Lisp","D","EchoLisp","Erlang","Factor","F Sharp","Go","Haskell","Icon","Unicon","J","Java","Jq","Kotlin","OCaml","Perl","Perl 6","Phix","PHP","PicoLisp","PowerShell","Python","Racket","REXX","Ruby","Scala","Tcl","TUSCRIPT","UNIX Shell","UNIX Shell examples needing attention","Examples needing attention"],"wgBreakFrames":!1,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January",
"February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Inverted_index","wgRelevantArticleId":7088,"wgIsProbablyEditable":!0,"wgRestrictionEdit":[],"wgRestrictionMove":[],"sfgAutocompleteValues":[],"sfgAutocompleteOnAllChars":!1,"sfgFieldProperties":[],"sfgDependentFields":[],"sfgShowOnSelect":[],"sfgScriptPath":"/mw/extensions/SemanticForms","sdgDownArrowImage":"/mw/extensions/SemanticDrilldown/skins/down-arrow.png","sdgRightArrowImage":"/mw/extensions/SemanticDrilldown/skins/right-arrow.png"});mw.loader.implement("user.options",function($,jQuery){mw.user.options.set({"variant":"en"});});mw.loader.implement("user.tokens",function($,jQuery){mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\"});});mw.loader.load(["ext.smw.style","ext.smw.tooltips","mediawiki.page.startup","mediawiki.legacy.wikibits"]);
} );</script>
<link rel="stylesheet" href="/mw/load.php?debug=false&amp;lang=en&amp;modules=ext.bootstrap.styles&amp;only=styles&amp;skin=chameleon" />
<meta name="ResourceLoaderDynamicStyles" content="" />
<link rel="stylesheet" href="/mw/load.php?debug=false&amp;lang=en&amp;modules=site&amp;only=styles&amp;skin=chameleon" />
<style>a:lang(ar),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}</style>
<script async="" data-rocketsrc="/mw/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=chameleon" type="text/rocketscript"></script>
<meta name="generator" content="MediaWiki 1.26.2" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="ExportRDF" type="application/rdf+xml" title="Inverted index" href="/mw/index.php?title=Special:ExportRDF/Inverted_index&amp;xmlmime=rdf" />
<link rel="alternate" type="application/x-wiki" title="Edit" href="/mw/index.php?title=Inverted_index&amp;action=edit" />
<link rel="edit" title="Edit" href="/mw/index.php?title=Inverted_index&amp;action=edit" />
<link rel="shortcut icon" href="/favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="/mw/opensearch_desc.php" title="Rosetta Code (en)" />
<link rel="EditURI" type="application/rsd+xml" href="https://rosettacode.org/mw/api.php?action=rsd" />
<link rel="copyright" href="http://www.gnu.org/licenses/fdl-1.2.html" />
<link rel="alternate" type="application/atom+xml" title="Rosetta Code Atom feed" href="/mw/index.php?title=Special:RecentChanges&amp;feed=atom" />
</head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Inverted_index layout-standard skin-chameleon action-view">
<div class="container">
<div class="row">
<div class="col-lg-3">

<div id="p-logo" class="p-logo" role="banner">
<a href="/wiki/Rosetta_Code" title="Visit the main page"><img src="/mw/title.png" alt="Rosetta Code" /></a>
</div>
</div>
<div class="col-lg-9">
<div class="row">
<div class="col-lg-12">

<div class="p-personal pull-right" id="p-personal">
<ul class="p-personal-tools list-inline pull-right">
<li id="pt-createaccount"><a href="/mw/index.php?title=Special:UserLogin&amp;returnto=Inverted+index&amp;type=signup" title="You are encouraged to create an account and log in; however, it is not mandatory">Create account</a></li>
<li id="pt-login"><a href="/mw/index.php?title=Special:UserLogin&amp;returnto=Inverted+index" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>
</ul>
<div class="newtalk-notifier">
</div>
</div>
</div>
</div>
<div class="row">
<div class="col-lg-12">

<div id="p-search" class="p-search pull-right" role="search">
<form id="searchform" class="mw-search form-inline" action="/mw/index.php">
<input type="hidden" name="title" value="Special:Search" />
<div class="input-group">
<input name="search" placeholder="Search" title="Search Rosetta Code [f]" accesskey="f" id="searchInput" class="form-control" />
<div class="input-group-btn">
<button value="Go" id="searchGoButton" name="go" title="Go to a page with this exact name if it exists" type="submit" class="searchGoButton btn btn-default"><span class="glyphicon glyphicon-share-alt"></span></button><button value="Search" id="mw-searchButton" name="fulltext" title="Search the pages for this text" type="submit" class="mw-searchButton btn btn-default"><span class="glyphicon glyphicon-search"></span></button>
</div>
</div>
</form>
</div>
</div>
</div>
</div>
</div>
<div class="row">
<div class="col-lg-12">

<nav class="navbar navbar-default p-navbar" role="navigation" id="mw-navigation">
<div class="container-fluid"><div class="navbar-header">
<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#mw-navigation-collapse">
<span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
</div>
<div class="collapse navbar-collapse" id="mw-navigation-collapse"><ul class="nav navbar-nav">

<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown">Community <b class="caret"></b></a>
<ul class="dropdown-menu p-Community" id="p-Community">
<li id="n-Twitter"><a href="http://twitter.com/rosettacode" rel="nofollow">Twitter</a></li>
<li id="n-Chat.2FIRC"><a href="/wiki/Special:WebChat">Chat/IRC</a></li>
<li id="n-Planet"><a href="http://rosettacode.org/planet" rel="nofollow">Planet</a></li>
<li id="n-The-Village-Pump"><a href="/wiki/Rosetta_Code:Village_Pump">The Village Pump</a></li>
<li id="n-Finances"><a href="/wiki/Rosetta_Code:Finances">Finances</a></li>
</ul>
</li>

<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown">Explore <b class="caret"></b></a>
<ul class="dropdown-menu p-Explore" id="p-Explore">
<li id="n-Languages"><a href="/wiki/Category:Programming_Languages">Languages</a></li>
<li id="n-Tasks"><a href="/wiki/Category:Programming_Tasks">Tasks</a></li>
<li id="n-recentchanges"><a href="/wiki/Special:RecentChanges" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
<li id="n-Similar-sites"><a href="/wiki/Help:Similar_Sites">Similar sites</a></li>
<li id="n-randompage"><a href="/wiki/Special:Random" title="Load a random page [x]" accesskey="x">Random page</a></li>
</ul>
</li></ul>
</div>
</div>
</nav>
</div>
</div>
<div class="row">
<div class="col-lg-12">

<ul class="p-contentnavigation list-inline text-center" id="p-contentnavigation">

<li id="p-namespaces">
<ul class="list-inline">
<li id="ca-nstab-main" class="selected"><a href="/wiki/Inverted_index" title="View the content page [c]" accesskey="c" class="selected">Page</a></li>
<li id="ca-talk"><a href="/wiki/Talk:Inverted_index" rel="discussion" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>
</ul>
</li>

<li id="p-views">
<ul class="list-inline">
<li id="ca-edit"><a href="/mw/index.php?title=Inverted_index&amp;action=edit" title="Edit this page [e]" accesskey="e">Edit</a></li>
<li id="ca-history"><a href="/mw/index.php?title=Inverted_index&amp;action=history" title="Past revisions of this page [h]" accesskey="h">History</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="row">
<div class="col-lg-12">
</div>
</div>
<div class="row">
<div class="col-lg-12">

<div id="content" class="mw-body"><a id="top"></a>
<div id="mw-js-message" style="display:none;"></div>
<div class="contentHeader">

<h1 id="firstHeading" class="firstHeading">Inverted index</h1>

<div id="siteSub">From Rosetta Code</div><div id="jump-to-nav" class="mw-jump">Jump to:<a href="#mw-navigation">navigation</a>, <a href="#p-search">search</a></div>
</div><div id="bodyContent">

<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="infobox" style="width: 2in"><div class="floatleft"><a href="/wiki/Category:Solutions_by_Programming_Task" title="Category:Solutions by Programming Task"><img alt="Task" src="/mw/images/thumb/b/ba/Rcode-button-task-crushed.png/64px-Rcode-button-task-crushed.png" width="64" height="64" srcset="/mw/images/thumb/b/ba/Rcode-button-task-crushed.png/96px-Rcode-button-task-crushed.png 1.5x, /mw/images/thumb/b/ba/Rcode-button-task-crushed.png/128px-Rcode-button-task-crushed.png 2x" /></a></div><b>Inverted index</b><br />
You are encouraged to <a href="/wiki/Rosetta_Code:Solve_a_Task" title="Rosetta Code:Solve a Task">solve this task</a> according to the task description, using any language you may know.</div>
<p>An <a href="http://en.wikipedia.org/wiki/Inverted_index" class="extiw" title="wp:Inverted index">Inverted Index</a> is a data structure used to create full text search.
</p><p><br />
</p>
<dl><dt>Task</dt>
<dd></dd></dl>
<p>Given a set of text files, implement a program to create an inverted index.
</p><p>Also create a user interface to do a search using that inverted index which returns a list of files that contain the query term / terms.
</p><p>The search index can be in memory.
<br /><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Ada"><span class="tocnumber">1</span> <span class="toctext">Ada</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Main_program"><span class="tocnumber">1.1</span> <span class="toctext">Main program</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Package_Generic_Inverted_Index"><span class="tocnumber">1.2</span> <span class="toctext">Package Generic_Inverted_Index</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Package_Parse_Lines"><span class="tocnumber">1.3</span> <span class="toctext">Package Parse_Lines</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Alternative_Implementation_of_Generic_Inverted_Index_.28Ada_2012.29"><span class="tocnumber">1.4</span> <span class="toctext">Alternative Implementation of Generic_Inverted_Index (Ada 2012)</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="#AutoHotkey"><span class="tocnumber">2</span> <span class="toctext">AutoHotkey</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#BBC_BASIC"><span class="tocnumber">3</span> <span class="toctext">BBC BASIC</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#C"><span class="tocnumber">4</span> <span class="toctext">C</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#C.2B.2B"><span class="tocnumber">5</span> <span class="toctext">C++</span></a></li>
<li class="toclevel-1 tocsection-10"><a href="#C.23"><span class="tocnumber">6</span> <span class="toctext">C#</span></a></li>
<li class="toclevel-1 tocsection-11"><a href="#Clojure"><span class="tocnumber">7</span> <span class="toctext">Clojure</span></a></li>
<li class="toclevel-1 tocsection-12"><a href="#CoffeeScript"><span class="tocnumber">8</span> <span class="toctext">CoffeeScript</span></a></li>
<li class="toclevel-1 tocsection-13"><a href="#Common_Lisp"><span class="tocnumber">9</span> <span class="toctext">Common Lisp</span></a></li>
<li class="toclevel-1 tocsection-14"><a href="#D"><span class="tocnumber">10</span> <span class="toctext">D</span></a></li>
<li class="toclevel-1 tocsection-15"><a href="#EchoLisp"><span class="tocnumber">11</span> <span class="toctext">EchoLisp</span></a>
<ul>
<li class="toclevel-2 tocsection-16"><a href="#Indexing"><span class="tocnumber">11.1</span> <span class="toctext">Indexing</span></a></li>
<li class="toclevel-2 tocsection-17"><a href="#Query"><span class="tocnumber">11.2</span> <span class="toctext">Query</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-18"><a href="#Erlang"><span class="tocnumber">12</span> <span class="toctext">Erlang</span></a></li>
<li class="toclevel-1 tocsection-19"><a href="#Factor"><span class="tocnumber">13</span> <span class="toctext">Factor</span></a></li>
<li class="toclevel-1 tocsection-20"><a href="#F.23"><span class="tocnumber">14</span> <span class="toctext">F#</span></a></li>
<li class="toclevel-1 tocsection-21"><a href="#Go"><span class="tocnumber">15</span> <span class="toctext">Go</span></a></li>
<li class="toclevel-1 tocsection-22"><a href="#Haskell"><span class="tocnumber">16</span> <span class="toctext">Haskell</span></a></li>
<li class="toclevel-1 tocsection-23"><a href="#Icon_and_Unicon"><span class="tocnumber">17</span> <span class="toctext">Icon and Unicon</span></a></li>
<li class="toclevel-1 tocsection-24"><a href="#J"><span class="tocnumber">18</span> <span class="toctext">J</span></a></li>
<li class="toclevel-1 tocsection-25"><a href="#Java"><span class="tocnumber">19</span> <span class="toctext">Java</span></a></li>
<li class="toclevel-1 tocsection-26"><a href="#jq"><span class="tocnumber">20</span> <span class="toctext">jq</span></a></li>
<li class="toclevel-1 tocsection-27"><a href="#Kotlin"><span class="tocnumber">21</span> <span class="toctext">Kotlin</span></a></li>
<li class="toclevel-1 tocsection-28"><a href="#OCaml"><span class="tocnumber">22</span> <span class="toctext">OCaml</span></a></li>
<li class="toclevel-1 tocsection-29"><a href="#Perl"><span class="tocnumber">23</span> <span class="toctext">Perl</span></a></li>
<li class="toclevel-1 tocsection-30"><a href="#Perl_6"><span class="tocnumber">24</span> <span class="toctext">Perl 6</span></a></li>
<li class="toclevel-1 tocsection-31"><a href="#Phix"><span class="tocnumber">25</span> <span class="toctext">Phix</span></a></li>
<li class="toclevel-1 tocsection-32"><a href="#PHP"><span class="tocnumber">26</span> <span class="toctext">PHP</span></a></li>
<li class="toclevel-1 tocsection-33"><a href="#PicoLisp"><span class="tocnumber">27</span> <span class="toctext">PicoLisp</span></a></li>
<li class="toclevel-1 tocsection-34"><a href="#PowerShell"><span class="tocnumber">28</span> <span class="toctext">PowerShell</span></a></li>
<li class="toclevel-1 tocsection-35"><a href="#Python"><span class="tocnumber">29</span> <span class="toctext">Python</span></a>
<ul>
<li class="toclevel-2 tocsection-36"><a href="#Simple_inverted_index"><span class="tocnumber">29.1</span> <span class="toctext">Simple inverted index</span></a></li>
<li class="toclevel-2 tocsection-37"><a href="#Full_inverted_index"><span class="tocnumber">29.2</span> <span class="toctext">Full inverted index</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-38"><a href="#Racket"><span class="tocnumber">30</span> <span class="toctext">Racket</span></a></li>
<li class="toclevel-1 tocsection-39"><a href="#REXX"><span class="tocnumber">31</span> <span class="toctext">REXX</span></a></li>
<li class="toclevel-1 tocsection-40"><a href="#Ruby"><span class="tocnumber">32</span> <span class="toctext">Ruby</span></a></li>
<li class="toclevel-1 tocsection-41"><a href="#Scala"><span class="tocnumber">33</span> <span class="toctext">Scala</span></a></li>
<li class="toclevel-1 tocsection-42"><a href="#Tcl"><span class="tocnumber">34</span> <span class="toctext">Tcl</span></a></li>
<li class="toclevel-1 tocsection-43"><a href="#TUSCRIPT"><span class="tocnumber">35</span> <span class="toctext">TUSCRIPT</span></a></li>
<li class="toclevel-1 tocsection-44"><a href="#UNIX_Shell"><span class="tocnumber">36</span> <span class="toctext">UNIX Shell</span></a>
<ul>
<li class="toclevel-2 tocsection-45"><a href="#Associative_array"><span class="tocnumber">36.1</span> <span class="toctext">Associative array</span></a></li>
<li class="toclevel-2 tocsection-46"><a href="#Directory_on_filesystem"><span class="tocnumber">36.2</span> <span class="toctext">Directory on filesystem</span></a></li>
</ul>
</li>
</ul>
</div>
<h2><span class="mw-headline" id="Ada"><a href="/wiki/Category:Ada" title="Category:Ada">Ada</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/mw/index.php?title=Inverted_index&amp;action=edit&amp;section=1" title="Edit section: Ada">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<h3><span class="mw-headline" id="Main_program">Main program</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/mw/index.php?title=Inverted_index&amp;action=edit&amp;section=2" title="Edit section: Main program">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Here is the main program (file inverted_index.adb):
</p>
<pre class="ada highlighted_source"><span class="kw3">with</span> Ada.<span class="me1">Text_IO</span>, Generic_Inverted_Index, Ada.<span class="me1">Strings</span>.<span class="me1">Hash</span>, Parse_Lines;<br /><span class="kw3">use</span> Ada.<span class="me1">Text_IO</span>;<br />&#160;<br /><span class="kw3">procedure</span> Inverted_Index <span class="kw1">is</span><br />&#160;<br />   <span class="kw3">type</span> Process_Word <span class="kw1">is</span> <span class="kw3">access</span> <span class="kw3">procedure</span> <span class="br0">&#40;</span>Word: String<span class="br0">&#41;</span>;<br />&#160;<br />   <span class="kw3">package</span> Inv_Idx <span class="kw1">is</span> <span class="kw3">new</span> Generic_Inverted_Index<br />     <span class="br0">&#40;</span>Source_Type =&gt; String,<br />      Item_Type   =&gt; String,<br />      Hash        =&gt; Ada.<span class="me1">Strings</span>.<span class="me1">Hash</span><span class="br0">&#41;</span>;<br />&#160;<br />   <span class="kw3">use</span> Inv_Idx;<br />&#160;<br />   <span class="kw3">procedure</span> Output<span class="br0">&#40;</span>Sources: Source_Vecs.<span class="me1">Vector</span><span class="br0">&#41;</span> <span class="kw1">is</span><br />      Any_Output: Boolean&#160;:= False;<br />&#160;<br />      <span class="kw3">procedure</span> Print_Source<span class="br0">&#40;</span>S: String<span class="br0">&#41;</span> <span class="kw1">is</span><br />      <span class="kw1">begin</span><br />         <span class="kw1">if</span> <span class="kw2">not</span> Any_Output <span class="kw1">then</span> <span class="co1">-- this is the first source found</span><br />            Put<span class="br0">&#40;</span><span class="st0">&quot;Found in the following files: &quot;</span><span class="br0">&#41;</span>;<br />            Any_Output&#160;:= True;<br />         <span class="kw1">else</span> <span class="co1">-- there has been at least one source before</span><br />            Put<span class="br0">&#40;</span><span class="st0">&quot;, &quot;</span><span class="br0">&#41;</span>;<br />         <span class="kw1">end</span> <span class="kw1">if</span>;<br />         Put<span class="br0">&#40;</span>S<span class="br0">&#41;</span>;<br />      <span class="kw1">end</span> Print_Source;<br />&#160;<br />      <span class="kw3">procedure</span> Print <span class="kw1">is</span> <span class="kw3">new</span> Inv_Idx.<span class="me1">Iterate</span><span class="br0">&#40;</span>Print_Source<span class="br0">&#41;</span>;<br />&#160;<br />   <span class="kw1">begin</span><br />      Print<span class="br0">&#40;</span>Sources<span class="br0">&#41;</span>;<br />      <span class="kw1">if</span> <span class="kw2">not</span> Any_Output <span class="kw1">then</span><br />         Put<span class="br0">&#40;</span><span class="st0">&quot;I did not find this in any of the given files!&quot;</span><span class="br0">&#41;</span>;<br />      <span class="kw1">end</span> <span class="kw1">if</span>;<br />      New_Line<span class="br0">&#40;</span><span class="nu0">2</span><span class="br0">&#41;</span>;<br />   <span class="kw1">end</span> Output;<br />&#160;<br />   <span class="kw3">procedure</span> Read_From_File<span class="br0">&#40;</span>Table: <span class="kw3">in</span> <span class="kw3">out</span> Storage_Type;<br />                            Filename: String<span class="br0">&#41;</span> <span class="kw1">is</span><br />      F: File_Type;<br />&#160;<br />      <span class="kw3">procedure</span> Enter_Word<span class="br0">&#40;</span>S: String<span class="br0">&#41;</span> <span class="kw1">is</span><br />      <span class="kw1">begin</span><br />         Table.<span class="me1">Store</span><span class="br0">&#40;</span>Source =&gt; Filename,  Item =&gt; S<span class="br0">&#41;</span>;<br />      <span class="kw1">end</span> Enter_Word;<br />&#160;<br />      <span class="kw3">procedure</span> Store_Words <span class="kw1">is</span> <span class="kw3">new</span><br />        Parse_Lines.<span class="me1">Iterate_Words</span><span class="br0">&#40;</span>Parse_Lines.<span class="me1">Word_Pattern</span>, Enter_Word<span class="br0">&#41;</span>;<br />&#160;<br />   <span class="kw1">begin</span><br />      Open<span class="br0">&#40;</span>File =&gt; F, Mode =&gt; In_File, Name =&gt; Filename<span class="br0">&#41;</span>;<br />       <span class="kw1">while</span> <span class="kw2">not</span> End_Of_File<span class="br0">&#40;</span>F<span class="br0">&#41;</span> <span class="kw1">loop</span><br />          Store_Words<span class="br0">&#40;</span>Get_Line<span class="br0">&#40;</span>F<span class="br0">&#41;</span><span class="br0">&#41;</span>;<br />      <span class="kw1">end</span> <span class="kw1">loop</span>;<br />      Close<span class="br0">&#40;</span>F<span class="br0">&#41;</span>;<br />   <span class="kw1">exception</span><br />      <span class="kw3">when</span> <span class="kw3">others</span> =&gt;<br />         Put_Line<span class="br0">&#40;</span><span class="st0">&quot;Something wrong with File '&quot;</span> &amp; Filename &amp; <span class="st0">&quot;'&quot;</span><span class="br0">&#41;</span>;<br />         Put_Line<span class="br0">&#40;</span><span class="st0">&quot;I'll ignore this!&quot;</span><span class="br0">&#41;</span>;<br />   <span class="kw1">end</span> Read_From_File;<br />&#160;<br />   <span class="kw3">procedure</span> Read_Files<span class="br0">&#40;</span>Tab: <span class="kw3">out</span> Storage_Type; Line: <span class="kw3">in</span> String<span class="br0">&#41;</span> <span class="kw1">is</span><br />&#160;<br />      <span class="kw3">procedure</span> Read_File<span class="br0">&#40;</span>S: String<span class="br0">&#41;</span> <span class="kw1">is</span><br />      <span class="kw1">begin</span><br />         Read_From_File<span class="br0">&#40;</span>Tab, S<span class="br0">&#41;</span>;<br />      <span class="kw1">end</span> Read_File;<br />&#160;<br />      <span class="kw3">procedure</span> Read_All <span class="kw1">is</span> <span class="kw3">new</span><br />        Parse_Lines.<span class="me1">Iterate_Words</span><span class="br0">&#40;</span>Parse_Lines.<span class="me1">Filename_Pattern</span>, Read_File<span class="br0">&#41;</span>;<br />&#160;<br />   <span class="kw1">begin</span><br />      Read_All<span class="br0">&#40;</span>Line<span class="br0">&#41;</span>;<br />   <span class="kw1">end</span> Read_Files;<br />&#160;<br />   S: Storage_Type;<br />   Done: Boolean&#160;:= False;<br />&#160;<br /><span class="kw1">begin</span><br />   Put_Line<span class="br0">&#40;</span><span class="st0">&quot;Enter Filenames:&quot;</span><span class="br0">&#41;</span>;<br />   Read_Files<span class="br0">&#40;</span>S, Get_Line<span class="br0">&#41;</span>;<br />   New_Line;<br />&#160;<br />   <span class="kw1">while</span> <span class="kw2">not</span> Done <span class="kw1">loop</span><br />      Put_Line<span class="br0">&#40;</span><span class="st0">&quot;Enter one or more words to search for; &lt;return&gt; to finish:&quot;</span><span class="br0">&#41;</span>;<br />      <span class="kw1">declare</span><br />         Words: String&#160;:= Get_Line;<br />         First: Boolean&#160;:= True;<br />         Vec: Source_Vecs.<span class="me1">Vector</span>&#160;:= Source_Vecs.<span class="me1">Empty_Vector</span>;<br />&#160;<br />         <span class="kw3">procedure</span> Compute_Vector<span class="br0">&#40;</span>Item: String<span class="br0">&#41;</span> <span class="kw1">is</span><br />         <span class="kw1">begin</span><br />            <span class="kw1">if</span> First <span class="kw1">then</span><br />               Vec&#160;:= S.<span class="me1">Find</span><span class="br0">&#40;</span>Item<span class="br0">&#41;</span>;<br />               First&#160;:= False;<br />            <span class="kw1">else</span><br />               Vec&#160;:= Vec <span class="kw2">and</span> S.<span class="me1">Find</span><span class="br0">&#40;</span>Item<span class="br0">&#41;</span>;<br />            <span class="kw1">end</span> <span class="kw1">if</span>;<br />         <span class="kw1">end</span> Compute_Vector;<br />&#160;<br />         <span class="kw3">procedure</span> Compute <span class="kw1">is</span> <span class="kw3">new</span><br />           Parse_Lines.<span class="me1">Iterate_Words</span><span class="br0">&#40;</span>Parse_Lines.<span class="me1">Word_Pattern</span>, Compute_Vector<span class="br0">&#41;</span>;<br />&#160;<br />      <span class="kw1">begin</span><br />         <span class="kw1">if</span> Words = <span class="st0">&quot;&quot;</span> <span class="kw1">then</span><br />            Done&#160;:= True;<br />         <span class="kw1">else</span><br />            Compute<span class="br0">&#40;</span>Words<span class="br0">&#41;</span>;<br />            Output<span class="br0">&#40;</span>Vec<span class="br0">&#41;</span>;<br />         <span class="kw1">end</span> <span class="kw1">if</span>;<br />      <span class="kw1">end</span>;<br />   <span class="kw1">end</span> <span class="kw1">loop</span>;<br /><span class="kw1">end</span> Inverted_Index;</pre>
<p>A sample output:
</p>
<pre>Enter Filenames:
0.txt 1.txt 2.txt

Enter one or more words to search for; &lt;return&gt; to finish:
it 
Found in the following files: 0.txt, 1.txt, 2.txt

Enter one or more words to search for; &lt;return&gt; to finish:
that
I did not find this in any of the given files!

Enter one or more words to search for; &lt;return&gt; to finish:
what is it
Found in the following files: 0.txt, 1.txt

Enter one or more words to search for; &lt;return&gt; to finish:
</pre>
<h3><span class="mw-headline" id="Package_Generic_Inverted_Index">Package Generic_Inverted_Index</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/mw/index.php?title=Inverted_index&amp;action=edit&amp;section=3" title="Edit section: Package Generic Inverted Index">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The real work is actually done in the package Generic_Inverted_Index. Here is the specification (file generic_inverted_index.ads):
</p>
<pre class="ada highlighted_source"><span class="kw3">with</span> Ada.<span class="me1">Containers</span>.<span class="me1">Indefinite_Vectors</span>;<br /><span class="kw3">private</span> <span class="kw3">with</span> Ada.<span class="me1">Containers</span>.<span class="me1">Indefinite_Hashed_Maps</span>;<br />&#160;<br /><span class="kw3">generic</span><br />   <span class="kw3">type</span> Source_Type <span class="br0">&#40;</span>&lt;&gt;<span class="br0">&#41;</span> <span class="kw1">is</span> <span class="kw3">private</span>;<br />   <span class="kw3">type</span> Item_Type <span class="br0">&#40;</span>&lt;&gt;<span class="br0">&#41;</span> <span class="kw1">is</span> <span class="kw3">private</span>;<br />   <span class="kw3">with</span> <span class="kw3">function</span> Hash<span class="br0">&#40;</span>Item: Item_Type<span class="br0">&#41;</span> <span class="kw1">return</span> Ada.<span class="me1">Containers</span>.<span class="me1">Hash_Type</span> <span class="kw1">is</span> &lt;&gt;;<br /><span class="kw3">package</span> Generic_Inverted_Index <span class="kw1">is</span><br />&#160;<br />   <span class="kw3">type</span> Storage_Type <span class="kw1">is</span> <span class="kw3">tagged</span> <span class="kw3">private</span>;<br />&#160;<br />   <span class="kw3">package</span> Source_Vecs <span class="kw1">is</span> <span class="kw3">new</span> Ada.<span class="me1">Containers</span>.<span class="me1">Indefinite_Vectors</span><br />     <span class="br0">&#40;</span>Index_Type   =&gt; Positive,<br />      Element_Type =&gt; Source_Type<span class="br0">&#41;</span>;<br />&#160;<br />   <span class="kw3">procedure</span> Store<span class="br0">&#40;</span>Storage: <span class="kw3">in</span> <span class="kw3">out</span> Storage_Type;<br />                   Source: Source_Type;<br />                   Item: Item_Type<span class="br0">&#41;</span>;<br />   <span class="co1">-- stores Source in a table, indexed by Item</span><br />   <span class="co1">-- if there is already an Item/Source entry, the Table isn_t changed</span><br />&#160;<br />   <span class="kw3">function</span> Find<span class="br0">&#40;</span>Storage: Storage_Type; Item: Item_Type<span class="br0">&#41;</span><br />                <span class="kw1">return</span> Source_Vecs.<span class="me1">Vector</span>;<br />   <span class="co1">-- Generates a vector of all Sources for the given Item</span><br />&#160;<br />   <span class="kw3">function</span> <span class="st0">&quot;and&quot;</span><span class="br0">&#40;</span>Left, Right: Source_Vecs.<span class="me1">Vector</span><span class="br0">&#41;</span> <span class="kw1">return</span> Source_Vecs.<span class="me1">Vector</span>;<br />   <span class="co1">-- returns a vector of all sources, which are both in Left and in Right</span><br />&#160;<br />   <span class="kw3">function</span> <span class="st0">&quot;or&quot;</span><span class="br0">&#40;</span>Left, Right: Source_Vecs.<span class="me1">Vector</span><span class="br0">&#41;</span> <span class="kw1">return</span> Source_Vecs.<span class="me1">Vector</span>;<br />   <span class="co1">-- returns a vector of all sources, which are in Left, Right, or both</span><br />&#160;<br />   <span class="kw3">function</span> Empty<span class="br0">&#40;</span>Vec: Source_Vecs.<span class="me1">Vector</span><span class="br0">&#41;</span> <span class="kw1">return</span> Boolean;<br />   <span class="co1">-- returns true if Vec is empty</span><br />&#160;<br />   <span class="kw3">function</span> First_Source<span class="br0">&#40;</span>The_Sources: Source_Vecs.<span class="me1">Vector</span><span class="br0">&#41;</span> <span class="kw1">return</span> Source_Type;<br />   <span class="co1">-- returns the first enty in The_Sources; pre: The_Sourses is not empty</span><br />&#160;<br />   <span class="kw3">procedure</span> Delete_First_Source<span class="br0">&#40;</span>The_Sources: <span class="kw3">in</span> <span class="kw3">out</span> Source_Vecs.<span class="me1">Vector</span>;<br />                                 Count: Ada.<span class="me1">Containers</span>.<span class="me1">Count_Type</span>&#160;:= <span class="nu0">1</span><span class="br0">&#41;</span>;<br />   <span class="co1">-- Removes the first Count entries; pre: The_Sourses has that many entries</span><br />&#160;<br />   <span class="kw3">type</span> Process_Source <span class="kw1">is</span> <span class="kw2">not</span> <span class="kw3">null</span> <span class="kw3">access</span> <span class="kw3">procedure</span> <span class="br0">&#40;</span>Source: Source_Type<span class="br0">&#41;</span>;<br />&#160;<br />   <span class="kw3">generic</span><br />      <span class="kw3">with</span> <span class="kw3">procedure</span> Do_Something<span class="br0">&#40;</span>Source: Source_Type<span class="br0">&#41;</span>;<br />   <span class="kw3">procedure</span> Iterate<span class="br0">&#40;</span>The_Sources: Source_Vecs.<span class="me1">Vector</span><span class="br0">&#41;</span>;<br />   <span class="co1">-- calls Do_Something(Source) for all sources in The_Sources;</span><br />&#160;<br /><span class="kw3">private</span><br />&#160;<br />   <span class="kw3">function</span> Same_Vector<span class="br0">&#40;</span>U,V: Source_Vecs.<span class="me1">Vector</span><span class="br0">&#41;</span> <span class="kw1">return</span> Boolean;<br />&#160;<br />   <span class="kw3">package</span> Maps <span class="kw1">is</span> <span class="kw3">new</span> Ada.<span class="me1">Containers</span>.<span class="me1">Indefinite_Hashed_Maps</span><br />     <span class="co1">-- for each item (=key) we store a vector with sources</span><br />     <span class="br0">&#40;</span>Key_Type         =&gt; Item_Type,<br />      Element_Type     =&gt; Source_Vecs.<span class="me1">Vector</span>,<br />      Hash             =&gt; Hash,<br />      Equivalent_Keys  =&gt; <span class="st0">&quot;=&quot;</span>,<br />      <span class="st0">&quot;=&quot;</span>              =&gt; Same_Vector<span class="br0">&#41;</span>;<br />&#160;<br />   <span class="kw3">type</span> Storage_Type <span class="kw1">is</span> <span class="kw3">new</span> Maps.<span class="me1">Map</span> <span class="kw3">with</span> <span class="kw3">null</span> <span class="kw3">record</span>;<br />&#160;<br /><span class="kw1">end</span> Generic_Inverted_Index;</pre>
<p>Here is the implementation (generic_inverted_index.adb):
</p>
<pre class="ada highlighted_source"><span class="kw3">package</span> <span class="kw3">body</span> Generic_Inverted_Index <span class="kw1">is</span><br />&#160;<br />   <span class="kw3">use</span> Source_Vecs;<br />   <span class="kw3">use</span> <span class="kw3">type</span> Maps.<span class="me1">Cursor</span>;<br />&#160;<br />&#160;<br />   <span class="kw3">procedure</span> Store<span class="br0">&#40;</span>Storage: <span class="kw3">in</span> <span class="kw3">out</span> Storage_Type;<br />                   Source: Source_Type;<br />                   Item: Item_Type<span class="br0">&#41;</span> <span class="kw1">is</span><br />   <span class="kw1">begin</span><br />      <span class="kw1">if</span> <span class="br0">&#40;</span>Storage.<span class="me1">Find</span><span class="br0">&#40;</span>Item<span class="br0">&#41;</span> = Maps.<span class="me1">No_Element</span><span class="br0">&#41;</span> <span class="kw1">then</span><br />         Storage.<span class="me1">Insert</span><span class="br0">&#40;</span>Key =&gt; Item,<br />                        New_Item =&gt; Empty_Vector &amp; Source<span class="br0">&#41;</span>;<br />      <span class="kw1">else</span><br />         <span class="kw1">declare</span><br />            The_Vector: Vector&#160;:= Storage.<span class="me1">Element</span><span class="br0">&#40;</span>Item<span class="br0">&#41;</span>;<br />         <span class="kw1">begin</span><br />            <span class="kw1">if</span> The_Vector.<span class="me1">Last_Element</span> /= Source <span class="kw1">then</span><br />               Storage.<span class="me1">Replace</span><br />                 <span class="br0">&#40;</span>Key      =&gt; Item,<br />                  New_Item =&gt; Storage.<span class="me1">Element</span><span class="br0">&#40;</span>Item<span class="br0">&#41;</span> &amp; Source<span class="br0">&#41;</span>;<br />            <span class="kw1">end</span> <span class="kw1">if</span>;<br />         <span class="kw1">end</span>;<br />      <span class="kw1">end</span> <span class="kw1">if</span>;<br />   <span class="kw1">end</span> Store;<br />&#160;<br />   <span class="kw3">function</span> Find<span class="br0">&#40;</span>Storage: Storage_Type; Item: Item_Type<span class="br0">&#41;</span><br />                <span class="kw1">return</span> Vector <span class="kw1">is</span><br />   <span class="kw1">begin</span><br />      <span class="kw1">return</span> Storage.<span class="me1">Element</span><span class="br0">&#40;</span>Item<span class="br0">&#41;</span>;<br />   <span class="kw1">exception</span><br />      <span class="kw3">when</span> Constraint_Error =&gt; <span class="kw1">return</span> Empty_Vector; <span class="co1">-- found nothing</span><br />   <span class="kw1">end</span> Find;<br />&#160;<br />   <span class="kw3">function</span> Is_In<span class="br0">&#40;</span>S: Source_Type; V: Vector<span class="br0">&#41;</span> <span class="kw1">return</span> Boolean <span class="kw1">is</span><br />      VV: Vector&#160;:= V;<br />   <span class="kw1">begin</span><br />      <span class="kw1">if</span> Empty<span class="br0">&#40;</span>V<span class="br0">&#41;</span> <span class="kw1">then</span><br />         <span class="kw1">return</span> False;<br />      <span class="kw1">elsif</span> First_Source<span class="br0">&#40;</span>V<span class="br0">&#41;</span> = S <span class="kw1">then</span><br />         <span class="kw1">return</span> True;<br />      <span class="kw1">else</span><br />         Delete_First_Source<span class="br0">&#40;</span>VV<span class="br0">&#41;</span>;<br />         <span class="kw1">return</span> Is_In<span class="br0">&#40;</span>S, VV<span class="br0">&#41;</span>;<br />      <span class="kw1">end</span> <span class="kw1">if</span>;<br />   <span class="kw1">end</span> Is_In;<br />&#160;<br />   <span class="kw3">function</span> <span class="st0">&quot;and&quot;</span><span class="br0">&#40;</span>Left, Right: Vector<span class="br0">&#41;</span> <span class="kw1">return</span> Vector <span class="kw1">is</span><br />       V: Vector&#160;:= Empty_Vector;<br />   <span class="kw1">begin</span><br />      <span class="kw1">for</span> I <span class="kw3">in</span> First_Index<span class="br0">&#40;</span>Left<span class="br0">&#41;</span> .. <span class="me1">Last_Index</span><span class="br0">&#40;</span>Left<span class="br0">&#41;</span> <span class="kw1">loop</span><br />         <span class="kw1">if</span> Is_In<span class="br0">&#40;</span>Element<span class="br0">&#40;</span>Left, I<span class="br0">&#41;</span>, Right<span class="br0">&#41;</span> <span class="kw1">then</span><br />            V&#160;:= V &amp; Element<span class="br0">&#40;</span>Left, I<span class="br0">&#41;</span>;<br />         <span class="kw1">end</span> <span class="kw1">if</span>;<br />      <span class="kw1">end</span> <span class="kw1">loop</span>;<br />      <span class="kw1">return</span> V;<br />   <span class="kw1">end</span> <span class="st0">&quot;and&quot;</span>;<br />&#160;<br />   <span class="kw3">function</span> <span class="st0">&quot;or&quot;</span><span class="br0">&#40;</span>Left, Right: Vector<span class="br0">&#41;</span> <span class="kw1">return</span> Vector <span class="kw1">is</span><br />       V: Vector&#160;:= Left; <span class="co1">-- all sources in Left</span><br />   <span class="kw1">begin</span> <span class="co1">-- ... add all sources in Right, which are not already in Left</span><br />      <span class="kw1">for</span> I <span class="kw3">in</span> First_Index<span class="br0">&#40;</span>Right<span class="br0">&#41;</span> .. <span class="me1">Last_Index</span><span class="br0">&#40;</span>Right<span class="br0">&#41;</span> <span class="kw1">loop</span><br />         <span class="kw1">if</span> <span class="kw2">not</span> Is_In<span class="br0">&#40;</span>Element<span class="br0">&#40;</span>Right, I<span class="br0">&#41;</span>, Left<span class="br0">&#41;</span> <span class="kw1">then</span><br />            V&#160;:= V &amp; Element<span class="br0">&#40;</span>Right, I<span class="br0">&#41;</span>;<br />         <span class="kw1">end</span> <span class="kw1">if</span>;<br />      <span class="kw1">end</span> <span class="kw1">loop</span>;<br />      <span class="kw1">return</span> V;<br />   <span class="kw1">end</span> <span class="st0">&quot;or&quot;</span>;<br />&#160;<br />   <span class="kw3">function</span> Empty<span class="br0">&#40;</span>Vec: Vector<span class="br0">&#41;</span> <span class="kw1">return</span> Boolean<br />     <span class="kw3">renames</span> Is_Empty;<br />&#160;<br />   <span class="kw3">function</span> First_Source<span class="br0">&#40;</span>The_Sources: Vector<span class="br0">&#41;</span><br />                        <span class="kw1">return</span> Source_Type <span class="kw3">renames</span> First_Element;<br />&#160;<br />   <span class="kw3">procedure</span> Delete_First_Source<span class="br0">&#40;</span>The_Sources: <span class="kw3">in</span> <span class="kw3">out</span> Vector;<br />                                 Count: Ada.<span class="me1">Containers</span>.<span class="me1">Count_Type</span>&#160;:= <span class="nu0">1</span><span class="br0">&#41;</span><br />     <span class="kw3">renames</span> Delete_First;<br />&#160;<br />   <span class="kw3">procedure</span> Iterate<span class="br0">&#40;</span>The_Sources: Vector<span class="br0">&#41;</span> <span class="kw1">is</span><br />      V: Vector&#160;:= The_Sources;<br />   <span class="kw1">begin</span><br />      <span class="kw1">while</span> <span class="kw2">not</span> Empty<span class="br0">&#40;</span>V<span class="br0">&#41;</span> <span class="kw1">loop</span><br />         Do_Something<span class="br0">&#40;</span>First_Source<span class="br0">&#40;</span>V<span class="br0">&#41;</span><span class="br0">&#41;</span>;<br />         Delete_First_Source<span class="br0">&#40;</span>V<span class="br0">&#41;</span>;<br />      <span class="kw1">end</span> <span class="kw1">loop</span>;<br />   <span class="kw1">end</span> Iterate;<br />&#160;<br />   <span class="kw3">function</span> Same_Vector<span class="br0">&#40;</span>U,V: Vector<span class="br0">&#41;</span> <span class="kw1">return</span> Boolean <span class="kw1">is</span><br />   <span class="kw1">begin</span><br />      <span class="kw3">raise</span> Program_Error <span class="kw3">with</span> <span class="st0">&quot;there is no need to call this function&quot;</span>;<br />      <span class="kw1">return</span> False; <span class="co1">-- this avoices a compiler warning</span><br />   <span class="kw1">end</span> Same_Vector;<br />&#160;<br /><span class="kw1">end</span> Generic_Inverted_Index;</pre>
<h3><span class="mw-headline" id="Package_Parse_Lines">Package Parse_Lines</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/mw/index.php?title=Inverted_index&amp;action=edit&amp;section=4" title="Edit section: Package Parse Lines">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The main program also uses an auxiliary package Parse_Lines. Note the usage of Gnat.Regpat, which itself is pattern matching package, specific for gnat/gcc. This package is derived from the <a href="/wiki/Regular_expressions#Ada" title="Regular expressions">Ada implementation of the regular expressions task</a>. Here is the spec (parse_lines.ads):
</p>
<pre class="ada highlighted_source"><span class="kw3">with</span> Gnat.<span class="me1">Regpat</span>;<br />&#160;<br /><span class="kw3">package</span> Parse_Lines <span class="kw1">is</span><br />&#160;<br />   Word_Pattern: <span class="kw3">constant</span> String&#160;:= <span class="st0">&quot;([a-zA-Z]+)&quot;</span>;<br />   Filename_Pattern: <span class="kw3">constant</span> String&#160;:= <span class="st0">&quot;([a-zA-Z0-9_.,;:]+)&quot;</span>;<br />&#160;<br />   <span class="kw3">procedure</span> Search_For_Pattern<span class="br0">&#40;</span>Pattern: Gnat.<span class="me1">Regpat</span>.<span class="me1">Pattern_Matcher</span>;<br />                                Search_In: String;<br />                                First, Last: <span class="kw3">out</span> Positive;<br />                                Found: <span class="kw3">out</span> Boolean<span class="br0">&#41;</span>;<br />&#160;<br />   <span class="kw3">function</span> Compile<span class="br0">&#40;</span>Raw: String<span class="br0">&#41;</span> <span class="kw1">return</span> Gnat.<span class="me1">Regpat</span>.<span class="me1">Pattern_Matcher</span>;<br />&#160;<br />   <span class="kw3">generic</span><br />      Pattern: String;<br />      <span class="kw3">with</span> <span class="kw3">procedure</span> Do_Something<span class="br0">&#40;</span>Word: String<span class="br0">&#41;</span>;<br />   <span class="kw3">procedure</span> Iterate_Words<span class="br0">&#40;</span>S: String<span class="br0">&#41;</span>;<br />&#160;<br /><span class="kw1">end</span> Parse_Lines;</pre>
<p>And here is the implementation (parse_lines.adb):
</p>
<pre class="ada highlighted_source"><span class="kw3">with</span> Gnat.<span class="me1">Regpat</span>;<br />&#160;<br /><span class="kw3">package</span> <span class="kw3">body</span> Parse_Lines <span class="kw1">is</span><br />&#160;<br />   <span class="kw3">procedure</span> Search_For_Pattern<span class="br0">&#40;</span>Pattern: Gnat.<span class="me1">Regpat</span>.<span class="me1">Pattern_Matcher</span>;<br />                                Search_In: String;<br />                                First, Last: <span class="kw3">out</span> Positive;<br />                                Found: <span class="kw3">out</span> Boolean<span class="br0">&#41;</span> <span class="kw1">is</span><br />      <span class="kw3">use</span> Gnat.<span class="me1">Regpat</span>;<br />      Result: Match_Array <span class="br0">&#40;</span><span class="nu0">0</span> .. <span class="nu0">1</span><span class="br0">&#41;</span>;<br />   <span class="kw1">begin</span><br />      Match<span class="br0">&#40;</span>Pattern, Search_In, Result<span class="br0">&#41;</span>;<br />      Found&#160;:= Result<span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span> /= No_Match;<br />      <span class="kw1">if</span> Found <span class="kw1">then</span><br />         First&#160;:= Result<span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span>.<span class="me1">First</span>;<br />         Last&#160;:= Result<span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span>.<span class="me1">Last</span>;<br />      <span class="kw1">end</span> <span class="kw1">if</span>;<br />   <span class="kw1">end</span> Search_For_Pattern;<br />&#160;<br />   <span class="kw3">function</span> Compile<span class="br0">&#40;</span>Raw: String<span class="br0">&#41;</span> <span class="kw1">return</span> Gnat.<span class="me1">Regpat</span>.<span class="me1">Pattern_Matcher</span> <span class="kw1">is</span><br />   <span class="kw1">begin</span><br />      <span class="kw1">return</span> Gnat.<span class="me1">Regpat</span>.<span class="me1">Compile</span><span class="br0">&#40;</span>Raw<span class="br0">&#41;</span>;<br />   <span class="kw1">end</span> Compile;<br />&#160;<br />      <span class="kw3">procedure</span> Iterate_Words<span class="br0">&#40;</span>S: String<span class="br0">&#41;</span> <span class="kw1">is</span><br />      Current_First: Positive&#160;:= S'First;<br />      First, Last:   Positive;<br />      Found:         Boolean;<br />      <span class="kw3">use</span> Parse_Lines;<br />      Compiled_P: Gnat.<span class="me1">Regpat</span>.<span class="me1">Pattern_Matcher</span>&#160;:= Compile<span class="br0">&#40;</span>Pattern<span class="br0">&#41;</span>;<br />   <span class="kw1">begin</span><br />      <span class="kw1">loop</span><br />         Search_For_Pattern<span class="br0">&#40;</span>Compiled_P,<br />                            S<span class="br0">&#40;</span>Current_First .. <span class="me1">S</span>'Last<span class="br0">&#41;</span>,<br />                            First, Last, Found<span class="br0">&#41;</span>;<br />         <span class="kw3">exit</span> <span class="kw3">when</span> <span class="kw2">not</span> Found;<br />         Do_Something<span class="br0">&#40;</span>S<span class="br0">&#40;</span>First .. <span class="me1">Last</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;<br />         Current_First&#160;:= Last+<span class="nu0">1</span>;<br />      <span class="kw1">end</span> <span class="kw1">loop</span>;<br />   <span class="kw1">end</span> Iterate_Words;<br />&#160;<br /><span class="kw1">end</span> Parse_Lines;</pre>
<h3><span class="mw-headline" id="Alternative_Implementation_of_Generic_Inverted_Index_.28Ada_2012.29">Alternative Implementation of Generic_Inverted_Index (Ada 2012)</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/mw/index.php?title=Inverted_index&amp;action=edit&amp;section=5" title="Edit section: Alternative Implementation of Generic Inverted Index (Ada 2012)">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The new standard Ada 2012 simplifies the usage of containers significantly. The following runs under gnat (GNAT GPL 2011 (20110419)), when using the experimental -gnat2012 switch. The main program is the same. Here is the spec for Generic_Inverted_Index:
</p>
<pre class="ada highlighted_source"><span class="kw3">with</span> Ada.<span class="me1">Containers</span>.<span class="me1">Indefinite_Vectors</span>;<br /><span class="kw3">private</span> <span class="kw3">with</span> Ada.<span class="me1">Containers</span>.<span class="me1">Indefinite_Hashed_Maps</span>;<br />&#160;<br /><span class="kw3">generic</span><br />   <span class="kw3">type</span> Source_Type <span class="br0">&#40;</span>&lt;&gt;<span class="br0">&#41;</span> <span class="kw1">is</span> <span class="kw3">private</span>;<br />   <span class="kw3">type</span> Item_Type <span class="br0">&#40;</span>&lt;&gt;<span class="br0">&#41;</span> <span class="kw1">is</span> <span class="kw3">private</span>;<br />   <span class="kw3">with</span> <span class="kw3">function</span> Hash<span class="br0">&#40;</span>Item: Item_Type<span class="br0">&#41;</span> <span class="kw1">return</span> Ada.<span class="me1">Containers</span>.<span class="me1">Hash_Type</span> <span class="kw1">is</span> &lt;&gt;;<br /><span class="kw3">package</span> Generic_Inverted_Index <span class="kw1">is</span><br />&#160;<br />   <span class="kw3">type</span> Storage_Type <span class="kw1">is</span> <span class="kw3">tagged</span> <span class="kw3">private</span>;<br />&#160;<br />   <span class="kw3">package</span> Source_Vecs <span class="kw1">is</span> <span class="kw3">new</span> Ada.<span class="me1">Containers</span>.<span class="me1">Indefinite_Vectors</span><br />     <span class="br0">&#40;</span>Index_Type   =&gt; Positive,<br />      Element_Type =&gt; Source_Type<span class="br0">&#41;</span>;<br />&#160;<br />   <span class="kw3">procedure</span> Store<span class="br0">&#40;</span>Storage: <span class="kw3">in</span> <span class="kw3">out</span> Storage_Type;<br />                   Source: Source_Type;<br />                   Item: Item_Type<span class="br0">&#41;</span>;<br />   <span class="co1">-- stores Source in a table, indexed by Item</span><br />   <span class="co1">-- if there is already an Item/Source entry, the Table isn_t changed</span><br />&#160;<br />   <span class="kw3">function</span> Find<span class="br0">&#40;</span>Storage: Storage_Type; Item: Item_Type<span class="br0">&#41;</span><br />                <span class="kw1">return</span> Source_Vecs.<span class="me1">Vector</span>;<br />   <span class="co1">-- Generates a vector of all Sources for the given Item</span><br />&#160;<br />   <span class="kw3">function</span> <span class="st0">&quot;and&quot;</span><span class="br0">&#40;</span>Left, Right: Source_Vecs.<span class="me1">Vector</span><span class="br0">&#41;</span> <span class="kw1">return</span> Source_Vecs.<span class="me1">Vector</span>;<br />   <span class="co1">-- returns a vector of all sources, which are both in Left and in Right</span><br />&#160;<br />   <span class="kw3">function</span> <span class="st0">&quot;or&quot;</span><span class="br0">&#40;</span>Left, Right: Source_Vecs.<span class="me1">Vector</span><span class="br0">&#41;</span> <span class="kw1">return</span> Source_Vecs.<span class="me1">Vector</span>;<br />   <span class="co1">-- returns a vector of all sources, which are in Left, Right, or both</span><br />&#160;<br />   <span class="kw3">function</span> Empty<span class="br0">&#40;</span>Vec: Source_Vecs.<span class="me1">Vector</span><span class="br0">&#41;</span> <span class="kw1">return</span> Boolean;<br />   <span class="co1">-- returns true if Vec is empty</span><br />&#160;<br />   <span class="kw3">type</span> Process_Source <span class="kw1">is</span> <span class="kw2">not</span> <span class="kw3">null</span> <span class="kw3">access</span> <span class="kw3">procedure</span> <span class="br0">&#40;</span>Source: Source_Type<span class="br0">&#41;</span>;<br />&#160;<br />   <span class="kw3">generic</span><br />      <span class="kw3">with</span> <span class="kw3">procedure</span> Do_Something<span class="br0">&#40;</span>Source: Source_Type<span class="br0">&#41;</span>;<br />   <span class="kw3">procedure</span> Iterate<span class="br0">&#40;</span>The_Sources: Source_Vecs.<span class="me1">Vector</span><span class="br0">&#41;</span>;<br />   <span class="co1">-- calls Do_Something(Source) for all sources in The_Sources;</span><br />&#160;<br /><span class="kw3">private</span><br />&#160;<br />   <span class="kw3">function</span> Same_Vector<span class="br0">&#40;</span>U,V: Source_Vecs.<span class="me1">Vector</span><span class="br0">&#41;</span> <span class="kw1">return</span> Boolean;<br />&#160;<br />   <span class="kw3">package</span> Maps <span class="kw1">is</span> <span class="kw3">new</span> Ada.<span class="me1">Containers</span>.<span class="me1">Indefinite_Hashed_Maps</span><br />     <span class="co1">-- for each item (=key) we store a vector with sources</span><br />     <span class="br0">&#40;</span>Key_Type         =&gt; Item_Type,<br />      Element_Type     =&gt; Source_Vecs.<span class="me1">Vector</span>,<br />      Hash             =&gt; Hash,<br />      Equivalent_Keys  =&gt; <span class="st0">&quot;=&quot;</span>,<br />      <span class="st0">&quot;=&quot;</span>              =&gt; Same_Vector<span class="br0">&#41;</span>;<br />&#160;<br />   <span class="kw3">type</span> Storage_Type <span class="kw1">is</span> <span class="kw3">new</span> Maps.<span class="me1">Map</span> <span class="kw3">with</span> <span class="kw3">null</span> <span class="kw3">record</span>;<br />&#160;<br /><span class="kw1">end</span> Generic_Inverted_Index;</pre>
<p>The implementation:
</p>
<pre class="ada highlighted_source"><span class="kw3">package</span> <span class="kw3">body</span> Generic_Inverted_Index <span class="kw1">is</span><br />             <span class="co1">-- uses some of the new Ada 2012 syntax</span><br />   <span class="kw3">use</span> Source_Vecs;<br />&#160;<br />   <span class="kw3">procedure</span> Store<span class="br0">&#40;</span>Storage: <span class="kw3">in</span> <span class="kw3">out</span> Storage_Type;<br />                   Source: Source_Type;<br />                   Item: Item_Type<span class="br0">&#41;</span> <span class="kw1">is</span><br />      <span class="kw3">use</span> <span class="kw3">type</span> Maps.<span class="me1">Cursor</span>;<br />   <span class="kw1">begin</span><br />      <span class="kw1">if</span> <span class="br0">&#40;</span>Storage.<span class="me1">Find</span><span class="br0">&#40;</span>Item<span class="br0">&#41;</span> = Maps.<span class="me1">No_Element</span><span class="br0">&#41;</span> <span class="kw1">then</span><br />         Storage.<span class="me1">Insert</span><span class="br0">&#40;</span>Key =&gt; Item,<br />                        New_Item =&gt; Empty_Vector &amp; Source<span class="br0">&#41;</span>;<br />      <span class="kw1">else</span><br />         <span class="kw1">declare</span><br />            The_Vector: Vector&#160;:= Storage.<span class="me1">Element</span><span class="br0">&#40;</span>Item<span class="br0">&#41;</span>;<br />         <span class="kw1">begin</span><br />            <span class="kw1">if</span> The_Vector.<span class="me1">Last_Element</span> /= Source <span class="kw1">then</span><br />               Storage.<span class="me1">Replace</span><br />                 <span class="br0">&#40;</span>Key      =&gt; Item,<br />                  New_Item =&gt; Storage.<span class="me1">Element</span><span class="br0">&#40;</span>Item<span class="br0">&#41;</span> &amp; Source<span class="br0">&#41;</span>;<br />            <span class="kw1">end</span> <span class="kw1">if</span>;<br />         <span class="kw1">end</span>;<br />      <span class="kw1">end</span> <span class="kw1">if</span>;<br />   <span class="kw1">end</span> Store;<br />&#160;<br />   <span class="kw3">function</span> Find<span class="br0">&#40;</span>Storage: Storage_Type; Item: Item_Type<span class="br0">&#41;</span><br />                <span class="kw1">return</span> Vector <span class="kw1">is</span><br />   <span class="kw1">begin</span><br />      <span class="kw1">return</span> Storage.<span class="me1">Element</span><span class="br0">&#40;</span>Item<span class="br0">&#41;</span>;<br />   <span class="kw1">exception</span><br />      <span class="kw3">when</span> Constraint_Error =&gt; <span class="kw1">return</span> Empty_Vector; <span class="co1">-- found nothing</span><br />   <span class="kw1">end</span> Find;<br />&#160;<br />   <span class="kw3">function</span> Is_In<span class="br0">&#40;</span>S: Source_Type; V: Vector<span class="br0">&#41;</span> <span class="kw1">return</span> Boolean <span class="kw1">is</span><br />   <span class="kw1">begin</span><br />      <span class="kw1">for</span> Some_Element <span class="kw3">of</span> V <span class="kw1">loop</span><br />         <span class="kw1">if</span> Some_Element = S <span class="kw1">then</span><br />            <span class="kw1">return</span> True;<br />         <span class="kw1">end</span> <span class="kw1">if</span>;<br />      <span class="kw1">end</span> <span class="kw1">loop</span>;<br />      <span class="kw1">return</span> False;<br />   <span class="kw1">end</span> Is_In;<br />&#160;<br />   <span class="kw3">function</span> <span class="st0">&quot;and&quot;</span><span class="br0">&#40;</span>Left, Right: Vector<span class="br0">&#41;</span> <span class="kw1">return</span> Vector <span class="kw1">is</span><br />       V: Vector&#160;:= Empty_Vector;<br />   <span class="kw1">begin</span><br />      <span class="kw1">for</span> Some_Element <span class="kw3">of</span> Left <span class="kw1">loop</span><br />         <span class="kw1">if</span> Is_In<span class="br0">&#40;</span>Some_Element, Right<span class="br0">&#41;</span> <span class="kw1">then</span><br />            V&#160;:= V &amp; Some_Element;<br />         <span class="kw1">end</span> <span class="kw1">if</span>;<br />      <span class="kw1">end</span> <span class="kw1">loop</span>;<br />      <span class="kw1">return</span> V;<br />   <span class="kw1">end</span> <span class="st0">&quot;and&quot;</span>;<br />&#160;<br />   <span class="kw3">function</span> <span class="st0">&quot;or&quot;</span><span class="br0">&#40;</span>Left, Right: Vector<span class="br0">&#41;</span> <span class="kw1">return</span> Vector <span class="kw1">is</span><br />       V: Vector&#160;:= Left; <span class="co1">-- all sources in Left</span><br />   <span class="kw1">begin</span><br />      <span class="kw1">for</span> Some_Element <span class="kw3">of</span> Right <span class="kw1">loop</span><br />         <span class="kw1">if</span> <span class="kw2">not</span> Is_In<span class="br0">&#40;</span>Some_Element, Left<span class="br0">&#41;</span> <span class="kw1">then</span><br />            V&#160;:= V &amp; Some_Element;<br />         <span class="kw1">end</span> <span class="kw1">if</span>;<br />      <span class="kw1">end</span> <span class="kw1">loop</span>;<br />      <span class="kw1">return</span> V;<br />   <span class="kw1">end</span> <span class="st0">&quot;or&quot;</span>;<br />&#160;<br />   <span class="kw3">function</span> Empty<span class="br0">&#40;</span>Vec: Vector<span class="br0">&#41;</span> <span class="kw1">return</span> Boolean<br />     <span class="kw3">renames</span> Is_Empty;<br />&#160;<br />   <span class="kw3">procedure</span> Iterate<span class="br0">&#40;</span>The_Sources: Vector<span class="br0">&#41;</span> <span class="kw1">is</span><br />   <span class="kw1">begin</span><br />      <span class="kw1">for</span> Some_Element <span class="kw3">in</span> The_Sources <span class="kw1">loop</span><br />         Do_Something<span class="br0">&#40;</span>Element<span class="br0">&#40;</span>Some_Element<span class="br0">&#41;</span><span class="br0">&#41;</span>;<br />      <span class="kw1">end</span> <span class="kw1">loop</span>;<br />   <span class="kw1">end</span> Iterate;<br />&#160;<br />   <span class="kw3">function</span> Same_Vector<span class="br0">&#40;</span>U,V: Vector<span class="br0">&#41;</span> <span class="kw1">return</span> Boolean <span class="kw1">is</span><br />   <span class="kw1">begin</span><br />      <span class="kw3">raise</span> Program_Error <span class="kw3">with</span> <span class="st0">&quot;there is no need to call this function&quot;</span>;<br />      <span class="kw1">return</span> False; <span class="co1">-- this avoices a compiler warning</span><br />   <span class="kw1">end</span> Same_Vector;<br />&#160;<br /><span class="kw1">end</span> Generic_Inverted_Index;</pre>
<h2><span class="mw-headline" id="AutoHotkey"><a href="/wiki/Category:AutoHotkey" title="Category:AutoHotkey">AutoHotkey</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/mw/index.php?title=Inverted_index&amp;action=edit&amp;section=6" title="Edit section: AutoHotkey">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<div class="examplemeta workswith"><b>Works with</b>: <a href="/wiki/AutoHotkey_L" title="AutoHotkey L" class="mw-redirect">AutoHotkey_L</a></div>
<pre class="autohotkey highlighted_source"><span class="co1">; http://www.autohotkey.com/forum/viewtopic.php?t=41479</span><br /><a href="http://www.autohotkey.com/docs/commands/InputBox.htm"><span class="kw3">inputbox</span></a><span class="sy0">,</span> files<span class="sy0">,</span> files<span class="sy0">,</span> file pattern such as c:\files\<span class="sy0">*.</span>txt<br />&#160;<br />word2docs <span class="sy0">:=</span> object<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="co1">; autohotkey_L is needed.</span><br />&#160;<br />stime <span class="sy0">:=</span> <a href="http://www.autohotkey.com/docs/Variables.htm#A_TickCount"><span class="kw2">A_tickcount</span></a><br /><a href="http://www.autohotkey.com/docs/commands/Loop.htm"><span class="kw3">Loop</span></a><span class="sy0">,</span> <span class="re0">%files%</span><span class="sy0">,</span> <span class="nu0">0</span><span class="sy0">,</span><span class="nu0">1</span><br /><span class="br0">&#123;</span><br />   <a href="http://www.autohotkey.com/docs/commands/ToolTip.htm"><span class="kw3">tooltip</span></a><span class="sy0">,</span><span class="re0">%A_index%</span>  <span class="sy0">/</span> <span class="nu0">500</span>  <br />&#160;<br />   wordList <span class="sy0">:=</span> WordsIn<span class="br0">&#40;</span><a href="http://www.autohotkey.com/docs/Variables.htm#A_LoopFileFullPath"><span class="kw2">A_LoopFileFullPath</span></a><span class="br0">&#41;</span><br />   InvertedIndex<span class="br0">&#40;</span>wordList<span class="sy0">,</span> <a href="http://www.autohotkey.com/docs/Variables.htm#A_LoopFileFullPath"><span class="kw2">A_loopFileFullpath</span></a><span class="br0">&#41;</span>   <br /><span class="br0">&#125;</span><br />&#160;<br /><a href="http://www.autohotkey.com/docs/commands/ToolTip.htm"><span class="kw3">tooltip</span></a><br /><a href="http://www.autohotkey.com/docs/commands/MsgBox.htm"><span class="kw3">msgbox</span></a><span class="sy0">,</span>&#160;% <span class="st0">&quot;total time &quot;</span> <span class="br0">&#40;</span><span class="re3">A_tickcount</span><span class="sy0">-</span>stime<span class="br0">&#41;</span><span class="sy0">/</span><span class="nu0">1000</span><br />&#160;<br /><a href="http://www.autohotkey.com/docs/commands/Gosub.htm"><span class="kw3">gosub</span></a><span class="sy0">,</span> search<br /><span class="kw1">return</span><br />&#160;<br /><span class="re2">search:<br /></span><a href="http://www.autohotkey.com/docs/commands/Loop.htm"><span class="kw3">Loop</span></a><br /><span class="br0">&#123;</span><br />   <a href="http://www.autohotkey.com/docs/commands/InputBox.htm"><span class="kw3">InputBox</span></a><span class="sy0">,</span> keyword <span class="sy0">,</span> <a href="http://www.autohotkey.com/docs/commands/Input.htm"><span class="kw3">input</span></a> single keyword only<br />   <a href="http://www.autohotkey.com/docs/commands/MsgBox.htm"><span class="kw3">msgbox</span></a><span class="sy0">,</span>&#160;% foundDocs <span class="sy0">:=</span> findword<span class="br0">&#40;</span>keyword<span class="br0">&#41;</span><br /><span class="br0">&#125;</span><br /><span class="kw1">return</span><br />&#160;<br />WordsIn<span class="br0">&#40;</span>docpath<span class="br0">&#41;</span><br /><span class="br0">&#123;</span>  <br />   <a href="http://www.autohotkey.com/docs/commands/FileRead.htm"><span class="kw3">FileRead</span></a><span class="sy0">,</span> content<span class="sy0">,</span> <span class="re0">%docpath%</span><br />  spos <span class="sy0">=</span> <span class="nu0">1</span><br />   <a href="http://www.autohotkey.com/docs/commands/Loop.htm"><span class="kw3">Loop</span></a><br />   <span class="br0">&#123;</span><br />     <span class="kw1">if</span>&#160;!<span class="br0">&#40;</span>spos <span class="sy0">:=</span> <a href="http://www.autohotkey.com/docs/commands/RegExMatch.htm"><span class="kw3">Regexmatch</span></a><span class="br0">&#40;</span>content<span class="sy0">,</span> <span class="st0">&quot;[a-zA-Z]{2,}&quot;</span><span class="sy0">,</span>match<span class="sy0">,</span> spos<span class="br0">&#41;</span><span class="br0">&#41;</span><br />       <a href="http://www.autohotkey.com/docs/commands/Break.htm"><span class="kw3">break</span></a><br />     spos <span class="sy0">+=</span> <a href="http://www.autohotkey.com/docs/Functions.htm#BuiltIn"><span class="kw4">strlen</span></a><span class="br0">&#40;</span>match<span class="br0">&#41;</span><br />     this_wordList <span class="sy0">.=</span> match <span class="st0">&quot;`n&quot;</span><br />   <span class="br0">&#125;</span><br />&#160;<br />  <a href="http://www.autohotkey.com/docs/commands/Sort.htm"><span class="kw3">Sort</span></a><span class="sy0">,</span> this_wordList<span class="sy0">,</span> U  <br />  <span class="kw1">return</span> this_wordList   <br /><span class="br0">&#125;</span><br />&#160;<br />InvertedIndex<span class="br0">&#40;</span>byref words<span class="sy0">,</span> docpath<span class="br0">&#41;</span><br /><span class="br0">&#123;</span><br />   global word2docs<br />&#160;<br />  <a href="http://www.autohotkey.com/docs/commands/Loop.htm"><span class="kw3">loop</span></a><span class="sy0">,</span> parse<span class="sy0">,</span> words<span class="sy0">,</span> `n<span class="sy0">,</span>`r <br />  <span class="br0">&#123;</span>                          <br />    <span class="kw1">if</span> <a href="http://www.autohotkey.com/docs/Variables.htm#A_LoopField"><span class="kw2">A_loopField</span></a> <span class="sy0">=</span><br />      <a href="http://www.autohotkey.com/docs/commands/Continue.htm"><span class="kw3">continue</span></a><br />    word2docs<span class="br0">&#91;</span><a href="http://www.autohotkey.com/docs/Variables.htm#A_LoopField"><span class="kw2">A_loopField</span></a><span class="br0">&#93;</span> <span class="sy0">:=</span> word2docs<span class="br0">&#91;</span><a href="http://www.autohotkey.com/docs/Variables.htm#A_LoopField"><span class="kw2">A_loopField</span></a><span class="br0">&#93;</span> docpath <span class="st0">&quot;`n&quot;</span><br />  <span class="br0">&#125;</span><br /><span class="br0">&#125;</span><br />&#160;<br />findWord<span class="br0">&#40;</span>word2find<span class="br0">&#41;</span><br /><span class="br0">&#123;</span><br />  global word2docs<br />&#160;<br />  <span class="kw1">if</span> <span class="br0">&#40;</span>word2docs<span class="br0">&#91;</span>word2find<span class="br0">&#93;</span> <span class="sy0">=</span> <span class="st0">&quot;&quot;</span><span class="br0">&#41;</span><br />     <span class="kw1">return</span> <span class="st0">&quot;&quot;</span><br />  <span class="kw1">else</span><br />    <span class="kw1">return</span> word2docs<span class="br0">&#91;</span>word2find<span class="br0">&#93;</span><br /><span class="br0">&#125;</span></pre>
<h2><span class="mw-headline" id="BBC_BASIC"><a href="/wiki/Category:BBC_BASIC" title="Category:BBC BASIC">BBC BASIC</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/mw/index.php?title=Inverted_index&amp;action=edit&amp;section=7" title="Edit section: BBC BASIC">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<div class="examplemeta workswith"><b>Works with</b>: <a href="/wiki/BBC_BASIC_for_Windows" title="BBC BASIC for Windows">BBC BASIC for Windows</a></div>
<p>This uses a hashed index and linked lists to hold the file numbers.
</p>
<pre class="text highlighted_source">      DIM FileList$(4)<br />      FileList$() = &quot;BBCKEY0.TXT&quot;, &quot;BBCKEY1.TXT&quot;, &quot;BBCKEY2.TXT&quot;, \<br />      \             &quot;BBCKEY3.TXT&quot;, &quot;BBCKEY4.TXT&quot;<br />&#160;<br />      DictSize% = 30000<br />      DIM Index{(DictSize%-1) word$, link%}<br />&#160;<br />      REM Build inverted index:<br />      FOR file% = DIM(FileList$(),1) TO 0 STEP -1<br />        filename$ = FileList$(file%)<br />        F% = OPENIN(filename$)<br />        IF F% = 0 ERROR 100, &quot;Failed to open file&quot;<br />&#160;<br />        WHILE NOT EOF#F%<br />          REPEAT C%=BGET#F%&#160;: UNTIL C%&gt;64 OR EOF#F%&#160;: word$ = CHR$(C%)<br />          REPEAT C%=BGET#F%&#160;: word$ += CHR$(C%)&#160;: UNTIL C%&lt;65<br />          word$ = FNlower(LEFT$(word$))<br />&#160;<br />          hash% = FNhash(word$)<br />          WHILE Index{(hash%)}.word$&lt;&gt;&quot;&quot; AND Index{(hash%)}.word$&lt;&gt;word$<br />            hash% = (hash% + 1) MOD DictSize%&#160;: REM Collision<br />          ENDWHILE<br />          Index{(hash%)}.word$ = word$<br />          link% = Index{(hash%)}.link%<br />          IF link%=0 OR link%!4&lt;&gt;file% THEN<br />            DIM heap% 7&#160;: heap%!4 = file%<br />           &#160;!heap% = link%<br />            Index{(hash%)}.link% = heap%&#160;: REM Linked list<br />          ENDIF<br />        ENDWHILE<br />&#160;<br />        CLOSE #F%<br />      NEXT file%<br />&#160;<br />      REM Now query the index:<br />      PRINT FNquery(&quot;random&quot;)<br />      PRINT FNquery(&quot;envelope&quot;)<br />      PRINT FNquery(&quot;zebra&quot;)<br />      PRINT FNquery(&quot;the&quot;)<br />      END<br />&#160;<br />      DEF FNquery(A$)<br />      LOCAL hash%, link%, temp%<br />      A$ = FNlower(A$)<br />      hash% = FNhash(A$)<br />      temp% = hash%<br />      WHILE Index{(hash%)}.word$ &lt;&gt; A$<br />        hash% = (hash% + 1) MOD DictSize%<br />        IF hash% = temp% THEN = &quot;&quot;&quot;&quot; + A$ + &quot;&quot;&quot; not found&quot;<br />      ENDWHILE<br />      link% = Index{(hash%)}.link%<br />      A$ = &quot;&quot;&quot;&quot; + A$ + &quot;&quot;&quot; found in &quot;<br />      WHILE link%<br />        A$ += FileList$(link%!4) + &quot;, &quot;<br />        link% =&#160;!link%<br />      ENDWHILE<br />      = LEFT$(LEFT$(A$))<br />&#160;<br />      DEF FNhash(A$)<br />      LOCAL hash%<br />      IF LEN(A$) &lt; 4 A$ += STRING$(4-LEN(A$),CHR$0)<br />      hash% =&#160;!!^A$<br />      IF LEN(A$) &gt; 4 hash% EOR=&#160;!(!^A$ + LEN(A$) - 4)<br />      = hash% MOD DictSize%<br />&#160;<br />      DEF FNlower(A$)<br />      LOCAL A%,C%<br />      FOR A% = 1 TO LEN(A$)<br />        C% = ASCMID$(A$,A%)<br />        IF C% &gt;= 65 IF C% &lt;= 90 MID$(A$,A%,1) = CHR$(C%+32)<br />      NEXT<br />      = A$</pre>
<p><b>Output:</b>
</p>
<pre>&quot;random&quot; found in BBCKEY2.TXT, BBCKEY3.TXT, BBCKEY4.TXT
&quot;envelope&quot; found in BBCKEY1.TXT, BBCKEY4.TXT
&quot;zebra&quot; not found
&quot;the&quot; found in BBCKEY0.TXT, BBCKEY1.TXT, BBCKEY2.TXT, BBCKEY3.TXT, BBCKEY4.TXT
</pre>
<h2><span class="mw-headline" id="C"><a href="/wiki/Category:C" title="Category:C">C</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/mw/index.php?title=Inverted_index&amp;action=edit&amp;section=8" title="Edit section: C">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The code is stupidly long, having to implement a Trie to store strings and all -- the program doesn't do anything shiny, but Tries may be interesting to look at.
</p>
<pre class="c highlighted_source"><span class="co2">#include &lt;stdio.h&gt;</span><br /><span class="co2">#include &lt;stdlib.h&gt;</span><br />&#160;<br /><span class="kw4">char</span> chr_legal<span class="br0">&#91;</span><span class="br0">&#93;</span> <span class="sy0">=</span> <span class="st0">&quot;abcdefghijklmnopqrstuvwxyz0123456789_-./&quot;</span><span class="sy0">;</span><br /><span class="kw4">int</span>  chr_idx<span class="br0">&#91;</span><span class="nu0">256</span><span class="br0">&#93;</span> <span class="sy0">=</span> <span class="br0">&#123;</span><span class="nu0">0</span><span class="br0">&#125;</span><span class="sy0">;</span><br /><span class="kw4">char</span> idx_chr<span class="br0">&#91;</span><span class="nu0">256</span><span class="br0">&#93;</span> <span class="sy0">=</span> <span class="br0">&#123;</span><span class="nu0">0</span><span class="br0">&#125;</span><span class="sy0">;</span><br />&#160;<br /><span class="co2">#define FNAME 0</span><br /><span class="kw4">typedef</span> <span class="kw4">struct</span> trie_t <span class="sy0">*</span>trie<span class="sy0">,</span> trie_t<span class="sy0">;</span><br /><span class="kw4">struct</span> trie_t <span class="br0">&#123;</span><br />	trie next<span class="br0">&#91;</span><span class="kw4">sizeof</span><span class="br0">&#40;</span>chr_legal<span class="br0">&#41;</span><span class="br0">&#93;</span><span class="sy0">;</span> <span class="coMULTI">/* next letter; slot 0 is for file name */</span><br />	<span class="kw4">int</span> eow<span class="sy0">;</span><br /><span class="br0">&#125;</span><span class="sy0">;</span><br />&#160;<br />trie trie_new<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span> <span class="kw1">return</span> <a href="http://www.opengroup.org/onlinepubs/009695399/functions/calloc.html"><span class="kw3">calloc</span></a><span class="br0">&#40;</span><span class="kw4">sizeof</span><span class="br0">&#40;</span>trie_t<span class="br0">&#41;</span><span class="sy0">,</span> <span class="nu0">1</span><span class="br0">&#41;</span><span class="sy0">;</span> <span class="br0">&#125;</span><br />&#160;<br /><span class="co2">#define find_word(r, w) trie_trav(r, w, 1)</span><br /><span class="coMULTI">/* tree traversal: returns node if end of word and matches string, optionally<br /> * create node if doesn't exist<br /> */</span><br />trie trie_trav<span class="br0">&#40;</span>trie root<span class="sy0">,</span> <span class="kw4">const</span> <span class="kw4">char</span> <span class="sy0">*</span> str<span class="sy0">,</span> <span class="kw4">int</span> no_create<span class="br0">&#41;</span><br /><span class="br0">&#123;</span><br />	<span class="kw4">int</span> c<span class="sy0">;</span><br />	<span class="kw1">while</span> <span class="br0">&#40;</span>root<span class="br0">&#41;</span> <span class="br0">&#123;</span><br />		<span class="kw1">if</span> <span class="br0">&#40;</span><span class="br0">&#40;</span>c <span class="sy0">=</span> str<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="sy0">==</span> <span class="st0">'<span class="es5">\0</span>'</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><br />			<span class="kw1">if</span> <span class="br0">&#40;</span><span class="sy0">!</span>root<span class="sy0">-&gt;</span>eow <span class="sy0">&amp;&amp;</span> no_create<span class="br0">&#41;</span> <span class="kw1">return</span> <span class="nu0">0</span><span class="sy0">;</span><br />			<span class="kw2">break</span><span class="sy0">;</span><br />		<span class="br0">&#125;</span><br />		<span class="kw1">if</span> <span class="br0">&#40;</span><span class="sy0">!</span> <span class="br0">&#40;</span>c <span class="sy0">=</span> chr_idx<span class="br0">&#91;</span>c<span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="br0">&#41;</span> <span class="br0">&#123;</span><br />			str<span class="sy0">++;</span><br />			<span class="kw1">continue</span><span class="sy0">;</span><br />		<span class="br0">&#125;</span><br />&#160;<br />		<span class="kw1">if</span> <span class="br0">&#40;</span><span class="sy0">!</span>root<span class="sy0">-&gt;</span>next<span class="br0">&#91;</span>c<span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><br />			<span class="kw1">if</span> <span class="br0">&#40;</span>no_create<span class="br0">&#41;</span> <span class="kw1">return</span> <span class="nu0">0</span><span class="sy0">;</span><br />			root<span class="sy0">-&gt;</span>next<span class="br0">&#91;</span>c<span class="br0">&#93;</span> <span class="sy0">=</span> trie_new<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span><br />		<span class="br0">&#125;</span><br />		root <span class="sy0">=</span> root<span class="sy0">-&gt;</span>next<span class="br0">&#91;</span>c<span class="br0">&#93;</span><span class="sy0">;</span><br />		str<span class="sy0">++;</span><br />	<span class="br0">&#125;</span><br />	<span class="kw1">return</span> root<span class="sy0">;</span><br /><span class="br0">&#125;</span><br />&#160;<br /><span class="coMULTI">/*  complete traversal of whole tree, calling callback at each end of word node.<br /> *  similar method can be used to free nodes, had we wanted to do that.<br /> */</span><br /><span class="kw4">int</span> trie_all<span class="br0">&#40;</span>trie root<span class="sy0">,</span> <span class="kw4">char</span> path<span class="br0">&#91;</span><span class="br0">&#93;</span><span class="sy0">,</span> <span class="kw4">int</span> depth<span class="sy0">,</span> <span class="kw4">int</span> <span class="br0">&#40;</span><span class="sy0">*</span>callback<span class="br0">&#41;</span><span class="br0">&#40;</span><span class="kw4">char</span> <span class="sy0">*</span><span class="br0">&#41;</span><span class="br0">&#41;</span><br /><span class="br0">&#123;</span><br />	<span class="kw4">int</span> i<span class="sy0">;</span><br />	<span class="kw1">if</span> <span class="br0">&#40;</span>root<span class="sy0">-&gt;</span>eow <span class="sy0">&amp;&amp;</span> <span class="sy0">!</span>callback<span class="br0">&#40;</span>path<span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">return</span> <span class="nu0">0</span><span class="sy0">;</span><br />&#160;<br />	<span class="kw1">for</span> <span class="br0">&#40;</span>i <span class="sy0">=</span> <span class="nu0">1</span><span class="sy0">;</span> i <span class="sy0">&lt;</span> <span class="kw4">sizeof</span><span class="br0">&#40;</span>chr_legal<span class="br0">&#41;</span><span class="sy0">;</span> i<span class="sy0">++</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><br />		<span class="kw1">if</span> <span class="br0">&#40;</span><span class="sy0">!</span>root<span class="sy0">-&gt;</span>next<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="kw1">continue</span><span class="sy0">;</span><br />&#160;<br />		path<span class="br0">&#91;</span>depth<span class="br0">&#93;</span> <span class="sy0">=</span> idx_chr<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">;</span><br />		path<span class="br0">&#91;</span>depth <span class="sy0">+</span> <span class="nu0">1</span><span class="br0">&#93;</span> <span class="sy0">=</span> <span class="st0">'<span class="es5">\0</span>'</span><span class="sy0">;</span><br />		<span class="kw1">if</span> <span class="br0">&#40;</span><span class="sy0">!</span>trie_all<span class="br0">&#40;</span>root<span class="sy0">-&gt;</span>next<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">,</span> path<span class="sy0">,</span> depth <span class="sy0">+</span> <span class="nu0">1</span><span class="sy0">,</span> callback<span class="br0">&#41;</span><span class="br0">&#41;</span><br />			<span class="kw1">return</span> <span class="nu0">0</span><span class="sy0">;</span><br />	<span class="br0">&#125;</span><br />	<span class="kw1">return</span> <span class="nu0">1</span><span class="sy0">;</span><br /><span class="br0">&#125;</span><br />&#160;<br /><span class="kw4">void</span> add_index<span class="br0">&#40;</span>trie root<span class="sy0">,</span> <span class="kw4">const</span> <span class="kw4">char</span> <span class="sy0">*</span>word<span class="sy0">,</span> <span class="kw4">const</span> <span class="kw4">char</span> <span class="sy0">*</span>fname<span class="br0">&#41;</span><br /><span class="br0">&#123;</span><br />	trie x <span class="sy0">=</span> trie_trav<span class="br0">&#40;</span>root<span class="sy0">,</span> word<span class="sy0">,</span> <span class="nu0">0</span><span class="br0">&#41;</span><span class="sy0">;</span><br />	x<span class="sy0">-&gt;</span>eow <span class="sy0">=</span> <span class="nu0">1</span><span class="sy0">;</span><br />&#160;<br />	<span class="kw1">if</span> <span class="br0">&#40;</span><span class="sy0">!</span>x<span class="sy0">-&gt;</span>next<span class="br0">&#91;</span>FNAME<span class="br0">&#93;</span><span class="br0">&#41;</span><br />		x<span class="sy0">-&gt;</span>next<span class="br0">&#91;</span>FNAME<span class="br0">&#93;</span> <span class="sy0">=</span> trie_new<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span><br />	x <span class="sy0">=</span> trie_trav<span class="br0">&#40;</span>x<span class="sy0">-&gt;</span>next<span class="br0">&#91;</span>FNAME<span class="br0">&#93;</span><span class="sy0">,</span> fname<span class="sy0">,</span> <span class="nu0">0</span><span class="br0">&#41;</span><span class="sy0">;</span><br />	x<span class="sy0">-&gt;</span>eow <span class="sy0">=</span> <span class="nu0">1</span><span class="sy0">;</span><br /><span class="br0">&#125;</span><br />&#160;<br /><span class="kw4">int</span> print_path<span class="br0">&#40;</span><span class="kw4">char</span> <span class="sy0">*</span>path<span class="br0">&#41;</span><br /><span class="br0">&#123;</span><br />	<a href="http://www.opengroup.org/onlinepubs/009695399/functions/printf.html"><span class="kw3">printf</span></a><span class="br0">&#40;</span><span class="st0">&quot;&#160;%s&quot;</span><span class="sy0">,</span> path<span class="br0">&#41;</span><span class="sy0">;</span><br />	<span class="kw1">return</span> <span class="nu0">1</span><span class="sy0">;</span><br /><span class="br0">&#125;</span><br />&#160;<br /><span class="coMULTI">/*  pretend we parsed text files and got lower cased words: dealing     *<br /> *  with text file is a whole other animal and would make code too long */</span><br /><span class="kw4">const</span> <span class="kw4">char</span> <span class="sy0">*</span>files<span class="br0">&#91;</span><span class="br0">&#93;</span> <span class="sy0">=</span> <span class="br0">&#123;</span> <span class="st0">&quot;f1.txt&quot;</span><span class="sy0">,</span> <span class="st0">&quot;source/f2.txt&quot;</span><span class="sy0">,</span> <span class="st0">&quot;other_file&quot;</span> <span class="br0">&#125;</span><span class="sy0">;</span><br /><span class="kw4">const</span> <span class="kw4">char</span> <span class="sy0">*</span>text<span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#91;</span><span class="nu0">5</span><span class="br0">&#93;</span> <span class="sy0">=</span><span class="br0">&#123;</span><span class="br0">&#123;</span> <span class="st0">&quot;it&quot;</span><span class="sy0">,</span> <span class="st0">&quot;is&quot;</span><span class="sy0">,</span> <span class="st0">&quot;what&quot;</span><span class="sy0">,</span> <span class="st0">&quot;it&quot;</span><span class="sy0">,</span> <span class="st0">&quot;is&quot;</span> <span class="br0">&#125;</span><span class="sy0">,</span><br />		        <span class="br0">&#123;</span> <span class="st0">&quot;what&quot;</span><span class="sy0">,</span> <span class="st0">&quot;is&quot;</span><span class="sy0">,</span> <span class="st0">&quot;it&quot;</span><span class="sy0">,</span> <span class="nu0">0</span> <span class="br0">&#125;</span><span class="sy0">,</span><br />		        <span class="br0">&#123;</span> <span class="st0">&quot;it&quot;</span><span class="sy0">,</span> <span class="st0">&quot;is&quot;</span><span class="sy0">,</span> <span class="st0">&quot;a&quot;</span><span class="sy0">,</span> <span class="st0">&quot;banana&quot;</span><span class="sy0">,</span> <span class="nu0">0</span> <span class="br0">&#125;</span><span class="br0">&#125;</span><span class="sy0">;</span><br />&#160;<br />trie init_tables<span class="br0">&#40;</span><span class="br0">&#41;</span><br /><span class="br0">&#123;</span><br />	<span class="kw4">int</span> i<span class="sy0">,</span> j<span class="sy0">;</span><br />	trie root <span class="sy0">=</span> trie_new<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span><br />	<span class="kw1">for</span> <span class="br0">&#40;</span>i <span class="sy0">=</span> <span class="nu0">0</span><span class="sy0">;</span> i <span class="sy0">&lt;</span> <span class="kw4">sizeof</span><span class="br0">&#40;</span>chr_legal<span class="br0">&#41;</span><span class="sy0">;</span> i<span class="sy0">++</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><br />		chr_idx<span class="br0">&#91;</span><span class="br0">&#40;</span><span class="kw4">int</span><span class="br0">&#41;</span>chr_legal<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span> <span class="sy0">=</span> i <span class="sy0">+</span> <span class="nu0">1</span><span class="sy0">;</span><br />		idx_chr<span class="br0">&#91;</span>i <span class="sy0">+</span> <span class="nu0">1</span><span class="br0">&#93;</span> <span class="sy0">=</span> chr_legal<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">;</span><br />	<span class="br0">&#125;</span><br />&#160;<br /><span class="coMULTI">/* Enable USE_ADVANCED_FILE_HANDLING to use advanced file handling.<br /> * You need to have files named like above files[], with words in them<br /> * like in text[][].  Case doesn't matter (told you it's advanced). <br /> */</span><br /><span class="co2">#define USE_ADVANCED_FILE_HANDLING 0</span><br /><span class="co2">#if USE_ADVANCED_FILE_HANDLING</span><br />	<span class="kw4">void</span> read_file<span class="br0">&#40;</span><span class="kw4">const</span> <span class="kw4">char</span> <span class="sy0">*</span> fname<span class="br0">&#41;</span> <span class="br0">&#123;</span><br />		<span class="kw4">char</span> cmd<span class="br0">&#91;</span><span class="nu0">1024</span><span class="br0">&#93;</span><span class="sy0">;</span><br />		<span class="kw4">char</span> word<span class="br0">&#91;</span><span class="nu0">1024</span><span class="br0">&#93;</span><span class="sy0">;</span><br />		<a href="http://www.opengroup.org/onlinepubs/009695399/functions/sprintf.html"><span class="kw3">sprintf</span></a><span class="br0">&#40;</span>cmd<span class="sy0">,</span> <span class="st0">&quot;perl -p -e 'while(/(<span class="es1">\\</span>w+)/g) {print lc($1),<span class="es1">\&quot;</span><span class="es1">\\</span>n<span class="es1">\&quot;</span>}'&#160;%s&quot;</span><span class="sy0">,</span> fname<span class="br0">&#41;</span><span class="sy0">;</span><br />		FILE <span class="sy0">*</span>in <span class="sy0">=</span> popen<span class="br0">&#40;</span>cmd<span class="sy0">,</span> <span class="st0">&quot;r&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span><br />		<span class="kw1">while</span> <span class="br0">&#40;</span><span class="sy0">!</span><a href="http://www.opengroup.org/onlinepubs/009695399/functions/feof.html"><span class="kw3">feof</span></a><span class="br0">&#40;</span>in<span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><br />			<a href="http://www.opengroup.org/onlinepubs/009695399/functions/fscanf.html"><span class="kw3">fscanf</span></a><span class="br0">&#40;</span>in<span class="sy0">,</span> <span class="st0">&quot;%1000s&quot;</span><span class="sy0">,</span> word<span class="br0">&#41;</span><span class="sy0">;</span><br />			add_index<span class="br0">&#40;</span>root<span class="sy0">,</span> word<span class="sy0">,</span> fname<span class="br0">&#41;</span><span class="sy0">;</span><br />		<span class="br0">&#125;</span><br />		pclose<span class="br0">&#40;</span>in<span class="br0">&#41;</span><span class="sy0">;</span><br />	<span class="br0">&#125;</span><span class="sy0">;</span><br />&#160;<br />	read_file<span class="br0">&#40;</span><span class="st0">&quot;f1.txt&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span><br />	read_file<span class="br0">&#40;</span><span class="st0">&quot;source/f2.txt&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span><br />	read_file<span class="br0">&#40;</span><span class="st0">&quot;other_file&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span><br /><span class="co2">#else</span><br />	<span class="kw1">for</span> <span class="br0">&#40;</span>i <span class="sy0">=</span> <span class="nu0">0</span><span class="sy0">;</span> i <span class="sy0">&lt;</span> <span class="nu0">3</span><span class="sy0">;</span> i<span class="sy0">++</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><br />		<span class="kw1">for</span> <span class="br0">&#40;</span>j <span class="sy0">=</span> <span class="nu0">0</span><span class="sy0">;</span> j <span class="sy0">&lt;</span> <span class="nu0">5</span><span class="sy0">;</span> j<span class="sy0">++</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><br />			<span class="kw1">if</span> <span class="br0">&#40;</span><span class="sy0">!</span>text<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#91;</span>j<span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="kw2">break</span><span class="sy0">;</span><br />			add_index<span class="br0">&#40;</span>root<span class="sy0">,</span> text<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#91;</span>j<span class="br0">&#93;</span><span class="sy0">,</span> files<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">;</span><br />		<span class="br0">&#125;</span><br />	<span class="br0">&#125;</span><br /><span class="co2">#endif /*USE_ADVANCED_FILE_HANDLING*/</span><br />&#160;<br />	<span class="kw1">return</span> root<span class="sy0">;</span><br /><span class="br0">&#125;</span><br />&#160;<br /><span class="kw4">void</span> search_index<span class="br0">&#40;</span>trie root<span class="sy0">,</span> <span class="kw4">const</span> <span class="kw4">char</span> <span class="sy0">*</span>word<span class="br0">&#41;</span><br /><span class="br0">&#123;</span><br />	<span class="kw4">char</span> path<span class="br0">&#91;</span><span class="nu0">1024</span><span class="br0">&#93;</span><span class="sy0">;</span><br />	<a href="http://www.opengroup.org/onlinepubs/009695399/functions/printf.html"><span class="kw3">printf</span></a><span class="br0">&#40;</span><span class="st0">&quot;Search for <span class="es1">\&quot;</span>%s<span class="es1">\&quot;</span>: &quot;</span><span class="sy0">,</span> word<span class="br0">&#41;</span><span class="sy0">;</span><br />	trie found <span class="sy0">=</span> find_word<span class="br0">&#40;</span>root<span class="sy0">,</span> word<span class="br0">&#41;</span><span class="sy0">;</span><br />&#160;<br />	<span class="kw1">if</span> <span class="br0">&#40;</span><span class="sy0">!</span>found<span class="br0">&#41;</span> <a href="http://www.opengroup.org/onlinepubs/009695399/functions/printf.html"><span class="kw3">printf</span></a><span class="br0">&#40;</span><span class="st0">&quot;not found<span class="es1">\n</span>&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span><br />	<span class="kw1">else</span> <span class="br0">&#123;</span><br />		trie_all<span class="br0">&#40;</span>found<span class="sy0">-&gt;</span>next<span class="br0">&#91;</span>FNAME<span class="br0">&#93;</span><span class="sy0">,</span> path<span class="sy0">,</span> <span class="nu0">0</span><span class="sy0">,</span> print_path<span class="br0">&#41;</span><span class="sy0">;</span><br />		<a href="http://www.opengroup.org/onlinepubs/009695399/functions/printf.html"><span class="kw3">printf</span></a><span class="br0">&#40;</span><span class="st0">&quot;<span class="es1">\n</span>&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span><br />	<span class="br0">&#125;</span><br /><span class="br0">&#125;</span><br />&#160;<br /><span class="kw4">int</span> main<span class="br0">&#40;</span><span class="br0">&#41;</span><br /><span class="br0">&#123;</span><br />	trie root <span class="sy0">=</span> init_tables<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span><br />&#160;<br />	search_index<span class="br0">&#40;</span>root<span class="sy0">,</span> <span class="st0">&quot;what&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span><br />	search_index<span class="br0">&#40;</span>root<span class="sy0">,</span> <span class="st0">&quot;is&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span><br />	search_index<span class="br0">&#40;</span>root<span class="sy0">,</span> <span class="st0">&quot;banana&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span><br />	search_index<span class="br0">&#40;</span>root<span class="sy0">,</span> <span class="st0">&quot;boo&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span><br />	<span class="kw1">return</span> <span class="nu0">0</span><span class="sy0">;</span><br /><span class="br0">&#125;</span></pre>Output:<pre class="text highlighted_source">Search for &quot;what&quot;:  f1.txt source/f2.txt<br />Search for &quot;is&quot;:  f1.txt other_file source/f2.txt<br />Search for &quot;banana&quot;:  other_file<br />Search for &quot;boo&quot;: not found</pre>
<h2><span class="mw-headline" id="C.2B.2B"><a href="/wiki/Category:C%2B%2B" title="Category:C++">C++</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/mw/index.php?title=Inverted_index&amp;action=edit&amp;section=9" title="Edit section: C++">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Same idea as the C implementation - trie to store the words
</p>
<pre class="cpp highlighted_source">&#160;<br /><span class="co2">#include &lt;algorithm&gt;</span><br /><span class="co2">#include &lt;fstream&gt;</span><br /><span class="co2">#include &lt;iostream&gt;</span><br /><span class="co2">#include &lt;vector&gt;</span><br /><span class="co2">#include &lt;string&gt;</span><br />&#160;<br /><span class="kw4">const</span> std<span class="sy4">::</span><span class="me2">string</span> _CHARS <span class="sy1">=</span> <span class="st0">&quot;abcdefghijklmnopqrstuvwxyz0123456789.:-_/&quot;</span><span class="sy4">;</span><br /><span class="kw4">const</span> <span class="kw4">size_t</span> MAX_NODES <span class="sy1">=</span> <span class="nu0">41</span><span class="sy4">;</span><br />&#160;<br /><span class="kw2">class</span> node<br /><span class="br0">&#123;</span><br /><span class="kw2">public</span><span class="sy4">:</span><br />    node<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span> clear<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy4">;</span> <span class="br0">&#125;</span> <br />    node<span class="br0">&#40;</span> <span class="kw4">char</span> z <span class="br0">&#41;</span> <span class="br0">&#123;</span> clear<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy4">;</span> <span class="br0">&#125;</span><br />    ~node<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span> <span class="kw1">for</span><span class="br0">&#40;</span> <span class="kw4">int</span> x <span class="sy1">=</span> <span class="nu0">0</span><span class="sy4">;</span> x <span class="sy1">&lt;</span> MAX_NODES<span class="sy4">;</span> x<span class="sy2">++</span> <span class="br0">&#41;</span> <span class="kw1">if</span><span class="br0">&#40;</span> next<span class="br0">&#91;</span>x<span class="br0">&#93;</span> <span class="br0">&#41;</span> <span class="kw3">delete</span> next<span class="br0">&#91;</span>x<span class="br0">&#93;</span><span class="sy4">;</span> <span class="br0">&##125;</span><br />    <span class="kw4">void</span> clear<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span> <span class="kw1">for</span><span class="br0">&#40;</span> <span class="kw4">int</span> x <span class="sy1">=</span> <span class="nu0">0</span><span class="sy4">;</span> x <span class="sy1">&lt;</span> MAX_NODES<span class="sy4">;</span> x<span class="sy2">++</span> <span class="br0">&#41;</span> next<span class="br0">&#91;</span>x<span class="br0">&#93;</span> <span class="sy1">=</span> <span class="nu0">0</span><span class="sy4">;</span> isWord <span class="sy1">=</span> <span class="kw2">false</span><span class="sy4">;</span> <span class="br0">&#125;</span><br />    <span class="kw4">bool</span> isWord<span class="sy4">;</span><br />    std<span class="sy4">::</span><span class="me2">vector</span><span class="sy1">&lt;</span>std<span class="sy4">::</span><span class="me2">string</span><span class="sy1">&gt;</span> files<span class="sy4">;</span><br />    node<span class="sy2">*</span> next<span class="br0">&#91;</span>MAX_NODES<span class="br0">&#93;</span><span class="sy4">;</span><br /><span class="br0">&#125;</span><span class="sy4">;</span><br />&#160;<br /><span class="kw2">class</span> index <span class="br0">&#123;</span><br /><span class="kw2">public</span><span class="sy4">:</span><br />    <span class="kw4">void</span> add<span class="br0">&#40;</span> std<span class="sy4">::</span><span class="me2">string</span> s, std<span class="sy4">::</span><span class="me2">string</span> fileName <span class="br0">&#41;</span> <span class="br0">&#123;</span><br />        std<span class="sy4">::</span><span class="me2">transform</span><span class="br0">&#40;</span> s.<span class="me1">begin</span><span class="br0">&#40;</span><span class="br0">&#41;</span>, s.<span class="me1">end</span><span class="br0">&#40;</span><span class="br0">&#41;</span>, s.<span class="me1">begin</span><span class="br0">&#40;</span><span class="br0">&#41;</span>, <span class="kw3">tolower</span> <span class="br0">&#41;</span><span class="sy4">;</span><br />        std<span class="sy4">::</span><span class="me2">string</span> h<span class="sy4">;</span><br />        <span class="kw1">for</span><span class="br0">&#40;</span> std<span class="sy4">::</span><span class="me2">string</span><span class="sy4">::</span><span class="me2">iterator</span> i <span class="sy1">=</span> s.<span class="me1">begin</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy4">;</span> i <span class="sy3">!</span><span class="sy1">=</span> s.<span class="me1">end</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy4">;</span> i<span class="sy2">++</span> <span class="br0">&#41;</span> <span class="br0">&#123;</span><br />            <span class="kw1">if</span><span class="br0">&#40;</span> <span class="sy2">*</span>i <span class="sy1">==</span> <span class="nu0">32</span> <span class="br0">&#41;</span> <span class="br0">&#123;</span><br />                pushFileName<span class="br0">&#40;</span> addWord<span class="br0">&#40;</span> h <span class="br0">&#41;</span>, fileName <span class="br0">&#41;</span><span class="sy4">;</span><br />                h.<span class="me1">clear</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy4">;</span><br />                <span class="kw1">continue</span><span class="sy4">;</span><br />            <span class="br0">&#125;</span><br />            h.<span class="me1">append</span><span class="br0">&#40;</span> <span class="nu0">1</span>, <span class="sy2">*</span>i <span class="br0">&#41;</span><span class="sy4">;</span><br />        <span class="br0">&#125;</span><br />        <span class="kw1">if</span><span class="br0">&#40;</span> h.<span class="me1">length</span><span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#41;</span><br />            pushFileName<span class="br0">&#40;</span> addWord<span class="br0">&#40;</span> h <span class="br0">&#41;</span>, fileName <span class="br0">&#41;</span><span class="sy4">;</span><br />    <span class="br0">&#125;</span><br />    <span class="kw4">void</span> findWord<span class="br0">&#40;</span> std<span class="sy4">::</span><span class="me2">string</span> s <span class="br0">&#41;</span> <span class="br0">&#123;</span><br />        std<span class="sy4">::</span><span class="me2">vector</span><span class="sy1">&lt;</span>std<span class="sy4">::</span><span class="me2">string</span><span class="sy1">&gt;</span> v <span class="sy1">=</span> find<span class="br0">&#40;</span> s <span class="br0">&#41;</span><span class="sy4">;</span><br />        <span class="kw1">if</span><span class="br0">&#40;</span> <span class="sy3">!</span>v.<span class="me1">size</span><span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#41;</span> <span class="br0">&#123;</span><br />            std<span class="sy4">::</span><span class="kw3">cout</span> <span class="sy1">&lt;&lt;</span> s <span class="sy2">+</span> <span class="st0">&quot; was not found!<span class="es1">\n</span>&quot;</span><span class="sy4">;</span><br />            <span class="kw1">return</span><span class="sy4">;</span><br />        <span class="br0">&#125;</span><br />        std<span class="sy4">::</span><span class="kw3">cout</span> <span class="sy1">&lt;&lt;</span> s <span class="sy1">&lt;&lt;</span> <span class="st0">&quot; found in:<span class="es1">\n</span>&quot;</span><span class="sy4">;</span><br />        <span class="kw1">for</span><span class="br0">&#40;</span> std<span class="sy4">::</span><span class="me2">vector</span><span class="sy1">&lt;</span>std<span class="sy4">::</span><span class="me2">string</span><span class="sy1">&gt;</span><span class="sy4">::</span><span class="me2">iterator</span> i <span class="sy1">=</span> v.<span class="me1">begin</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy4">;</span> i <span class="sy3">!</span><span class="sy1">=</span> v.<span class="me1">end</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy4">;</span> i<span class="sy2">++</span> <span class="br0">&#41;</span> <span class="br0">&#123;</span><br />            std<span class="sy4">::</span><span class="kw3">cout</span> <span class="sy1">&lt;&lt;</span> <span class="sy2">*</span>i <span class="sy1">&lt;&lt;</span> <span class="st0">&quot;<span class="es1">\n</span>&quot;</span><span class="sy4">;</span><br />        <span class="br0">&#125;</span><br />        std<span class="sy4">::</span><span class="kw3">cout</span> <span class="sy1">&lt;&lt;</span> <span class="st0">&quot;<span class="es1">\n</span>&quot;</span><span class="sy4">;</span><br />    <span class="br0">&#125;</span><br /><span class="kw2">private</span><span class="sy4">:</span><br />    <span class="kw4">void</span> pushFileName<span class="br0">&#40;</span> node<span class="sy2">*</span> n, std<span class="sy4">::</span><span class="me2">string</span> fn <span class="br0">&#41;</span> <span class="br0">&#123;</span><br />        std<span class="sy4">::</span><span class="me2">vector</span><span class="sy1">&lt;</span>std<span class="sy4">::</span><span class="me2">string</span><span class="sy1">&gt;</span><span class="sy4">::</span><span class="me2">iterator</span> i <span class="sy1">=</span> std<span class="sy4">::</span><span class="me2">find</span><span class="br0">&#40;</span> n<span class="sy2">-</span><span class="sy1">&gt;</span>files.<span class="me1">begin</span><span class="br0">&#40;</span><span class="br0">&#41;</span>, n<span class="sy2">-</span><span class="sy1">&gt;</span>files.<span class="me1">end</span><span class="br0">&#40;</span><span class="br0">&#41;</span>, fn <span class="br0">&#41;</span><span class="sy4">;</span><br />        <span class="kw1">if</span><span class="br0">&#40;</span> i <span class="sy1">==</span> n<span class="sy2">-</span><span class="sy1">&gt;</span>files.<span class="me1">end</span><span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#41;</span> n<span class="sy2">-</span><span class="sy1">&gt;</span>files.<span class="me1">push_back</span><span class="br0">&#40;</span> fn <span class="br0">&#41;</span><span class="sy4">;</span><br />    <span class="br0">&#125;</span><br />    <span class="kw4">const</span> std<span class="sy4">::</span><span class="me2">vector</span><span class="sy1">&lt;</span>std<span class="sy4">::</span><span class="me2">string</span><span class="sy1">&gt;</span><span class="sy3">&amp;</span> find<span class="br0">&#40;</span> std<span class="sy4">::</span><span class="me2">string</span> s <span class="br0">&#41;</span> <span class="br0">&#123;</span><br />        <span class="kw4">size_t</span> idx<span class="sy4">;</span><br />        std<span class="sy4">::</span><span class="me2">transform</span><span class="br0">&#40;</span> s.<span class="me1">begin</span><span class="br0">&#40;</span><span class="br0">&#41;</span>, s.<span class="me1">end</span><span class="br0">&#40;</span><span class="br0">&#41;</span>, s.<span class="me1">begin</span><span class="br0">&#40;</span><span class="br0">&#41;</span>, <span class="kw3">tolower</span> <span class="br0">&#41;</span><span class="sy4">;</span> <br />        node<span class="sy2">*</span> rt <span class="sy1">=</span> <span class="sy3">&amp;</span>root<span class="sy4">;</span><br />        <span class="kw1">for</span><span class="br0">&#40;</span> std<span class="sy4">::</span><span class="me2">string</span><span class="sy4">::</span><span class="me2">iterator</span> i <span class="sy1">=</span> s.<span class="me1">begin</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy4">;</span> i <span class="sy3">!</span><span class="sy1">=</span> s.<span class="me1">end</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy4">;</span> i<span class="sy2">++</span> <span class="br0">&#41;</span> <span class="br0">&#123;</span><br />            idx <span class="sy1">=</span> _CHARS.<span class="me1">find</span><span class="br0">&#40;</span> <span class="sy2">*</span>i <span class="br0">&#41;</span><span class="sy4">;</span><br />            <span class="kw1">if</span><span class="br0">&#40;</span> idx <span class="sy1">&lt;</span> MAX_NODES <span class="br0">&#41;</span> <span class="br0">&#123;</span><br />                <span class="kw1">if</span><span class="br0">&#40;</span> <span class="sy3">!</span>rt<span class="sy2">-</span><span class="sy1">&gt;</span>next<span class="br0">&#91;</span>idx<span class="br0">&#93;</span> <span class="br0">&#41;</span> <span class="kw1">return</span> std<span class="sy4">::</span><span class="me2">vector</span><span class="sy1">&lt;</span>std<span class="sy4">::</span><span class="me2">string</span><span class="sy1">&gt;</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy4">;</span> <br />                rt <span class="sy1">=</span> rt<span class="sy2">-</span><span class="sy1">&gt;</span>next<span class="br0">&#91;</span>idx<span class="br0">&#93;</span><span class="sy4">;</span> <br />            <span class="br0">&#125;</span><br />        <span class="br0">&#125;</span> <br />        <span class="kw1">if</span><span class="br0">&#40;</span> rt<span class="sy2">-</span><span class="sy1">&gt;</span>isWord <span class="br0">&#41;</span> <span class="kw1">return</span> rt<span class="sy2">-</span><span class="sy1">&gt;</span>files<span class="sy4">;</span><br />        <span class="kw1">return</span> std<span class="sy4">::</span><span class="me2">vector</span><span class="sy1">&lt;</span>std<span class="sy4">::</span><span class="me2">string</span><span class="sy1">&gt;</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy4">;</span><br />    <span class="br0">&#125;</span><br />    node<span class="sy2">*</span> addWord<span class="br0">&#40;</span> std<span class="sy4">::</span><span class="me2">string</span> s <span class="br0">&#41;</span> <span class="br0">&#123;</span><br />        <span class="kw4">size_t</span> idx<span class="sy4">;</span><br />        node<span class="sy2">*</span> rt <span class="sy1">=</span> <span class="sy3">&amp;</span>root, <span class="sy2">*</span>n<span class="sy4">;</span><br />        <span class="kw1">for</span><span class="br0">&#40;</span> std<span class="sy4">::</span><span class="me2">string</span><span class="sy4">::</span><span class="me2">iterator</span> i <span class="sy1">=</span> s.<span class="me1">begin</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy4">;</span> i <span class="sy3">!</span><span class="sy1">=</span> s.<span class="me1">end</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy4">;</span> i<span class="sy2">++</span> <span class="br0">&#41;</span> <span class="br0">&#123;</span><br />            idx <span class="sy1">=</span> _CHARS.<span class="me1">find</span><span class="br0">&#40;</span> <span class="sy2">*</span>i <span class="br0">&#41;</span><span class="sy4">;</span><br />            <span class="kw1">if</span><span class="br0">&#40;</span> idx <span class="sy1">&lt;</span> MAX_NODES <span class="br0">&#41;</span> <span class="br0">&#123;</span><br />                n <span class="sy1">=</span> rt<span class="sy2">-</span><span class="sy1">&gt;</span>next<span class="br0">&#91;</span>idx<span class="br0">&#93;</span><span class="sy4">;</span> <br />                <span class="kw1">if</span><span class="br0">&#40;</span> n <span class="br0">&#41;</span><span class="br0">&#123;</span> <br />                    rt <span class="sy1">=</span> n<span class="sy4">;</span> <br />                    <span class="kw1">continue</span><span class="sy4">;</span> <br />                <span class="br0">&#125;</span> <br />                n <span class="sy1">=</span> <span class="kw3">new</span> node<span class="br0">&#40;</span> <span class="sy2">*</span>i <span class="br0">&#41;</span><span class="sy4">;</span> <br />                rt<span class="sy2">-</span><span class="sy1">&gt;</span>next<span class="br0">&#91;</span>idx<span class="br0">&#93;</span> <span class="sy1">=</span> n<span class="sy4">;</span> <br />                rt <span class="sy1">=</span> n<span class="sy4">;</span> <br />            <span class="br0">&#125;</span><br />        <span class="br0">&#125;</span><br />        rt<span class="sy2">-</span><span class="sy1">&gt;</span>isWord <span class="sy1">=</span> <span class="kw2">true</span><span class="sy4">;</span><br />        <span class="kw1">return</span> rt<span class="sy4">;</span><br />    <span class="br0">&#125;</span><br />    node root<span class="sy4">;</span><br /><span class="br0">&#125;</span><span class="sy4">;</span><br /><span class="kw4">int</span> main<span class="br0">&#40;</span> <span class="kw4">int</span> argc, <span class="kw4">char</span><span class="sy2">*</span> argv<span class="br0">&#91;</span><span class="br0">&#93;</span> <span class="br0">&#41;</span> <span class="br0">&#123;</span><br />    index t<span class="sy4">;</span><br />    std<span class="sy4">::</span><span class="me2">string</span> s<span class="sy4">;</span><br />    std<span class="sy4">::</span><span class="me2">string</span> files<span class="br0">&#91;</span><span class="br0">&#93;</span> <span class="sy1">=</span> <span class="br0">&#123;</span> <span class="st0">&quot;file1.txt&quot;</span>, <span class="st0">&quot;f_text.txt&quot;</span>, <span class="st0">&quot;text_1b.txt&quot;</span> <span class="br0">&#125;</span><span class="sy4">;</span><br />&#160;<br />    <span class="kw1">for</span><span class="br0">&#40;</span> <span class="kw4">int</span> x <span class="sy1">=</span> <span class="nu0">0</span><span class="sy4">;</span> x <span class="sy1">&lt;</span> <span class="nu0">3</span><span class="sy4">;</span> x<span class="sy2">++</span> <span class="br0">&#41;</span> <span class="br0">&#123;</span><br />        std<span class="sy4">::</span><span class="me2">ifstream</span> f<span class="sy4">;</span><br />        f.<span class="me1">open</span><span class="br0">&#40;</span> files<span class="br0">&#91;</span>x<span class="br0">&#93;</span>.<span class="me1">c_str</span><span class="br0">&#40;</span><span class="br0">&#41;</span>, std<span class="sy4">::</span><span class="me2">ios</span><span class="sy4">::</span><span class="me2">in</span> <span class="br0">&#41;</span><span class="sy4">;</span><br />        <span class="kw1">if</span><span class="br0">&#40;</span> f.<span class="me1">good</span><span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#41;</span> <span class="br0">&#123;</span><br />            <span class="kw1">while</span><span class="br0">&#40;</span> <span class="sy3">!</span>f.<span class="me1">eof</span><span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#41;</span> <span class="br0">&#123;</span><br />                f <span class="sy1">&gt;&gt;</span> s<span class="sy4">;</span><br />                t.<span class="me1">add</span><span class="br0">&#40;</span> s, files<span class="br0">&#91;</span>x<span class="br0">&#93;</span> <span class="br0">&#41;</span><span class="sy4">;</span><br />                s.<span class="me1">clear</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy4">;</span><br />            <span class="br0">&#125;</span><br />            f.<span class="me1">close</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy4">;</span><br />        <span class="br0">&#125;</span><br />    <span class="br0">&#125;</span><br />&#160;<br />    <span class="kw1">while</span><span class="br0">&#40;</span> <span class="kw2">true</span> <span class="br0">&#41;</span> <span class="br0">&#123;</span><br />        std<span class="sy4">::</span><span class="kw3">cout</span> <span class="sy1">&lt;&lt;</span> <span class="st0">&quot;Enter one word to search for, return to exit: &quot;</span><span class="sy4">;</span><br />        std<span class="sy4">::</span><span class="me2">getline</span><span class="br0">&#40;</span> std<span class="sy4">::</span><span class="kw3">cin</span>, s <span class="br0">&#41;</span><span class="sy4">;</span><br />        <span class="kw1">if</span><span class="br0">&#40;</span> <span class="sy3">!</span>s.<span class="me1">length</span><span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#41;</span> <span class="kw1">break</span><span class="sy4">;</span><br />        t.<span class="me1">findWord</span><span class="br0">&#40;</span> s <span class="br0">&#41;</span><span class="sy4">;</span><br />&#160;<br />    <span class="br0">&#125;</span><br />    <span class="kw1">return</span> <span class="nu0">0</span><span class="sy4">;</span><br /><span class="br0">&#125;</span><br />&#160;</pre>
<div>
<dl><dt>Output:</div></dt></dl>
<pre>Enter one word to search for, return to exit: goodness
goodness found in:
file1.txt
f_text.txt

Enter one word to search for, return to exit: because
because found in:
f_text.txt

Enter one word to search for, return to exit: her
her found in:
text_1b.txt

Enter one word to search for, return to exit: fat
fat was not found!
</pre>
<h2><span class="mw-headline" id="C.23"><a href="/wiki/Category:C_sharp" title="Category:C sharp">C#</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/mw/index.php?title=Inverted_index&amp;action=edit&amp;section=10" title="Edit section: C#">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<pre class="csharp highlighted_source"><span class="kw1">using</span> <span class="co3">System</span><span class="sy0">;</span><br /><span class="kw1">using</span> <span class="co3">System.Collections.Generic</span><span class="sy0">;</span><br /><span class="kw1">using</span> <span class="co3">System.IO</span><span class="sy0">;</span><br /><span class="kw1">using</span> <span class="co3">System.Linq</span><span class="sy0">;</span><br />&#160;<br /><span class="kw4">class</span> InvertedIndex<br /><span class="br0">&#123;</span><br />    <span class="kw1">static</span> Dictionary<span class="sy0">&lt;</span>TItem, IEnumerable<span class="sy0">&lt;</span>TKey<span class="sy0">&gt;&gt;</span> Invert<span class="sy0">&lt;</span>TKey, TItem<span class="sy0">&gt;</span><span class="br0">&#40;</span>Dictionary<span class="sy0">&lt;</span>TKey, IEnumerable<span class="sy0">&lt;</span>TItem<span class="sy0">&gt;&gt;</span> dictionary<span class="br0">&#41;</span><br />    <span class="br0">&#123;</span><br />        <span class="kw1">return</span> dictionary<br />            <span class="sy0">.</span><span class="me1">SelectMany</span><span class="br0">&#40;</span>keyValuePair <span class="sy0">=&gt;</span> keyValuePair<span class="sy0">.</span><span class="kw1">Value</span><span class="sy0">.</span><span class="kw1">Select</span><span class="br0">&#40;</span>item <span class="sy0">=&gt;</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> KeyValuePair<span class="sy0">&lt;</span>TItem, TKey<span class="sy0">&gt;</span><span class="br0">&#40;</span>item, keyValuePair<span class="sy0">.</span><span class="me1">Key</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><br />            <span class="sy0">.</span><span class="me1">GroupBy</span><span class="br0">&#40;</span>keyValuePair <span class="sy0">=&gt;</span> keyValuePair<span class="sy0">.</span><span class="me1">Key</span><span class="br0">&#41;</span><br />            <span class="sy0">.</span><span class="me1">ToDictionary</span><span class="br0">&#40;</span><span class="kw1">group</span> <span class="sy0">=&gt;</span> <span class="kw1">group</span><span class="sy0">.</span><span class="me1">Key</span>, <span class="kw1">group</span> <span class="sy0">=&gt;</span> <span class="kw1">group</span><span class="sy0">.</span><span class="kw1">Select</span><span class="br0">&#40;</span>keyValuePair <span class="sy0">=&gt;</span> keyValuePair<span class="sy0">.</span><span class="kw1">Value</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span><br />    <span class="br0">&#125;</span><br />&#160;<br />    <span class="kw1">static</span> <span class="kw4">void</span> Main<span class="br0">&#40;</span><span class="br0">&#41;</span><br />    <span class="br0">&#123;</span><br />        Console<span class="sy0">.</span><span class="me1">Write</span><span class="br0">&#40;</span><span class="st0">&quot;files: &quot;</span><span class="br0">&#41;</span><span class="sy0">;</span><br />        <span class="kw1">var</span> files <span class="sy0">=</span> Console<span class="sy0">.</span><span class="me1">ReadLine</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span><br />        Console<span class="sy0">.</span><span class="me1">Write</span><span class="br0">&#40;</span><span class="st0">&quot;find: &quot;</span><span class="br0">&#41;</span><span class="sy0">;</span><br />        <span class="kw1">var</span> find <span class="sy0">=</span> Console<span class="sy0">.</span><span class="me1">ReadLine</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span><br />        <span class="kw1">var</span> dictionary <span class="sy0">=</span> files<span class="sy0">.</span><span class="me1">Split</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">.</span><span class="me1">ToDictionary</span><span class="br0">&#40;</span>file <span class="sy0">=&gt;</span> file, file <span class="sy0">=&gt;</span> File<span class="sy0">.</span><span class="me1">ReadAllText</span><span class="br0">&#40;</span>file<span class="br0">&#41;</span><span class="sy0">.</span><span class="me1">Split</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">.</span><span class="me1">AsEnumerable</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span><br />        Console<span class="sy0">.</span><span class="me1">WriteLine</span><span class="br0">&#40;</span><span class="st0">&quot;{0} found in: {1}&quot;</span>, find, <span class="kw4">string</span><span class="sy0">.</span><span class="kw1">Join</span><span class="br0">&#40;</span><span class="st0">&quot; &quot;</span>, Invert<span class="br0">&#40;</span>dictionary<span class="br0">&#41;</span><span class="br0">&#91;</span>find<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span><br />    <span class="br0">&#125;</span><br /><span class="br0">&#125;</span></pre>
<p>Sample output:
</p>
<pre class="text highlighted_source">files: file1 file2 file3<br />find: what<br />what found in: file1 file2</pre>
<h2><span class="mw-headline" id="Clojure"><a href="/wiki/Category:Clojure" title="Category:Clojure">Clojure</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/mw/index.php?title=Inverted_index&amp;action=edit&amp;section=11" title="Edit section: Clojure">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<pre class="clojure highlighted_source"><span class="br0">&#40;</span><span class="kw1">ns</span> inverted<span class="sy0">-</span>index<span class="sy0">.</span>core<br />  <span class="br0">&#40;</span>:<span class="me1">require</span> <span class="br0">&#91;</span>clojure<span class="sy0">.</span><span class="kw1">set</span>&#160;:<span class="me1">as</span> sets<span class="br0">&#93;</span><br />            <span class="br0">&#91;</span>clojure<span class="sy0">.</span>java<span class="sy0">.</span>io&#160;:<span class="me1">as</span> io<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><br />&#160;<br /><span class="br0">&#40;</span><span class="kw1">def</span> pattern #<span class="st0">&quot;<span class="es0">\w</span>+&quot;</span><span class="br0">&#41;</span>     <span class="co1">; Java regex for a raw term: here a substring of alphanums</span><br /><span class="br0">&#40;</span><span class="kw1">defn</span> normalize <span class="br0">&#91;</span>match<span class="br0">&#93;</span> <span class="br0">&#40;</span><span class="sy0">.</span>toLowerCase match<span class="br0">&#41;</span><span class="br0">&#41;</span>  <span class="co1">; normalization of a raw term</span><br />&#160;<br /><span class="br0">&#40;</span><span class="kw1">defn</span> term<span class="sy0">-</span>seq <span class="br0">&#91;</span>text<span class="br0">&#93;</span> <span class="br0">&#40;</span><span class="kw1">map</span> normalize <span class="br0">&#40;</span><span class="kw1">re-seq</span> pattern text<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><br />&#160;<br /><span class="br0">&#40;</span><span class="kw1">defn</span> set<span class="sy0">-</span><span class="kw1">assoc</span> <br />  <span class="st0">&quot;Produces map with v added to the set associated with key k in map m&quot;</span><br />  <span class="br0">&#91;</span>m k v<span class="br0">&#93;</span> <span class="br0">&#40;</span><span class="kw1">assoc</span> m k <span class="br0">&#40;</span><span class="kw1">conj</span> <span class="br0">&#40;</span>get m k #<span class="br0">&#123;</span><span class="br0">&#12#125;</span><span class="br0">&#41;</span> v<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><br />&#160;<br /><span class="br0">&#40;</span><span class="kw1">defn</span> index<span class="sy0">-</span>file <span class="br0">&#91;</span>index file<span class="br0">&#93;</span><br />  <span class="br0">&#40;</span><span class="kw1">with-open</span> <span class="br0">&#91;</span>reader <span class="br0">&#40;</span>io<span class="sy0">/</span>reader file<span class="br0">&#41;</span><span class="br0">&#93;</span><br />    <span class="br0">&#40;</span><span class="kw1">reduce</span><br />      <span class="br0">&#40;</span><span class="kw1">fn</span> <span class="br0">&#91;</span>idx term<span class="br0">&#93;</span> <span class="br0">&#40;</span>set<span class="sy0">-</span><span class="kw1">assoc</span> idx term file<span class="br0">&#41;</span><span class="br0">&#41;</span><br />      index<br />      <span class="br0">&#40;</span><span class="kw1">mapcat</span> term<span class="sy0">-</span>seq <span class="br0">&#40;</span><span class="kw1">line-seq</span> reader<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><br />&#160;<br /><span class="br0">&#40;</span><span class="kw1">defn</span> make<span class="sy0">-</span>index <span class="br0">&#91;</span>files<span class="br0">&#93;</span><br />  <span class="br0">&#40;</span><span class="kw1">reduce</span> index<span class="sy0">-</span>file <span class="br0">&#123;</span><span class="br0">&#125;</span> files<span class="br0">&#41;</span><span class="br0">&#41;</span><br />&#160;<br /><span class="br0">&#40;</span><span class="kw1">defn</span> search <span class="br0">&#91;</span>index query<span class="br0">&#93;</span><br />  <span class="br0">&#40;</span><span class="kw1">apply</span> sets<span class="sy0">/</span>intersection <span class="br0">&#40;</span><span class="kw1">map</span> index <span class="br0">&#40;</span>term<span class="sy0">-</span>seq query<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><br />&#160;</pre>
<h2><span class="mw-headline" id="CoffeeScript"><a href="/wiki/Category:CoffeeScript" title="Category:CoffeeScript">CoffeeScript</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/mw/index.php?title=Inverted_index&amp;action=edit&amp;section=12" title="Edit section: CoffeeScript">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<pre class="coffeescript highlighted_source">&#160;<br />fs = require <span class="st0">'fs'</span><br />&#160;<br />make_index = <span class="br0">&#40;</span>fns<span class="br0">&#41;</span> <span class="sy0">-&gt;</span><br />  <span class="co1"># words are indexed by filename and 1-based line numbers</span><br />  index = <span class="br0">&#123;</span><span class="br0">&#125;</span><br />  <span class="kw1">for</span> fn <span class="kw1">in</span> fns<br />    <span class="kw1">for</span> line<span class="sy0">,</span> line_num <span class="kw1">in</span> fs.<span class="me1">readFileSync</span><span class="br0">&#40;</span>fn<span class="br0">&#41;</span>.<span class="me1">toString</span><span class="br0">&#40;</span><span class="br0">&#41;</span>.<span class="me1">split</span> <span class="st0">'<span class="es0">\n</span>'</span><br />      words = get_words line<br />      <span class="kw1">for</span> word <span class="kw1">in</span> words<br />        word = mangle<span class="br0">&#40;</span>word<span class="br0">&#41;</span><br />        index<span class="br0">&#91;</span>word<span class="br0">&#93;</span> <span class="sy0">||</span>= <span class="br0">&#91;</span><span class="br0">&#93;</span><br />        index<span class="br0">&#91;</span>word<span class="br0">&#93;</span>.<span class="me1">push</span> <span class="br0">&#91;</span>fn<span class="sy0">,</span> line_num<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span><br />  index<br />&#160;<br />grep = <span class="br0">&#40;</span>index<span class="sy0">,</span> word<span class="br0">&#41;</span> <span class="sy0">-&gt;</span><br />  console.<span class="me1">log</span> <span class="st0">&quot;locations for '#{word}':&quot;</span><br />  locations = index<span class="br0">&#91;</span>mangle<span class="br0">&#40;</span>word<span class="br0">&#41;</span><span class="br0">&#93;</span> <span class="sy0">||</span> <span class="br0">&#91;</span><span class="br0">&#93;</span><br />  <span class="kw1">for</span> location <span class="kw1">in</span> locations<br />    <span class="br0">&#91;</span>fn<span class="sy0">,</span> line_num<span class="br0">&#93;</span> = location<br />    console.<span class="me1">log</span> <span class="st0">&quot;#{fn}:#{line_num}&quot;</span><br />  console.<span class="me1">log</span> <span class="st0">&quot;<span class="es0">\n</span>&quot;</span><br />&#160;<br />get_words = <span class="br0">&#40;</span>line<span class="br0">&#41;</span> <span class="sy0">-&gt;</span><br />  words = line.<span class="me1">replace</span><span class="br0">&#40;</span><span class="sy0">/</span>\W<span class="sy0">/</span>g<span class="sy0">,</span> <span class="st0">' '</span><span class="br0">&#41;</span>.<span class="me1">split</span> <span class="st0">' '</span><br />  <span class="br0">&#40;</span>word <span class="kw1">for</span> word <span class="kw1">in</span> words <span class="kw1">when</span> word <span class="sy0">!</span>= <span class="st0">''</span><span class="br0">&#41;</span><br />&#160;<br />mangle = <span class="br0">&#40;</span>word<span class="br0">&#41;</span> <span class="sy0">-&gt;</span><br />  <span class="co1"># avoid conflicts with words like &quot;constructor&quot;</span><br />  <span class="st0">'_'</span> <span class="sy0">+</span> word<br />&#160;<br />do <span class="sy0">-&gt;</span><br />  fns = <span class="br0">&#40;</span>fn <span class="kw1">for</span> fn <span class="kw1">in</span> fs.<span class="me1">readdirSync</span><span class="br0">&#40;</span><span class="st0">'.'</span><span class="br0">&#41;</span> <span class="kw1">when</span> fn.<span class="me1">match</span> <span class="sy0">/</span>\.<span class="me1">coffee</span><span class="sy0">/</span><span class="br0">&#41;</span><br />  index = make_index<span class="br0">&#40;</span>fns<span class="br0">&#41;</span><br />  grep index<span class="sy0">,</span> <span class="st0">'make_index'</span><br />  grep index<span class="sy0">,</span> <span class="st0">'sort'</span><br />&#160;</pre>
<p>output
</p>
<pre class="text highlighted_source">&#160;<br />&gt; coffee inverted_index.coffee <br />locations for 'make_index':<br />inverted_index.coffee:3<br />inverted_index.coffee:33<br />inverted_index.coffee:34<br />&#160;<br />&#160;<br />locations for 'sort':<br />anagrams.coffee:8<br />derangements.coffee:14<br />heap.coffee:34<br />heap.coffee:43<br />huffman.coffee:81<br />inverted_index.coffee:35<br />knuth_sample.coffee:12<br />&#160;</pre>
<p><br />
</p>
<h2><span class="mw-headline" id="Common_Lisp"><a href="/wiki/Category:Common_Lisp" title="Category:Common Lisp">Common Lisp</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/mw/index.php?title=Inverted_index&amp;action=edit&amp;section=13" title="Edit section: Common Lisp">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<pre class="lisp highlighted_source"><span class="br0">&#40;</span>defpackage rosettacode<span class="sy0">.</span>inverted-index<br />  <span class="br0">&#40;</span><span class="sy0">:</span><span class="me1">use</span> cl<span class="br0">&#41;</span><span class="br0">&#41;</span><br /><span class="br0">&#40;</span>in-package rosettacode<span class="sy0">.</span>inverted-index<span class="br0">&#41;</span><br />&#160;<br /><span class="co1">;; Return a list of tokens in the string LINE.  This is rather</span><br /><span class="co1">;; complicated as CL has no good standard function to do it.</span><br /><span class="br0">&#40;</span><span class="kw1">defun</span> tokenize <span class="br0">&#40;</span>line<span class="br0">&#41;</span><br />  <span class="br0">&#40;</span><span class="kw1">let</span> <span class="br0">&#40;</span><span class="br0">&#40;</span>start <span class="nu0">0</span><span class="br0">&#41;</span> <span class="br0">&#40;</span>len <span class="br0">&#40;</span><span class="kw1">length</span> line<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><br />    <span class="br0">&#40;</span>loop for s <span class="sy0">=</span> <span class="br0">&#40;</span>position-<span class="kw1">if</span> #'alphanumericp line <span class="sy0">:</span><span class="me1">start</span> start<span class="br0">&#41;</span><br />          while s<br />          for e <span class="sy0">=</span> <span class="br0">&#40;</span>position-if-<span class="kw1">not</span> #'alphanumericp line <span class="sy0">:</span><span class="me1">start</span> <span class="br0">&#40;</span><span class="nu0">1</span>+ s<span class="br0">&#41;</span><span class="br0">&#41;</span><br />          collect <span class="br0">&#40;</span>subseq line s e<span class="br0">&#41;</span><br />          while <span class="br0">&#40;</span><span class="kw1">and</span> e <span class="br0">&#40;</span><span class="sy0">&lt;</span> e len<span class="br0">&#41;</span><span class="br0">&#41;</span><br />          <span class="kw1">do</span> <span class="br0">&#40;</span><span class="kw1">setq</span> start e<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><br />&#160;<br /><span class="br0">&#40;</span><span class="kw1">defun</span> index-file <span class="br0">&#40;</span>index filename<span class="br0">&#41;</span><br />  <span class="br0">&#40;</span>with-open-file <span class="br0">&#40;</span>in filename<span class="br0">&#41;</span><br />    <span class="br0">&#40;</span>loop for line <span class="sy0">=</span> <span class="br0">&#40;</span>read-line in <span class="kw1">nil</span> <span class="kw1">nil</span><span class="br0">&#41;</span><br />          while line<br />          <span class="kw1">do</span> <span class="br0">&#40;</span><span class="kw1">dolist</span> <span class="br0">&#40;</span>token <span class="br0">&#40;</span>tokenize line<span class="br0">&#41;</span><span class="br0">&#41;</span><br />               <span class="br0">&#40;</span>pushnew filename <span class="br0">&#40;</span>gethash token index '<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><br />&#160;<br /><span class="br0">&#40;</span><span class="kw1">defun</span> build-index <span class="br0">&#40;</span>filenames<span class="br0">&#41;</span><br />  <span class="br0">&#40;</span><span class="kw1">let</span> <span class="br0">&#40;</span><span class="br0">&#40;</span>index <span class="br0">&#40;</span>make-hash-table <span class="sy0">:</span><span class="me1">test</span> #'<span class="kw1">equal</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><br />    <span class="br0">&#40;</span><span class="kw1">dolist</span> <span class="br0">&#40;</span>f filenames<span class="br0">&#41;</span><br />      <span class="br0">&#40;</span>index-file index f<span class="br0">&#41;</span><span class="br0">&#41;</span><br />    index<span class="br0">&#41;</span><span class="br0">&#41;</span><br />&#160;<br /><span class="co1">;; Find the files for QUERY.  We use the same tokenizer for the query</span><br /><span class="co1">;; as for files.</span><br /><span class="br0">&#40;</span><span class="kw1">defun</span> lookup <span class="br0">&#40;</span>index query<span class="br0">&#41;</span><br />  <span class="br0">&#40;</span>remove-duplicates <span class="br0">&#40;</span>loop for token in <span class="br0">&#40;</span>tokenize query<span class="br0">&#41;</span><br />                           <span class="kw1">append</span> <span class="br0">&#40;</span>gethash token index<span class="br0">&#41;</span><span class="br0">&#41;</span><br />                     <span class="sy0">:</span><span class="me1">test</span> #'<span class="kw1">equal</span><span class="br0">&#41;</span><span class="br0">&#41;</span><br />&#160;<br />&#160;</pre>
<p>Example:
</p>
<pre class="lisp highlighted_source"><span class="br0">&#40;</span>defparameter *index* <span class="br0">&#40;</span>build-index '<span class="br0">&#40;</span><span class="st0">&quot;file1.txt&quot;</span> <span class="st0">&quot;file2.txt&quot;</span> <span class="st0">&quot;file3.txt&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><br /><span class="br0">&#40;</span>defparameter *query* <span class="st0">&quot;foo bar&quot;</span><span class="br0">&#41;</span><br /><span class="br0">&#40;</span>defparameter *result* <span class="br0">&#40;</span>lookup *index* *query*<span class="br0">&#41;</span><span class="br0">&#41;</span><br /><span class="br0">&#40;</span>format t <span class="st0">&quot;Result for query ~s: ~{~a~^, ~}~%&quot;</span> *query* *result*<span class="br0">&#41;</span></pre>
<h2><span class="mw-headline" id="D"><a href="/wiki/Category:D" title="Category:D">D</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/mw/index.php?title=Inverted_index&amp;action=edit&amp;section=14" title="Edit section: D">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<pre class="d highlighted_source"><span class="kw2">import</span> std.<span class="me1">stdio</span><span class="sy0">,</span> std.<span class="me1">algorithm</span><span class="sy0">,</span> std.<span class="kw4">string</span><span class="sy0">,</span> std.<span class="me1">file</span><span class="sy0">,</span> std.<span class="me1">regex</span><span class="sy0">;</span><br />&#160;<br /><span class="kw4">void</span> main<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><br />    <span class="kw4">string</span><span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#91;</span><span class="kw4">string</span><span class="br0">&#93;</span> index<span class="sy0">;</span><br />&#160;<br />    <span class="kw4">void</span> parseFile<span class="br0">&#40;</span><span class="kw2">in</span> <span class="kw4">string</span> fn<span class="br0">&#41;</span> <span class="br0">&#123;</span><br />        <span class="kw1">if</span> <span class="br0">&#40;</span><span class="sy0">!</span>exists<span class="br0">&#40;</span>fn<span class="br0">&#41;</span> <span class="sy0">||</span> <span class="sy0">!</span>isFile<span class="br0">&#40;</span>fn<span class="br0">&#41;</span><span class="br0">&#41;</span><br />            <span class="kw2">throw</span> <span class="kw2">new</span> <span class="kw3">Exception</span><span class="br0">&#40;</span><span class="st0">&quot;File not found&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span><br />&#160;<br />        <span class="kw1">foreach</span> <span class="br0">&#40;</span>word<span class="sy0">;</span> readText<span class="br0">&#40;</span>fn<span class="br0">&#41;</span>.<span class="me1">splitter</span><span class="br0">&#40;</span>regex<span class="br0">&#40;</span><span class="co4">r&quot;\W&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><br />            word <span class="sy0">=</span> word.<span class="me1">toLower</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span><br />            <span class="kw1">if</span> <span class="br0">&#40;</span><span class="sy0">!</span>index.<span class="me1">get</span><span class="br0">&#40;</span>word<span class="sy0">,</span> <span class="kw2">null</span><span class="br0">&#41;</span>.<span class="me1">canFind</span><span class="br0">&#40;</span>fn<span class="br0">&#41;</span><span class="br0">&#41;</span><br />                index<span class="br0">&#91;</span>word<span class="br0">&#93;</span> <span class="sy0">~=</span> fn<span class="sy0">;</span><br />        <span class="br0">&#125;</span><br />    <span class="br0">&#125;</span><br />&#160;<br />    <span class="kw4">immutable</span> fileNames <span class="sy0">=</span> <span class="br0">&#91;</span><span class="st0">&quot;inv1.txt&quot;</span><span class="sy0">,</span> <span class="st0">&quot;inv2.txt&quot;</span><span class="sy0">,</span> <span class="st0">&quot;inv3.txt&quot;</span><span class="br0">&#93;</span><span class="sy0">;</span><br />    <span class="kw1">foreach</span> <span class="br0">&#40;</span>fName<span class="sy0">;</span> fileNames<span class="br0">&#41;</span><br />        parseFile<span class="br0">&#40;</span>fName<span class="br0">&#41;</span><span class="sy0">;</span><br />&#160;<br />    <span class="kw1">while</span> <span class="br0">&#40;</span><span class="kw2">true</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><br />        writef<span class="br0">&#40;</span><span class="st0">&quot;<span class="es1">\n</span>Enter a word to search for: (q to quit): &quot;</span><span class="br0">&#41;</span><span class="sy0">;</span><br />        <span class="kw4">immutable</span> w <span class="sy0">=</span> readln<span class="br0">&#40;</span><span class="br0">&#41;</span>.<span class="me1">strip</span><span class="br0">&#40;</span><span class="br0">&#41;</span>.<span class="me1">toLower</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span><br />        <span class="kw1">if</span> <span class="br0">&#40;</span>w <span class="sy0">==</span> <span class="st0">&quot;q&quot;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><br />            writeln<span class="br0">&#40;</span><span class="st0">&quot;quitting.&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span><br />            <span class="kw1">break</span><span class="sy0">;</span><br />        <span class="br0">&#125;</span><br />        <span class="kw1">if</span> <span class="br0">&#40;</span>w <span class="kw2">in</span> index<span class="br0">&#41;</span><br />            writefln<span class="br0">&#40;</span><span class="st0">&quot;'%s' found in%(&#160;%).&quot;</span><span class="sy0">,</span> w<span class="sy0">,</span> index<span class="br0">&#91;</span>w<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">;</span><br />        <span class="kw1">else</span><br />            writefln<span class="br0">&#40;</span><span class="st0">&quot;'%s' not found.&quot;</span><span class="sy0">,</span> w<span class="br0">&#41;</span><span class="sy0">;</span><br />    <span class="br0">&#125;</span><br /><span class="br0">&#125;</span></pre>
<p>Both the demo text files and the queries are from the Wikipedia page, they contain:
</p>
<pre>It is what it is.
</pre>
<pre>What is it?
</pre>
<pre>It is a banana!
</pre>
<div>
<dl><dt>Output:</div></dt></dl>
<pre>Enter a word to search for: (q to quit): cat
'cat' not found.

Enter a word to search for: (q to quit): is
'is' found in &quot;inv1.txt&quot; &quot;inv2.txt&quot; &quot;inv3.txt&quot;.

Enter a word to search for: (q to quit): banana
'banana' found in &quot;inv3.txt&quot;.

Enter a word to search for: (q to quit): it
'it' found in &quot;inv1.txt&quot; &quot;inv2.txt&quot; &quot;inv3.txt&quot;.

Enter a word to search for: (q to quit): what
'what' found in &quot;inv1.txt&quot; &quot;inv2.txt&quot;.

Enter a word to search for: (q to quit): q
quitting.</pre>
<h2><span class="mw-headline" id="EchoLisp"><a href="/wiki/Category:EchoLisp" title="Category:EchoLisp">EchoLisp</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/mw/index.php?title=Inverted_index&amp;action=edit&amp;section=15" title="Edit section: EchoLisp">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<h3><span class="mw-headline" id="Indexing">Indexing</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/mw/index.php?title=Inverted_index&amp;action=edit&amp;section=16" title="Edit section: Indexing">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Index values are sets associated with each word (key). We use the local-put-value function to permanently store the index, in the browser local storage.
</p>
<pre class="lisp highlighted_source">&#160;<br /><span class="co1">;; set of input files</span><br /><span class="br0">&#40;</span>define FILES <span class="br0">&#123;</span>T0<span class="sy0">.</span>txt T1<span class="sy0">.</span>txt T2<span class="sy0">.</span>txt<span class="br0">&#125;</span><span class="br0">&#41;</span><br /><span class="co1">;; store name for permanent inverted index</span><br /><span class="br0">&#40;</span>define INVERT <span class="st0">&quot;INVERTED-INDEX&quot;</span><span class="br0">&#41;</span><br />&#160;<br /><span class="co1">;; get text for each file, and call (action filename text)</span><br /><span class="br0">&#40;</span>define <span class="br0">&#40;</span>map-files action files<span class="br0">&#41;</span> <br />	<span class="br0">&#40;</span>for <span class="br0">&#40;</span><span class="br0">&#40;</span>file files<span class="br0">&#41;</span><span class="br0">&#41;</span> <br />	<span class="br0">&#40;</span>file-<span class="sy0">&gt;</span>string action file<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><br />&#160;<br /><span class="co1">;; create store </span><br /><span class="br0">&#40;</span>local-make-store INVERT<span class="br0">&#41;</span><br />&#160;<br /><span class="co1">; invert-word&#160;: word -&gt; set of files</span><br /><span class="br0">&#40;</span>define <span class="br0">&#40;</span>invert-word word file store<span class="br0">&#41;</span><br />	    <span class="br0">&#40;</span>local-put-<span class="kw1">value</span> word <br />	    	<span class="br0">&#40;</span>make-<span class="kw1">set</span>  <span class="br0">&#40;</span><span class="kw1">cons</span> file <span class="br0">&#40;</span>local-get-<span class="kw1">value</span> word store<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span> store<span class="br0">&#41;</span><span class="br0">&#41;</span><br />&#160;<br /><span class="co1">; parse file text and invert each word</span><br /><span class="br0">&#40;</span>define <span class="br0">&#40;</span>invert-text file text<span class="br0">&#41;</span><br />		<span class="br0">&#40;</span>writeln 'Inverting file text<span class="br0">&#41;</span><br />		<span class="br0">&#40;</span><span class="kw1">let</span> <span class="br0">&#40;</span><span class="br0">&#40;</span>text <span class="br0">&#40;</span>text-parse text<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><br />		<span class="br0">&#40;</span>for <span class="br0">&#40;</span><span class="br0">&#40;</span>word text<span class="br0">&#41;</span><span class="br0">&#41;</span>  <span class="br0">&#40;</span>invert-word <span class="br0">&#40;</span>string-downcase word<span class="br0">&#41;</span> file INVERT<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><br />&#160;</pre>
<h3><span class="mw-headline" id="Query">Query</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/mw/index.php?title=Inverted_index&amp;action=edit&amp;section=17" title="Edit section: Query">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Intersect sets values of each word.
</p>
<pre class="lisp highlighted_source">&#160;<br /><span class="co1">;; usage&#160;: (inverted-search w1 w2 ..) </span><br /><span class="br0">&#40;</span>define-syntax-rule <span class="br0">&#40;</span>inverted-search w <span class="sy0">...</span><span class="br0">&#41;</span> <br />			<span class="br0">&#40;</span>and-get-invert <span class="br0">&#40;</span><span class="kw1">quote</span> w <span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><br />&#160;<br /><span class="co1">;; intersects all sets referenced by words</span><br /><span class="co1">;; returns the intersection</span><br /><span class="br0">&#40;</span>define <span class="br0">&#40;</span>and-get-invert words<span class="br0">&#41;</span><br />		<span class="br0">&#40;</span>foldl <br />			<span class="br0">&#40;</span><span class="kw1">lambda</span><span class="br0">&#40;</span>word res<span class="br0">&#41;</span> <br />				 <span class="br0">&#40;</span>set-intersect res <span class="br0">&#40;</span>local-get-<span class="kw1">value</span> word  INVERT<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><br />			FILES words<span class="br0">&#41;</span><span class="br0">&#41;</span><br />&#160;</pre>
<p>Output&#160;:
</p>
<pre class="lisp highlighted_source">&#160;<br /><span class="br0">&#40;</span>map-files invert-text FILES<span class="br0">&#41;</span><br /><span class="br0">&#40;</span>inverted-search is it<span class="br0">&#41;</span><br /><span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span>? <span class="br0">&#123;</span> T0<span class="sy0">.</span>txt T1<span class="sy0">.</span>txt T2<span class="sy0">.</span>txt <span class="br0">&#125;</span><br /><span class="br0">&#40;</span>inverted-search is banana<span class="br0">&#41;</span><br /><span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span>? <span class="br0">&#123;</span> T2<span class="sy0">.</span>txt <span class="br0">&#125;</span><br /><span class="br0">&#40;</span>inverted-search is what<span class="br0">&#41;</span><br /><span class="br0">&#91;</span><span class="nu0">2</span><span class="br0">&#93;</span>? <span class="br0">&#123;</span> T0<span class="sy0">.</span>txt T1<span class="sy0">.</span>txt <span class="br0">&#125;</span><br /><span class="br0">&#40;</span>inverted-search boule<span class="br0">&#41;</span><br /><span class="br0">&#91;</span><span class="nu0">3</span><span class="br0">&#93;</span>? <span class="kw1">null</span><br />&#160;</pre>
<p><br />
</p>
<h2><span class="mw-headline" id="Erlang"><a href="/wiki/Category:Erlang" title="Category:Erlang">Erlang</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/mw/index.php?title=Inverted_index&amp;action=edit&amp;section=18" title="Edit section: Erlang">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>This might be used with a lot of large files so we use binaries to save space. That adds &lt;&lt;&gt;&gt; to the search terms.
If somebody wants to avoid "end." and "end" being two different terms, just add &lt;&lt;"."&gt;&gt; to binary:compile_pattern/1
Ditto for any other character.
</p>
<pre class="erlang highlighted_source">&#160;<br /><span class="sy3">-</span><span class="re2">module</span><span class="br0">&#40;</span> inverted_index <span class="br0">&#41;</span><span class="sy1">.</span><br />&#160;<br /><span class="sy3">-</span><span class="re2">export</span><span class="br0">&#40;</span> <span class="br0">&#91;</span>from_files<span class="sy3">/</span><span class="nu0">1</span><span class="sy1">,</span> search<span class="sy3">/</span><span class="nu0">2</span><span class="sy1">,</span> task<span class="sy3">/</span><span class="nu0">0</span><span class="br0">&#93;</span> <span class="br0">&#41;</span><span class="sy1">.</span><br />&#160;<br /><span class="re3">from_files</span><span class="br0">&#40;</span> <span class="re5">Files</span> <span class="br0">&#41;</span> <span class="sy1">-&gt;</span><br />        <a href="http://erlang.org/doc/man/lists.html"><span class="kw5">lists</span></a>:<span class="re3">foldl</span><span class="br0">&#40;</span> <span class="kw1">fun</span> import_from_file<span class="sy3">/</span><span class="nu0">2</span><span class="sy1">,</span> <a href="http://erlang.org/doc/man/dict.html"><span class="kw5">dict</span></a>:<span class="re3">new</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy1">,</span> <span class="re5">Files</span> <span class="br0">&#41;</span><span class="sy1">.</span><br />&#160;<br /><span class="re3">search</span><span class="br0">&#40;</span>	<span class="re5">Binaries</span><span class="sy1">,</span> <span class="re5">Inverted_index</span> <span class="br0">&#41;</span> <span class="sy1">-&gt;</span><br />        <span class="br0">&#91;</span><span class="re5">Files</span> | <span class="re5">T</span><span class="br0">&#93;</span> <span class="sy3">=</span> <span class="br0">&#91;</span><a href="http://erlang.org/doc/man/dict.html"><span class="kw5">dict</span></a>:<span class="re3">fetch</span><span class="br0">&#40;</span><span class="re5">X</span><span class="sy1">,</span> <span class="re5">Inverted_index</span><span class="br0">&#41;</span> <span class="sy3">||</span> <span class="re5">X</span> <span class="sy3">&lt;-</span> <span class="re5">Binaries</span><span class="br0">&#93;</span><span class="sy1">,</span><br />        <a href="http://erlang.org/doc/man/lists.html"><span class="kw5">lists</span></a>:<span class="re3">foldl</span><span class="br0">&#40;</span> <span class="kw1">fun</span> search_common<span class="sy3">/</span><span class="nu0">2</span><span class="sy1">,</span> <span class="re5">Files</span><span class="sy1">,</span> <span class="re5">T</span> <span class="br0">&#41;</span><span class="sy1">.</span><br />&#160;<br /><span class="re3">task</span><span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="sy1">-&gt;</span><br />       <span class="re5">Files_contents</span> <span class="sy3">=</span> <span class="br0">&#91;</span><span class="br0">&#123;</span><span class="st0">&quot;file_1&quot;</span><span class="sy1">,</span> <span class="sy2">&lt;&lt;</span><span class="st0">&quot;it is what it is&quot;</span><span class="sy2">&gt;&gt;</span><span class="br0">&#125;</span><span class="sy1">,</span> <span class="br0">&#123;</span><span class="st0">&quot;file_2&quot;</span><span class="sy1">,</span> <span class="sy2">&lt;&lt;</span><span class="st0">&quot;what is it&quot;</span><span class="sy2">&gt;&gt;</span><span class="br0">&#125;</span><span class="sy1">,</span> <span class="br0">&#123;</span><span class="st0">&quot;file_3&quot;</span><span class="sy1">,</span> <span class="sy2">&lt;&lt;</span><span class="st0">&quot;it is a banana&quot;</span><span class="sy2">&gt;&gt;</span><span class="br0">&#125;</span><span class="br0">&#93;</span><span class="sy1">,</span><br />       <span class="br0">&#91;</span><a href="http://erlang.org/doc/man/file.html"><span class="kw5">file</span></a>:<span class="re3">write_file</span><span class="br0">&#40;</span><span class="re5">X</span><span class="sy1">,</span> <span class="re5">Y</span><span class="br0">&#41;</span> <span class="sy3">||</span> <span class="br0">&#123;</span><span class="re5">X</span><span class="sy1">,</span> <span class="re5">Y</span><span class="br0">&#125;</span> <span class="sy3">&lt;-</span> <span class="re5">Files_contents</span><span class="br0">&#93;</span><span class="sy1">,</span><br />       <span class="re5">Inverted_index</span> <span class="sy3">=</span> <span class="re3">from_files</span><span class="br0">&#40;</span> <span class="br0">&#91;</span><span class="re5">X</span> <span class="sy3">||</span> <span class="br0">&#123;</span><span class="re5">X</span><span class="sy1">,</span> <span class="re5">_Y</span><span class="br0">&#125;</span> <span class="sy3">&lt;-</span> <span class="re5">Files_contents</span><span class="br0">&#93;</span> <span class="br0">&#41;</span><span class="sy1">,</span><br />       <span class="re5">Result</span> <span class="sy3">=</span> <span class="re3">search</span><span class="br0">&#40;</span> <span class="br0">&#91;</span><span class="sy2">&lt;&lt;</span><span class="st0">&quot;what&quot;</span><span class="sy2">&gt;&gt;</span><span class="sy1">,</span> <span class="sy2">&lt;&lt;</span><span class="st0">&quot;is&quot;</span><span class="sy2">&gt;&gt;</span><span class="sy1">,</span> <span class="sy2">&lt;&lt;</span><span class="st0">&quot;it&quot;</span><span class="sy2">&gt;&gt;</span><span class="br0">&#93;</span><span class="sy1">,</span> <span class="re5">Inverted_index</span> <span class="br0">&#41;</span><span class="sy1">,</span><br />       <a href="http://erlang.org/doc/man/io.html"><span class="kw5">io</span></a>:<span class="re3">fwrite</span><span class="br0">&#40;</span> <span class="st0">&quot;~p~n&quot;</span><span class="sy1">,</span> <span class="br0">&#91;</span><span class="re5">Result</span><span class="br0">&#93;</span> <span class="br0">&#41;</span><span class="sy1">,</span><br />       <span class="br0">&#91;</span><a href="http://erlang.org/doc/man/file.html"><span class="kw5">file</span></a>:<span class="re3">delete</span><span class="br0">&#40;</span><span class="re5">X</span><span class="br0">&#41;</span> <span class="sy3">||</span> <span class="br0">&#123;</span><span class="re5">X</span><span class="sy1">,</span> <span class="re5">_Y</span><span class="br0">&#125;</span> <span class="sy3">&lt;-</span> <span class="re5">Files_contents</span><span class="br0">&#93;</span><span class="sy1">.</span><br />&#160;<br />&#160;<br />&#160;<br /><span class="re3">import_from_file</span><span class="br0">&#40;</span> <span class="re5">File</span><span class="sy1">,</span> <span class="re5">Dict_acc</span> <span class="br0">&#41;</span> <span class="sy1">-&gt;</span><br />        <span class="re5">New_dict</span> <span class="sy3">=</span> <a href="http://erlang.org/doc/man/dict.html"><span class="kw5">dict</span></a>:<span class="re3">from_list</span><span class="br0">&#40;</span> <span class="re3">import_from_file_contents</span><span class="br0">&#40;</span><span class="re5">File</span><span class="sy1">,</span> <a href="http://erlang.org/doc/man/file.html"><span class="kw5">file</span></a>:<span class="re3">read_file</span><span class="br0">&#40;</span><span class="re5">File</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="br0">&#41;</span><span class="sy1">,</span><br />	<a href="http://erlang.org/doc/man/dict.html"><span class="kw5">dict</span></a>:<span class="re3">merge</span><span class="br0">&#40;</span> <span class="kw1">fun</span> import_from_file_merge<span class="sy3">/</span><span class="nu0">3</span><span class="sy1">,</span> <span class="re5">Dict_acc</span><span class="sy1">,</span> <span class="re5">New_dict</span> <span class="br0">&#41;</span><span class="sy1">.</span><br />&#160;<br /><span class="re3">import_from_file_contents</span><span class="br0">&#40;</span> <span class="re5">File</span><span class="sy1">,</span> <span class="br0">&#123;</span>ok<span class="sy1">,</span> <span class="re5">Binary</span><span class="br0">&#125;</span> <span class="br0">&#41;</span> <span class="sy1">-&gt;</span><br />        <span class="br0">&#91;</span><span class="br0">&#123;</span><span class="re5">X</span><span class="sy1">,</span> <span class="br0">&#91;</span><span class="re5">File</span><span class="br0">&#93;</span><span class="br0">&#125;</span> <span class="sy3">||</span> <span class="re5">X</span> <span class="sy3">&lt;-</span> <span class="kw4">binary</span>:<span class="re3">split</span><span class="br0">&#40;</span> <span class="re5">Binary</span><span class="sy1">,</span> <span class="kw4">binary</span>:<span class="re3">compile_pattern</span><span class="br0">&#40;</span><span class="br0">&#91;</span><span class="sy2">&lt;&lt;</span><span class="st0">&quot; &quot;</span><span class="sy2">&gt;&gt;</span><span class="sy1">,</span> <span class="sy2">&lt;&lt;</span><span class="st0">&quot;<span class="es0">\n</span>&quot;</span><span class="sy2">&gt;&gt;</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy1">,</span> <span class="br0">&#91;</span>global<span class="br0">&#93;</span> <span class="br0">&#41;</span><span class="br0">&#93;</span><span class="sy1">;</span><br /><span class="re3">import_from_file_contents</span><span class="br0">&#40;</span> <span class="re5">File</span><span class="sy1">,</span> <span class="br0">&#123;</span>error<span class="sy1">,</span> <span class="re5">Error</span><span class="br0">&#125;</span> <span class="br0">&#41;</span> <span class="sy1">-&gt;</span><br />	<a href="http://erlang.org/doc/man/io.html"><span class="kw5">io</span></a>:<span class="re3">fwrite</span><span class="br0">&#40;</span> <span class="st0">&quot;Error: could not open file ~p: ~p~nContinuing with the rest of them~n&quot;</span><span class="sy1">,</span> <span class="br0">&#91;</span><span class="re5">File</span><span class="sy1">,</span>	<span class="re5">Error</span><span class="br0">&#93;</span> <span class="br0">&#41;</span><span class="sy1">,</span><br />	<span class="br0">&#91;</span><span class="br0">&#93;</span><span class="sy1">.</span><br />&#160;<br /><span class="re3">import_from_file_merge</span><span class="br0">&#40;</span>	<span class="re5">_Key</span><span class="sy1">,</span> <span class="re5">Files</span><span class="sy1">,</span> <span class="br0">&#91;</span><span class="re5">New_file</span><span class="br0">&#93;</span> <span class="br0">&#41;</span> <span class="sy1">-&gt;</span> <span class="br0">&#91;</span><span class="re5">New_file</span> | <span class="re5">Files</span><span class="br0">&#93;</span><span class="sy1">.</span><br />&#160;<br /><span class="re3">search_common</span><span class="br0">&#40;</span> <span class="re5">Files</span><span class="sy1">,</span> <span class="re5">Acc</span> <span class="br0">&#41;</span> <span class="sy1">-&gt;</span> <span class="br0">&#91;</span><span class="re5">X</span> <span class="sy3">||</span> <span class="re5">X</span> <span class="sy3">&lt;-</span> <span class="re5">Acc</span><span class="sy1">,</span> <a href="http://erlang.org/doc/man/lists.html"><span class="kw5">lists</span></a>:<span class="re3">member</span><span class="br0">&#40;</span><span class="re5">X</span><span class="sy1">,</span> <span class="re5">Files</span><span class="br0">&#41;</span><span class="br0">&#93;</span><span class="sy1">.</span><br />&#160;</pre>
<h2><span class="mw-headline" id="Factor"><a href="/wiki/Category:Factor" title="Category:Factor">Factor</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/mw/index.php?title=Inverted_index&amp;action=edit&amp;section=19" title="Edit section: Factor">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<pre class="text highlighted_source">USING: assocs fry io.encodings.utf8 io.files kernel sequences<br />sets splitting vectors&#160;;<br />IN: rosettacode.inverted-index<br />&#160;<br />: file-words ( file -- assoc )<br />    utf8 file-contents &quot; ,;:!?.()[]{}\n\r&quot; split harvest&#160;;<br />: add-to-file-list ( files file -- files )<br />    over [ swap [ adjoin ] keep ] [ nip 1vector ] if&#160;;<br />: add-to-index ( words index file -- )<br />    '[ _ [ _ add-to-file-list ] change-at ] each&#160;;<br />: (index-files) ( files index -- )<br />   [ [ [ file-words ] keep ] dip swap add-to-index ] curry each&#160;;<br />: index-files ( files -- index )<br />    H{ } clone [ (index-files) ] keep&#160;;<br />: query ( terms index -- files )<br />    [ at ] curry map [ ] [ intersect ] map-reduce&#160;;<br />&#160;</pre>
<p>Example use&#160;:
</p>
<pre class="text highlighted_source">( scratchpad ) { &quot;f1&quot; &quot;f2&quot; &quot;f3&quot; } index-files<br />&#160;<br />--- Data stack:<br />H{ { &quot;a&quot; ~vector~ } { &quot;is&quot; ~vector~ } { &quot;what&quot; ~vector~ } { ...<br />( scratchpad ) { &quot;what&quot; &quot;is&quot; &quot;it&quot; } swap query .<br />V{ &quot;f1&quot; &quot;f2&quot; }<br />&#160;</pre>
<h2><span class="mw-headline" id="F.23"><a href="/wiki/Category:F_Sharp" title="Category:F Sharp">F#</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/mw/index.php?title=Inverted_index&amp;action=edit&amp;section=20" title="Edit section: F#">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<pre class="fsharp highlighted_source"><span class="kw1">open</span> System<br /><span class="kw1">open</span> System.<span class="me1">IO</span><br />&#160;<br /><span class="co1">// Map search terms to associated set of files</span><br /><span class="kw1">type</span> searchIndexMap <span class="sy0">=</span> <a href="http://research.microsoft.com/en-us/um/cambridge/projects/fsharp/manual/namespaces.html"><span class="kw2">Map</span></a><span class="sy0">&lt;</span><span class="kw4">string</span>, <a href="http://research.microsoft.com/en-us/um/cambridge/projects/fsharp/manual/namespaces.html"><span class="kw2">Set</span></a><span class="sy0">&lt;</span><span class="kw4">string</span><span class="sy0">&gt;&gt;</span><br />&#160;<br /><span class="kw1">let</span> inputSearchCriteria<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="sy0">=</span><br />    <span class="kw1">let</span> readLine prompt <span class="sy0">=</span><br />        printf <span class="st0">&quot;%s: &quot;</span> prompt<br />        Console.<span class="me1">ReadLine</span><span class="br0">&#40;</span><span class="br0">&#41;</span>.<span class="me1">Split</span><span class="br0">&#40;</span><span class="br0">&#41;</span><br />&#160;<br />    readLine <span class="st0">&quot;Files&quot;</span>, <span class="br0">&#40;</span>readLine <span class="st0">&quot;Find&quot;</span><span class="br0">&#41;</span> <span class="sy0">|&gt;</span> <a href="http://research.microsoft.com/en-us/um/cambridge/projects/fsharp/manual/namespaces.html"><span class="kw2">Array</span></a>.<span class="me1">map</span> <span class="br0">&#40;</span><span class="kw1">fun</span> s <span class="sy0">-&gt;</span> s.<span class="me1">ToLower</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><br />&#160;<br /><span class="kw1">let</span> updateIndex indexMap keyValuePair <span class="sy0">=</span><br />    <span class="kw1">let</span> k, v <span class="sy0">=</span> keyValuePair<br />&#160;<br />    <span class="kw1">match</span> <a href="http://research.microsoft.com/en-us/um/cambridge/projects/fsharp/manual/namespaces.html"><span class="kw2">Map</span></a>.<span class="me1">tryFind</span> k indexMap <span class="kw1">with</span><br />        | None     <span class="sy0">-&gt;</span> <a href="http://research.microsoft.com/en-us/um/cambridge/projects/fsharp/manual/namespaces.html"><span class="kw2">Map</span></a>.<span class="me1">add</span> k <span class="br0">&#40;</span><a href="http://research.microsoft.com/en-us/um/cambridge/projects/fsharp/manual/namespaces.html"><span class="kw2">Set</span></a>.<span class="me1">singleton</span> v<span class="br0">&#41;</span> indexMap<br />        | Some set <span class="sy0">-&gt;</span> <a href="http://research.microsoft.com/en-us/um/cambridge/projects/fsharp/manual/namespaces.html"><span class="kw2">Map</span></a>.<span class="me1">add</span> k <span class="br0">&#40;</span><a href="http://research.microsoft.com/en-us/um/cambridge/projects/fsharp/manual/namespaces.html"><span class="kw2">Set</span></a>.<span class="me1">add</span> v set<span class="br0">&#41;</span> indexMap<br />&#160;<br /><span class="kw1">let</span> buildIndex files <span class="sy0">=</span><br />    <span class="kw1">let</span> fileData file <span class="sy0">=</span><br />        File.<span class="me1">ReadAllText</span><span class="br0">&#40;</span>file<span class="br0">&#41;</span>.<span class="me1">Split</span><span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="sy0">|&gt;</span> <a href="http://research.microsoft.com/en-us/um/cambridge/projects/fsharp/manual/namespaces.html"><span class="kw2">Seq</span></a>.<span class="me1">map</span> <span class="br0">&#40;</span><span class="kw1">fun</span> word <span class="sy0">-&gt;</span> word.<span class="me1">ToLower</span><span class="br0">&#40;</span><span class="br0">&#41;</span>, file<span class="br0">&#41;</span><br />&#160;<br />    files <span class="sy0">|&gt;</span> <a href="http://research.microsoft.com/en-us/um/cambridge/projects/fsharp/manual/namespaces.html"><span class="kw2">Seq</span></a>.<span class="me1">collect</span> fileData<br />          <span class="sy0">|&gt;</span> <a href="http://research.microsoft.com/en-us/um/cambridge/projects/fsharp/manual/namespaces.html"><span class="kw2">Seq</span></a>.<span class="me1">fold</span> updateIndex <a href="http://research.microsoft.com/en-us/um/cambridge/projects/fsharp/manual/namespaces.html"><span class="kw2">Map</span></a>.<span class="me1">empty</span><br />&#160;<br /><span class="kw1">let</span> searchFiles<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="sy0">=</span><br />    <span class="kw1">let</span> files, terms <span class="sy0">=</span> inputSearchCriteria<span class="br0">&#40;</span><span class="br0">&#41;</span><br />    <span class="kw1">let</span> indexes <span class="sy0">=</span> buildIndex files<br />&#160;<br />    <span class="kw1">let</span> searchResults <span class="sy0">=</span> terms <span class="sy0">|&gt;</span> <a href="http://research.microsoft.com/en-us/um/cambridge/projects/fsharp/manual/namespaces.html"><span class="kw2">Seq</span></a>.<span class="me1">map</span> <span class="br0">&#40;</span><span class="kw1">fun</span> term <span class="sy0">-&gt;</span> <a href="http://research.microsoft.com/en-us/um/cambridge/projects/fsharp/manual/namespaces.html"><span class="kw2">Map</span></a>.<span class="me1">find</span> term indexes<span class="br0">&#41;</span><br />                              <span class="sy0">|&gt;</span> <a href="http://research.microsoft.com/en-us/um/cambridge/projects/fsharp/manual/namespaces.html"><span class="kw2">Set</span></a>.<span class="me1">intersectMany</span><br />&#160;<br />    printf <span class="st0">&quot;Found in: &quot;</span> <span class="sy0">;</span> searchResults <span class="sy0">|&gt;</span> <a href="http://research.microsoft.com/en-us/um/cambridge/projects/fsharp/manual/namespaces.html"><span class="kw2">Set</span></a>.<span class="me1">iter</span> <span class="br0">&#40;</span>printf <span class="st0">&quot;%s &quot;</span><span class="br0">&#41;</span> <span class="sy0">;</span> printfn <span class="st0">&quot;&quot;</span></pre>
<p>Sample usage:
</p>
<pre>searchFiles()

Files: file1.txt file2.txt file3.txt
Find: what is
Found in: file1.txt file2.txt</pre>
<h2><span class="mw-headline" id="Go"><a href="/wiki/Category:Go" title="Category:Go">Go</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/mw/index.php?title=Inverted_index&amp;action=edit&amp;section=21" title="Edit section: Go">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<pre class="go highlighted_source"><span class="kw1">package</span> main<br />&#160;<br /><span class="kw1">import</span> <span class="sy1">(</span><br />    <span class="st0">&quot;bufio&quot;</span><br />    <span class="st0">&quot;bytes&quot;</span><br />    <span class="st0">&quot;errors&quot;</span><br />    <span class="st0">&quot;fmt&quot;</span><br />    <span class="st0">&quot;io&quot;</span><br />    <span class="st0">&quot;os&quot;</span><br /><span class="sy1">)</span><br />&#160;<br /><span class="co1">// inverted index representation</span><br /><span class="kw1">var</span> index <span class="kw4">map</span><span class="sy1">[</span><span class="kw4">string</span><span class="sy1">][]</span><span class="kw4">int</span> <span class="co1">// ints index into indexed</span><br /><span class="kw1">var</span> indexed <span class="sy1">[]</span>doc<br />&#160;<br /><span class="kw1">type</span> doc <span class="kw4">struct</span> <span class="sy1">{</span><br />    file  <span class="kw4">string</span><br />    title <span class="kw4">string</span><br /><span class="sy1">}</span><br />&#160;<br /><span class="kw4">func</span> main<span class="sy1">()</span> <span class="sy1">{</span><br />    <span class="co1">// initialize representation</span><br />    index <span class="sy2">=</span> <span class="kw3">make</span><span class="sy1">(</span><span class="kw4">map</span><span class="sy1">[</span><span class="kw4">string</span><span class="sy1">][]</span><span class="kw4">int</span><span class="sy1">)</span><br />&#160;<br />    <span class="co1">// build index</span><br />    <span class="kw1">if</span> err <span class="sy2">:=</span> indexDir<span class="sy1">(</span><span class="st0">&quot;docs&quot;</span><span class="sy1">);</span> err <span class="sy2">!=</span> <span class="kw2">nil</span> <span class="sy1">{</span><br />        fmt<span class="sy3">.</span>Println<span class="sy1">(</span>err<span class="sy1">)</span><br />        <span class="kw1">return</span><br />    <span class="sy1">}</span><br />&#160;<br />    <span class="co1">// run user interface</span><br />    ui<span class="sy1">()</span><br /><span class="sy1">}</span><br />&#160;<br /><span class="kw4">func</span> indexDir<span class="sy1">(</span>dir <span class="kw4">string</span><span class="sy1">)</span> error <span class="sy1">{</span><br />    df<span class="sy1">,</span> err <span class="sy2">:=</span> os<span class="sy3">.</span>Open<span class="sy1">(</span>dir<span class="sy1">)</span><br />    <span class="kw1">if</span> err <span class="sy2">!=</span> <span class="kw2">nil</span> <span class="sy1">{</span><br />        <span class="kw1">return</span> err<br />    <span class="sy1">}</span><br />    fis<span class="sy1">,</span> err <span class="sy2">:=</span> df<span class="sy3">.</span>Readdir<span class="sy1">(</span><span class="sy3">-</span><span class="nu0">1</span><span class="sy1">)</span><br />    <span class="kw1">if</span> err <span class="sy2">!=</span> <span class="kw2">nil</span> <span class="sy1">{</span><br />        <span class="kw1">return</span> err<br />    <span class="sy1">}</span><br />    <span class="kw1">if</span> <span class="kw3">len</span><span class="sy1">(</span>fis<span class="sy1">)</span> <span class="sy3">==</span> <span class="nu0">0</span> <span class="sy1">{</span><br />        <span class="kw1">return</span> errors<span class="sy3">.</span>New<span class="sy1">(</span>fmt<span class="sy3">.</span>Sprintf<span class="sy1">(</span><span class="st0">&quot;no files in&#160;%s&quot;</span><span class="sy1">,</span> dir<span class="sy1">))</span><br />    <span class="sy1">}</span><br />    indexed <span class="sy2">:=</span> <span class="nu0">0</span><br />    <span class="kw1">for</span> _<span class="sy1">,</span> fi <span class="sy2">:=</span> <span class="kw1">range</span> fis <span class="sy1">{</span><br />        <span class="kw1">if</span> <span class="sy3">!</span>fi<span class="sy3">.</span>IsDir<span class="sy1">()</span> <span class="sy1">{</span><br />            <span class="kw1">if</span> indexFile<span class="sy1">(</span>dir <span class="sy3">+</span> <span class="st0">&quot;/&quot;</span> <span class="sy3">+</span> fi<span class="sy3">.</span>Name<span class="sy1">())</span> <span class="sy1">{</span><br />                indexed<span class="sy2">++</span><br />            <span class="sy1">}</span><br />        <span class="sy1">}</span><br />    <span class="sy1">}</span><br />    <span class="kw1">return</span> <span class="kw2">nil</span><br /><span class="sy1">}</span><br />&#160;<br /><span class="kw4">func</span> indexFile<span class="sy1">(</span>fn <span class="kw4">string</span><span class="sy1">)</span> <span class="kw4">bool</span> <span class="sy1">{</span><br />    f<span class="sy1">,</span> err <span class="sy2">:=</span> os<span class="sy3">.</span>Open<span class="sy1">(</span>fn<span class="sy1">)</span><br />    <span class="kw1">if</span> err <span class="sy2">!=</span> <span class="kw2">nil</span> <span class="sy1">{</span><br />        fmt<span class="sy3">.</span>Println<span class="sy1">(</span>err<span class="sy1">)</span><br />        <span class="kw1">return</span> <span class="kw2">false</span> <span class="co1">// only false return</span><br />    <span class="sy1">}</span><br />&#160;<br />    <span class="co1">// register new file</span><br />    x <span class="sy2">:=</span> <span class="kw3">len</span><span class="sy1">(</span>indexed<span class="sy1">)</span><br />    indexed <span class="sy2">=</span> append<span class="sy1">(</span>indexed<span class="sy1">,</span> doc<span class="sy1">{</span>fn<span class="sy1">,</span> fn<span class="sy1">})</span><br />    pdoc <span class="sy2">:=</span> &amp;indexed<span class="sy1">[</span>x<span class="sy1">]</span><br />&#160;<br />    <span class="co1">// scan lines</span><br />    r <span class="sy2">:=</span> bufio<span class="sy3">.</span>NewReader<span class="sy1">(</span>f<span class="sy1">)</span><br />    lines <span class="sy2">:=</span> <span class="nu0">0</span><br />    <span class="kw1">for</span> <span class="sy1">{</span><br />        b<span class="sy1">,</span> isPrefix<span class="sy1">,</span> err <span class="sy2">:=</span> r<span class="sy3">.</span>ReadLine<span class="sy1">()</span><br />        <span class="kw1">switch</span> <span class="sy1">{</span><br />        <span class="kw1">case</span> err <span class="sy3">==</span> io<span class="sy3">.</span>EOF<span class="sy1">:</span><br />            <span class="kw1">return</span> <span class="kw2">true</span><br />        <span class="kw1">case</span> err <span class="sy2">!=</span> <span class="kw2">nil</span><span class="sy1">:</span><br />            fmt<span class="sy3">.</span>Println<span class="sy1">(</span>err<span class="sy1">)</span><br />            <span class="kw1">return</span> <span class="kw2">true</span><br />        <span class="kw1">case</span> isPrefix<span class="sy1">:</span><br />            fmt<span class="sy3">.</span>Printf<span class="sy1">(</span><span class="st0">&quot;%s: unexpected long line<span class="es1">\n</span>&quot;</span><span class="sy1">,</span> fn<span class="sy1">)</span><br />            <span class="kw1">return</span> <span class="kw2">true</span><br />        <span class="kw1">case</span> lines &lt; <span class="nu0">20</span> &amp;&amp; bytes<span class="sy3">.</span>HasPrefix<span class="sy1">(</span>b<span class="sy1">,</span> <span class="sy1">[]</span><span class="kw4">byte</span><span class="sy1">(</span><span class="st0">&quot;Title:&quot;</span><span class="sy1">)):</span><br />            <span class="co1">// in a real program you would write code</span><br />            <span class="co1">// to skip the Gutenberg document header</span><br />            <span class="co1">// and not index it.</span><br />            pdoc<span class="sy3">.</span>title <span class="sy2">=</span> <span class="kw4">string</span><span class="sy1">(</span>b<span class="sy1">[</span><span class="nu0">7</span><span class="sy1">:])</span><br />        <span class="sy1">}</span><br />        <span class="co1">// index line of text in b</span><br />        <span class="co1">// again, in a real program you would write a much</span><br />        <span class="co1">// nicer word splitter.</span><br />    wordLoop<span class="sy1">:</span><br />        <span class="kw1">for</span> _<span class="sy1">,</span> bword <span class="sy2">:=</span> <span class="kw1">range</span> bytes<span class="sy3">.</span>Fields<span class="sy1">(</span>b<span class="sy1">)</span> <span class="sy1">{</span><br />            bword <span class="sy2">:=</span> bytes<span class="sy3">.</span>Trim<span class="sy1">(</span>bword<span class="sy1">,</span> <span class="st0">&quot;.,-~?!<span class="es1">\&quot;</span>'`;:()&lt;&gt;[]{}<span class="es1">\\</span>|/=_+*&amp;^%$#@&quot;</span><span class="sy1">)</span><br />            <span class="kw1">if</span> <span class="kw3">len</span><span class="sy1">(</span>bword<span class="sy1">)</span> &gt; <span class="nu0">0</span> <span class="sy1">{</span><br />                word <span class="sy2">:=</span> <span class="kw4">string</span><span class="sy1">(</span>bword<span class="sy1">)</span><br />                dl <span class="sy2">:=</span> index<span class="sy1">[</span>word<span class="sy1">]</span><br />                <span class="kw1">for</span> _<span class="sy1">,</span> d <span class="sy2">:=</span> <span class="kw1">range</span> dl <span class="sy1">{</span><br />                    <span class="kw1">if</span> d <span class="sy3">==</span> x <span class="sy1">{</span><br />                        <span class="kw1">continue</span> wordLoop<br />                    <span class="sy1">}</span><br />                <span class="sy1">}</span><br />                index<span class="sy1">[</span>word<span class="sy1">]</span> <span class="sy2">=</span> append<span class="sy1">(</span>dl<span class="sy1">,</span> x<span class="sy1">)</span><br />            <span class="sy1">}</span><br />        <span class="sy1">}</span><br />    <span class="sy1">}</span><br />    <span class="kw1">return</span> <span class="kw2">true</span><br /><span class="sy1">}</span>   <br />&#160;<br /><span class="kw4">func</span> ui<span class="sy1">()</span> <span class="sy1">{</span><br />    fmt<span class="sy3">.</span>Println<span class="sy1">(</span><span class="kw3">len</span><span class="sy1">(</span>index<span class="sy1">),</span> <span class="st0">&quot;words indexed in&quot;</span><span class="sy1">,</span> <span class="kw3">len</span><span class="sy1">(</span>indexed<span class="sy1">),</span> <span class="st0">&quot;files&quot;</span><span class="sy1">)</span><br />    fmt<span class="sy3">.</span><span class="me1">Println</span><span class="sy1">(</span><span class="st0">&quot;enter single words to search for&quot;</span><span class="sy1">)</span><br />    fmt<span class="sy3">.</span><span class="me1">Println</span><span class="sy1">(</span><span class="st0">&quot;enter a blank line when done&quot;</span><span class="sy1">)</span><br />    <span class="kw1">var</span> word <span class="kw4">string</span><br />    <span class="kw1">for</span> <span class="sy1">{</span><br />        fmt<span class="sy3">.</span>Print<span class="sy1">(</span><span class="st0">&quot;search word: &quot;</span><span class="sy1">)</span><br />        wc<span class="sy1">,</span> _ <span class="sy2">:=</span> fmt<span class="sy3">.</span>Scanln<span class="sy1">(</span>&amp;word<span class="sy1">)</span><br />        <span class="kw1">if</span> wc <span class="sy3">==</span> <span class="nu0">0</span> <span class="sy1">{</span><br />            <span class="kw1">return</span><br />        <span class="sy1">}</span><br />        <span class="kw1">switch</span> dl <span class="sy2">:=</span> index<span class="sy1">[</span>word<span class="sy1">];</span> <span class="kw3">len</span><span class="sy1">(</span>dl<span class="sy1">)</span> <span class="sy1">{</span><br />        <span class="kw1">case</span> <span class="nu0">0</span><span class="sy1">:</span><br />            fmt<span class="sy3">.</span>Println<span class="sy1">(</span><span class="st0">&quot;no match&quot;</span><span class="sy1">)</span><br />        <span class="kw1">case</span> <span class="nu0">1</span><span class="sy1">:</span><br />            fmt<span class="sy3">.</span>Println<span class="sy1">(</span><span class="st0">&quot;one match:&quot;</span><span class="sy1">)</span><br />            fmt<span class="sy3">.</span><span class="me1">Println</span><span class="sy1">(</span><span class="st0">&quot;   &quot;</span><span class="sy1">,</span> indexed<span class="sy1">[</span>dl<span class="sy1">[</span><span class="nu0">0</span><span class="sy1">]]</span><span class="sy3">.</span>file<span class="sy1">,</span> indexed<span class="sy1">[</span>dl<span class="sy1">[</span><span class="nu0">0</span><span class="sy1">]]</span><span class="sy3">.</span>title<span class="sy1">)</span><br />        <span class="kw1">default</span><span class="sy1">:</span> <br />            fmt<span class="sy3">.</span>Println<span class="sy1">(</span><span class="kw3">len</span><span class="sy1">(</span>dl<span class="sy1">),</span> <span class="st0">&quot;matches:&quot;</span><span class="sy1">)</span><br />            <span class="kw1">for</span> _<span class="sy1">,</span> d <span class="sy2">:=</span> <span class="kw1">range</span> dl <span class="sy1">{</span><br />                fmt<span class="sy3">.</span>Println<span class="sy1">(</span><span class="st0">&quot;   &quot;</span><span class="sy1">,</span> indexed<span class="sy1">[</span>d<span class="sy1">]</span><span class="sy3">.</span><span class="me1">file</span><span class="sy1">,</span> indexed<span class="sy1">[</span>d<span class="sy1">]</span><span class="sy3">.</span><span class="me1">title</span><span class="sy1">)</span><br />            <span class="sy1">}</span><br />        <span class="sy1">}</span><br />    <span class="sy1">}</span><br /><span class="sy1">}</span></pre>
<p>Session:
</p>
<pre>8448 words indexed in 11 files
enter single words to search for
enter a blank line when done
search word: dog
no match
search word: cat
one match:
    docs/pg28554.txt Beyond Lies the Wub
search word: robot
6 matches:
    docs/pg32032.txt Second Variety
    docs/pg32522.txt Mr. Spaceship
    docs/pg32832.txt Piper in the Woods
    docs/pg28698.txt The Crystal Crypt
    docs/pg28767.txt The Defenders
    docs/pg32154.txt The Variable Man
</pre>
<h2><span class="mw-headline" id="Haskell"><a href="/wiki/Category:Haskell" title="Category:Haskell">Haskell</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/mw/index.php?title=Inverted_index&amp;action=edit&amp;section=22" title="Edit section: Haskell">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<pre class="haskell highlighted_source"><span class="kw1">import</span> Control<span class="sy0">.</span><a href="http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#t:Monad"><span class="kw4">Monad</span></a><br /><span class="kw1">import</span> Data<span class="sy0">.</span><a href="http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#t:Char"><span class="kw4">Char</span></a> <span class="br0">&#40;</span>isAlpha<span class="sy0">,</span> toLower<span class="br0">&#41;</span><br /><span class="kw1">import</span> <span class="kw1">qualified</span> Data<span class="sy0">.</span>Map <span class="kw1">as</span> M<br /><span class="kw1">import</span> <span class="kw1">qualified</span> Data<span class="sy0">.</span>IntSet <span class="kw1">as</span> S<br /><span class="kw1">import</span> System<span class="sy0">.</span>Environment <span class="br0">&#40;</span>getArgs<span class="br0">&#41;</span><br />&#160;<br />main <span class="sy0">=</span>  <span class="kw1">do</span><br />    <span class="br0">&#40;</span>files<span class="sy0">,</span> <span class="sy0">_</span>&#160;: q<span class="br0">&#41;</span> <span class="sy0">&lt;-</span> liftM <span class="br0">&#40;</span><a href="http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:break"><span class="kw3">break</span></a> <span class="br0">&#40;</span><span class="sy0">==</span> <span class="st0">&quot;--&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span> getArgs<br />    buildII files <span class="sy0">&gt;&gt;=</span> <a href="http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:mapM_"><span class="kw3">mapM_</span></a> <a href="http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:putStrLn"><span class="kw3">putStrLn</span></a> <span class="sy0">.</span> queryII q<br />&#160;<br /><span class="kw1">data</span> IIndex <span class="sy0">=</span> IIndex<br />    <span class="br0">&#91;</span>FilePath<span class="br0">&#93;</span>              <span class="co1">-- Files in the index</span><br />    <span class="br0">&#40;</span>M<span class="sy0">.</span>Map <a href="http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#t:String"><span class="kw4">String</span></a> S<span class="sy0">.</span>IntSet<span class="br0">&#41;</span> <span class="co1">-- Maps word to indices of the list</span><br />  <span class="kw1">deriving</span> <a href="http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#t:Show"><span class="kw4">Show</span></a><br />&#160;<br />buildII <span class="sy0">::</span> <span class="br0">&#91;</span>FilePath<span class="br0">&#93;</span> <span class="sy0">-&gt;</span> <a href="http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#t:IO"><span class="kw4">IO</span></a> IIndex<br />buildII files <span class="sy0">=</span><br />    liftM <span class="br0">&#40;</span>IIndex files <span class="sy0">.</span> <a href="http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:foldl"><span class="kw3">foldl</span></a> f M<span class="sy0">.</span>empty <span class="sy0">.</span> <a href="http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:zip"><span class="kw3">zip</span></a> <span class="br0">&#91;</span><span class="nu0">0</span><span class="sy0">..</span><span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="sy0">$</span><br />    <a href="http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:mapM"><span class="kw3">mapM</span></a> <a href="http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:readFile"><span class="kw3">readFile</span></a> files<br />  <span class="kw1">where</span> f m <span class="br0">&#40;</span>i<span class="sy0">,</span> s<span class="br0">&#41;</span> <span class="sy0">=</span><br />            <a href="http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:foldl"><span class="kw3">foldl</span></a> g m <span class="sy0">$</span> <a href="http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:map"><span class="kw3">map</span></a> <span class="br0">&#40;</span>lowercase <span class="sy0">.</span> <a href="http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:filter"><span class="kw3">filter</span></a> isAlpha<span class="br0">&#41;</span> <span class="sy0">$</span> <a href="http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:words"><span class="kw3">words</span></a> s<br />          <span class="kw1">where</span> g m word <span class="sy0">=</span> M<span class="sy0">.</span>insertWith S<span class="sy0">.</span>union word <span class="br0">&#40;</span>S<span class="sy0">.</span>singleton i<span class="br0">&#41;</span> m<br />&#160;<br />queryII <span class="sy0">::</span> <span class="br0">&#91;</span><a href="http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#t:String"><span class="kw4">String</span></a><span class="br0">&#93;</span> <span class="sy0">-&gt;</span> IIndex <span class="sy0">-&gt;</span> <span class="br0">&#91;</span>FilePath<span class="br0">&#93;</span><br />queryII q <span class="br0">&#40;</span>IIndex files m<span class="br0">&#41;</span> <span class="sy0">=</span><br />    <a href="http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:map"><span class="kw3">map</span></a> <span class="br0">&#40;</span>files <span class="sy0">!!</span><span class="br0">&#41;</span> <span class="sy0">$</span> S<span class="sy0">.</span>toList <span class="sy0">$</span> intersections <span class="sy0">$</span><br />    <a href="http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:map"><span class="kw3">map</span></a> <span class="br0">&#40;</span>\word <span class="sy0">-&gt;</span> M<span class="sy0">.</span>findWithDefault S<span class="sy0">.</span>empty <span class="br0">&#40;</span>lowercase word<span class="br0">&#41;</span> m<span class="br0">&#41;</span> q<br />&#160;<br />intersections <span class="br0">&#91;</span><span class="br0">&#93;</span> <span class="sy0">=</span> S<span class="sy0">.</span>empty<br />intersections xs <span class="sy0">=</span> <a href="http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:foldl1"><span class="kw3">foldl1</span></a> S<span class="sy0">.</span>intersection xs<br />&#160;<br />lowercase <span class="sy0">=</span> <a href="http://haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:map"><span class="kw3">map</span></a> toLower</pre>
<p>An example of use, assuming the program is named <code>iindex</code> and there exist files <code>t0</code>, <code>t1</code>, and <code>t2</code> with contents "It is what it is.", "What is it?", and "It is a banana.":
</p>
<pre>$ iindex t0 t1 t2 -- what is it
t0
t1</pre>
<h2><span class="mw-headline" id="Icon_and_Unicon"><a href="/wiki/Category:Icon" title="Category:Icon">Icon</a> and <a href="/wiki/Category:Unicon" title="Category:Unicon">Unicon</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/mw/index.php?title=Inverted_index&amp;action=edit&amp;section=23" title="Edit section: Icon and Unicon">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The following implements a simple case insensitive inverse index using lists simulating texts.
</p>
<pre class="icon highlighted_source"><span class="kw1">procedure</span> main<span class="br0">&#40;</span><span class="br0">&#41;</span><br />&#160;<br />  texts <span class="sy1">:=</span> <span class="kw4">table</span><span class="br0">&#40;</span><span class="br0">&#41;</span>     <span class="co1"># substitute for read and parse files</span><br />  texts<span class="br0">&#91;</span><span class="st0">&quot;T0.txt&quot;</span><span class="br0">&#93;</span> <span class="sy1">:=</span> <span class="br0">&#91;</span><span class="st0">&quot;it&quot;</span><span class="sy1">,</span> <span class="st0">&quot;is&quot;</span><span class="sy1">,</span> <span class="st0">&quot;what&quot;</span><span class="sy1">,</span> <span class="st0">&quot;it&quot;</span><span class="sy1">,</span> <span class="st0">&quot;is&quot;</span><span class="br0">&#93;</span><br />  texts<span class="br0">&#91;</span><span class="st0">&quot;T1.txt&quot;</span><span class="br0">&#93;</span> <span class="sy1">:=</span> <span class="br0">&#91;</span><span class="st0">&quot;what&quot;</span><span class="sy1">,</span> <span class="st0">&quot;is&quot;</span><span class="sy1">,</span> <span class="st0">&quot;it&quot;</span><span class="br0">&#93;</span><br />  texts<span class="br0">&#91;</span><span class="st0">&quot;T2.txt&quot;</span><span class="br0">&#93;</span> <span class="sy1">:=</span> <span class="br0">&#91;</span><span class="st0">&quot;it&quot;</span><span class="sy1">,</span> <span class="st0">&quot;is&quot;</span><span class="sy1">,</span> <span class="st0">&quot;a&quot;</span><span class="sy1">,</span> <span class="st0">&quot;banana&quot;</span><span class="br0">&#93;</span><br />&#160;<br />  <span class="kw1">every</span> textname <span class="sy1">:=</span> <span class="kw4">key</span><span class="br0">&#40;</span>texts<span class="br0">&#41;</span> <span class="kw1">do</span>  <span class="co1"># build index for each 'text'</span><br />     SII <span class="sy1">:=</span> InvertedIndex<span class="br0">&#40;</span>SII<span class="sy1">,</span>textname<span class="sy1">,</span>texts<span class="br0">&#91;</span>textname<span class="br0">&#93;</span><span class="br0">&#41;</span> <br />&#160;<br />  TermSearchUI<span class="br0">&#40;</span>SII<span class="br0">&#41;</span>  <span class="co1"># search UI</span><br />&#160;<br /><span class="kw1">end</span><br />&#160;<br /><span class="kw1">procedure</span> InvertedIndex<span class="br0">&#40;</span>ii<span class="sy1">,</span>k<span class="sy1">,</span>words<span class="br0">&#41;</span>  <span class="co1">#: accumulate a simple inverted index</span><br />&#160;<br /><span class="sy1">/</span>ii <span class="sy1">:=</span> <span class="kw4">table</span><span class="br0">&#40;</span><span class="kw4">set</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>    <span class="co1"># create lookup table and null set</span><br /><span class="kw1">every</span> w <span class="sy1">:=</span> <span class="sy1">!</span>words <span class="kw1">do</span> <span class="br0">&#123;</span><br />   <span class="kw1">if</span> <span class="sy1">*</span>ii<span class="br0">&#91;</span>w<span class="br0">&#93;</span> <span class="sy1">=</span> <span class="nu0">0</span> <span class="kw1">then</span> ii<span class="br0">&#91;</span>w<span class="br0">&#93;</span> <span class="sy1">:=</span> <span class="kw4">set</span><span class="br0">&#40;</span><span class="br0">&#41;</span>  <span class="co1"># new word, new set</span><br />   <span class="kw4">insert</span><span class="br0">&#40;</span>ii<span class="br0">&#91;</span>w<span class="br0">&#93;</span><span class="sy1">,</span>k<span class="br0">&#41;</span><br />   <span class="br0">&#125;</span><br />&#160;<br /><span class="kw1">return</span> ii<br /><span class="kw1">end</span><br />&#160;<br /><span class="kw1">procedure</span> TermSearchUI<span class="br0">&#40;</span>ii<span class="br0">&#41;</span>    <span class="co1">#: search UI, all words must match</span><br />&#160;<br /><span class="kw1">repeat</span> <span class="br0">&#123;</span><br />   <span class="kw4">writes</span><span class="br0">&#40;</span><span class="st0">&quot;Enter search terms (^z to quit)&#160;: &quot;</span><span class="br0">&#41;</span><br />   terms <span class="sy1">:=</span> <span class="kw4">map</span><span class="br0">&#40;</span><span class="kw4">trim</span><span class="br0">&#40;</span><span class="kw4">read</span><span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="sy1">|</span> <span class="kw1">break</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <br />&#160;<br />   x <span class="sy1">:=</span> <span class="br0">&#91;</span><span class="br0">&#93;</span>   <br />   terms <span class="sy1">?</span> <span class="kw1">while</span> <span class="kw1">not</span> <span class="kw4">pos</span><span class="br0">&#40;</span><span class="nu0">0</span><span class="br0">&#41;</span> <span class="kw1">do</span> <span class="br0">&#123;</span><br />      <span class="kw4">tab</span><span class="br0">&#40;</span><span class="kw4">many</span><span class="br0">&#40;</span><span class="st0">' <span class="es0">\t</span>'</span><span class="br0">&#41;</span><span class="br0">&#41;</span><br />      <span class="kw4">put</span><span class="br0">&#40;</span>x<span class="sy1">,</span><span class="kw4">tab</span><span class="br0">&#40;</span><span class="kw4">upto</span><span class="br0">&#40;</span><span class="st0">'<span class="es0">\ </span><span class="es0">\t</span>'</span><span class="br0">&#41;</span><span class="sy1">|</span><span class="nu0">0</span><span class="br0">&#41;</span><span class="br0">&#41;</span><br />      <span class="br0">&#125;</span><br />&#160;<br />   show<span class="br0">&#40;</span><span class="st0">&quot;Searching for&#160;: &quot;</span><span class="sy1">,</span>x<span class="br0">&#41;</span> <br />   show<span class="br0">&#40;</span><span class="st0">&quot;Found in&#160;: &quot;</span><span class="sy1">,</span>s <span class="sy1">:=</span> TermSearch<span class="br0">&#40;</span>ii<span class="sy1">,</span>x<span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="sy1">|</span> show<span class="br0">&#40;</span><span class="st0">&quot;Not found&#160;: &quot;</span><span class="sy1">,</span>x<span class="br0">&#41;</span>     <br />   <span class="br0">&#125;</span><br /><span class="kw4">write</span><span class="br0">&#40;</span><span class="st0">&quot;End of search&quot;</span><span class="br0">&#41;</span><br /><span class="kw1">return</span><br /><span class="kw1">end</span><br />&#160;<br /><span class="kw1">procedure</span> TermSearch<span class="br0">&#40;</span>ii<span class="sy1">,</span>x<span class="br0">&#41;</span>  <span class="co1">#: return set of matches or fail</span><br /><span class="kw1">every</span> s <span class="sy1">:=</span> <span class="sy1">!</span>x <span class="kw1">do</span> <br />   <span class="br0">&#40;</span> <span class="sy1">/</span>u <span class="sy1">:=</span> ii<span class="br0">&#91;</span>s<span class="br0">&#93;</span> <span class="br0">&#41;</span> <span class="sy1">|</span> <span class="br0">&#40;</span>u <span class="sy1">**:=</span> ii<span class="br0">&#91;</span>s<span class="br0">&#93;</span><span class="br0">&#41;</span><br /><span class="kw1">if</span> <span class="sy1">*</span>u <span class="sy1">&gt;</span> <span class="nu0">0</span> <span class="kw1">then</span> <span class="kw1">return</span> u<br /><span class="kw1">end</span><br />&#160;<br /><span class="kw1">procedure</span> show<span class="br0">&#40;</span>s<span class="sy1">,</span>x<span class="br0">&#41;</span> <span class="co1"># display helper</span><br /><span class="kw1">every</span> <span class="kw4">writes</span><span class="br0">&#40;</span>s<span class="sy1">|!</span>x<span class="br0">&#41;</span> <span class="kw1">do</span> <span class="kw4">writes</span><span class="br0">&#40;</span><span class="st0">&quot; &quot;</span><span class="br0">&#41;</span><br /><span class="kw4">write</span><span class="br0">&#40;</span><span class="br0">&#41;</span><br /><span class="kw1">return</span> <br /><span class="kw1">end</span></pre>
Output:<pre>Enter search terms (^z to quit)&#160;: is it
Searching for&#160;:  is it
Found in&#160;:  T0.txt T2.txt T1.txt
Enter search terms (^z to quit)&#160;: banana
Searching for&#160;:  banana
Found in&#160;:  T2.txt
Enter search terms (^z to quit)&#160;: fox
Searching for&#160;:  fox
Not found&#160;:  fox
Enter search terms (^z to quit)&#160;: what
Searching for&#160;:  what
Found in&#160;:  T0.txt T1.txt</pre>
<p>The following code will build a full index. Modification of search routines is left as an exercise:
</p>
<pre class="unicon highlighted_source"><span class="kw1">record</span> InvertedIndexRec<span class="br0">&#40;</span>simple<span class="sy0">,</span>full<span class="br0">&#41;</span><br />&#160;<br /><span class="kw1">procedure</span> FullInvertedIndex<span class="br0">&#40;</span>ii<span class="sy0">,</span>k<span class="sy0">,</span>words<span class="br0">&#41;</span>  <span class="co1">#: accumulate a full inverted index</span><br />&#160;<br /><span class="sy0">/</span>ii <span class="sy0">:=</span> InvertedIndexRec<span class="br0">&#40;</span> <span class="kw4">table</span><span class="br0">&#40;</span><span class="kw4">set</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">,</span> <span class="kw4">table</span><span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#41;</span> <span class="co1"># create lookup table and null set</span><br />&#160;<br />wc <span class="sy0">:=</span> <span class="nu0">0</span><br /><span class="kw1">every</span> <span class="br0">&#40;</span>w <span class="sy0">:=</span> <span class="sy0">!</span>words<span class="sy0">,</span> wc <span class="sy0">+:=</span> <span class="nu0">1</span><span class="br0">&#41;</span> <span class="kw1">do</span> <span class="br0">&#123;</span><br />   <span class="kw1">if</span> <span class="sy0">*</span>ii<span class="sy0">.</span><span class="me1">simple</span><span class="br0">&#91;</span>w<span class="br0">&#93;</span> <span class="sy0">=</span> <span class="nu0">0</span> <span class="kw1">then</span> <span class="br0">&#123;</span><br />       ii<span class="sy0">.</span><span class="me1">simple</span><span class="br0">&#91;</span>w<span class="br0">&#93;</span> <span class="sy0">:=</span> <span class="kw4">set</span><span class="br0">&#40;</span><span class="br0">&#41;</span>  <span class="co1"># new word, new set</span><br />       ii<span class="sy0">.</span><span class="me1">full</span><span class="br0">&#91;</span>w<span class="br0">&#93;</span> <span class="sy0">:=</span> <span class="kw4">table</span><span class="br0">&#40;</span><span class="br0">&#41;</span>  <span class="co1"># also new table</span><br />       <span class="br0">&#125;</span><br />   <span class="kw4">insert</span><span class="br0">&#40;</span>ii<span class="sy0">.</span><span class="me1">simple</span><span class="br0">&#91;</span>w<span class="br0">&#93;</span><span class="sy0">,</span>k<span class="br0">&#41;</span><br />   <span class="sy0">/</span>ii<span class="sy0">.</span><span class="me1">full</span><span class="br0">&#91;</span>w<span class="sy0">,</span>k<span class="br0">&#93;</span> <span class="sy0">:=</span> <span class="kw4">set</span><span class="br0">&#40;</span><span class="br0">&#41;</span><br />   <span class="kw4">insert</span><span class="br0">&#40;</span>ii<span class="sy0">.</span><span class="me1">full</span><span class="br0">&#91;</span>w<span class="sy0">,</span>k<span class="br0">&#93;</span><span class="sy0">,</span>wc<span class="br0">&#41;</span><br />   <span class="br0">&#125;</span><br />&#160;<br /><span class="kw1">return</span> ii<br /><span class="kw1">end</span></pre>
<h2><span class="mw-headline" id="J"><a href="/wiki/Category:J" title="Category:J">J</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/mw/index.php?title=Inverted_index&amp;action=edit&amp;section=24" title="Edit section: J">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>This just implements the required spec, with a simplistic definition for what a word is, and with no support for stop words, nor for phrase searching.
</p>
<pre class="j highlighted_source">require<span class="st_h">'files regex strings'</span><br />&#160;<br />rxutf8 <span class="nu0">0</span>  <span class="co1">NB. support latin1 searches for this example, instead of utf8</span><br />files=:words=:buckets=:<span class="st_h">''</span><br />wordre=: rxcomp <span class="st_h">'[\w'</span><span class="st_h">']+'</span><br />parse=: ,@:rxfrom~ wordre&amp;rxmatches<br />&#160;<br />invert=: verb define<br />  files=: files,todo=. ~.<span class="kw2">y</span>-.files<br />  &gt;invert1 each todo<br /><span class="sy0">)</span><br />&#160;<br />invert1=: verb define<br />  file=. files i.&lt;<span class="kw2">y</span><br />  words=: ~.words,contents=. ~.parse tolower fread jpath <span class="kw2">y</span><br />  ind=. words i. contents<br />  buckets=: buckets,<span class="sy0">(</span><span class="nu0">1</span>+words -&amp;# buckets<span class="sy0">)</span>#a:<br />  #buckets=: <span class="sy0">(</span>file,~each ind{buckets<span class="sy0">)</span> ind}buckets<br /><span class="sy0">)</span><br />&#160;<br />search=: verb define<br />  hits=. buckets{~words i.~.parse tolower <span class="kw2">y</span><br />  files {~ &gt;<span class="sy0">(</span>[-.-.<span class="sy0">)</span>each/hits<br /><span class="sy0">)</span></pre>
<p>Example use:
</p>
<pre class="j highlighted_source">   invert <span class="st_h">'~help/primer/cut.htm'</span>;<span class="st_h">'~help/primer/end.htm'</span>;<span class="st_h">'~help/primer/gui.htm'</span><br />   &gt;search <span class="st_h">'finally learning'</span><br />~help/primer/end.htm<br />~help/primer/gui.htm<br />   &gt;search <span class="st_h">'argument'</span><br />~help/primer/cut.htm<br />~help/primer/gui.htm<br />   &gt;search <span class="st_h">'around'</span><br />~help/primer/gui.htm</pre>
<h2><span class="mw-headline" id="Java"><a href="/wiki/Category:Java" title="Category:Java">Java</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/mw/index.php?title=Inverted_index&amp;action=edit&amp;section=25" title="Edit section: Java">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<pre class="java highlighted_source">&#160;<br /><span class="kw1">package</span> <span class="co2">org.rosettacode</span><span class="sy0">;</span><br />&#160;<br /><span class="kw1">import</span> <span class="co2">java.io.BufferedReader</span><span class="sy0">;</span><br /><span class="kw1">import</span> <span class="co2">java.io.File</span><span class="sy0">;</span><br /><span class="kw1">import</span> <span class="co2">java.io.FileReader</span><span class="sy0">;</span><br /><span class="kw1">import</span> <span class="co2">java.io.IOException</span><span class="sy0">;</span><br /><span class="kw1">import</span> <span class="co2">java.util.ArrayList</span><span class="sy0">;</span><br /><span class="kw1">import</span> <span class="co2">java.util.Arrays</span><span class="sy0">;</span><br /><span class="kw1">import</span> <span class="co2">java.util.HashMap</span><span class="sy0">;</span><br /><span class="kw1">import</span> <span class="co2">java.util.HashSet</span><span class="sy0">;</span><br /><span class="kw1">import</span> <span class="co2">java.util.LinkedList</span><span class="sy0">;</span><br /><span class="kw1">import</span> <span class="co2">java.util.List</span><span class="sy0">;</span><br /><span class="kw1">import</span> <span class="co2">java.util.Map</span><span class="sy0">;</span><br /><span class="kw1">import</span> <span class="co2">java.util.Set</span><span class="sy0">;</span><br />&#160;<br /><span class="kw1">public</span> <span class="kw1">class</span> InvertedIndex <span class="br0">&#123;</span><br />&#160;<br />	List<span class="sy0">&lt;</span>String<span class="sy0">&gt;</span> stopwords <span class="sy0">=</span> <a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Aarrays+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky"><span class="kw3">Arrays</span></a>.<span class="me1">asList</span><span class="br0">&#40;</span><span class="st0">&quot;a&quot;</span>, <span class="st0">&quot;able&quot;</span>, <span class="st0">&quot;about&quot;</span>,<br />			<span class="st0">&quot;across&quot;</span>, <span class="st0">&quot;after&quot;</span>, <span class="st0">&quot;all&quot;</span>, <span class="st0">&quot;almost&quot;</span>, <span class="st0">&quot;also&quot;</span>, <span class="st0">&quot;am&quot;</span>, <span class="st0">&quot;among&quot;</span>, <span class="st0">&quot;an&quot;</span>,<br />			<span class="st0">&quot;and&quot;</span>, <span class="st0">&quot;any&quot;</span>, <span class="st0">&quot;are&quot;</span>, <span class="st0">&quot;as&quot;</span>, <span class="st0">&quot;at&quot;</span>, <span class="st0">&quot;be&quot;</span>, <span class="st0">&quot;because&quot;</span>, <span class="st0">&quot;been&quot;</span>, <span class="st0">&quot;but&quot;</span>,<br />			<span class="st0">&quot;by&quot;</span>, <span class="st0">&quot;can&quot;</span>, <span class="st0">&quot;cannot&quot;</span>, <span class="st0">&quot;could&quot;</span>, <span class="st0">&quot;dear&quot;</span>, <span class="st0">&quot;did&quot;</span>, <span class="st0">&quot;do&quot;</span>, <span class="st0">&quot;does&quot;</span>,<br />			<span class="st0">&quot;either&quot;</span>, <span class="st0">&quot;else&quot;</span>, <span class="st0">&quot;ever&quot;</span>, <span class="st0">&quot;every&quot;</span>, <span class="st0">&quot;for&quot;</span>, <span class="st0">&quot;from&quot;</span>, <span class="st0">&quot;get&quot;</span>, <span class="st0">&quot;got&quot;</span>,<br />			<span class="st0">&quot;had&quot;</span>, <span class="st0">&quot;has&quot;</span>, <span class="st0">&quot;have&quot;</span>, <span class="st0">&quot;he&quot;</span>, <span class="st0">&quot;her&quot;</span>, <span class="st0">&quot;hers&quot;</span>, <span class="st0">&quot;him&quot;</span>, <span class="st0">&quot;his&quot;</span>, <span class="st0">&quot;how&quot;</span>,<br />			<span class="st0">&quot;however&quot;</span>, <span class="st0">&quot;i&quot;</span>, <span class="st0">&quot;if&quot;</span>, <span class="st0">&quot;in&quot;</span>, <span class="st0">&quot;into&quot;</span>, <span class="st0">&quot;is&quot;</span>, <span class="st0">&quot;it&quot;</span>, <span class="st0">&quot;its&quot;</span>, <span class="st0">&quot;just&quot;</span>,<br />			<span class="st0">&quot;least&quot;</span>, <span class="st0">&quot;let&quot;</span>, <span class="st0">&quot;like&quot;</span>, <span class="st0">&quot;likely&quot;</span>, <span class="st0">&quot;may&quot;</span>, <span class="st0">&quot;me&quot;</span>, <span class="st0">&quot;might&quot;</span>, <span class="st0">&quot;most&quot;</span>,<br />			<span class="st0">&quot;must&quot;</span>, <span class="st0">&quot;my&quot;</span>, <span class="st0">&quot;neither&quot;</span>, <span class="st0">&quot;no&quot;</span>, <span class="st0">&quot;nor&quot;</span>, <span class="st0">&quot;not&quot;</span>, <span class="st0">&quot;of&quot;</span>, <span class="st0">&quot;off&quot;</span>, <span class="st0">&quot;often&quot;</span>,<br />			<span class="st0">&quot;on&quot;</span>, <span class="st0">&quot;only&quot;</span>, <span class="st0">&quot;or&quot;</span>, <span class="st0">&quot;other&quot;</span>, <span class="st0">&quot;our&quot;</span>, <span class="st0">&quot;own&quot;</span>, <span class="st0">&quot;rather&quot;</span>, <span class="st0">&quot;said&quot;</span>, <span class="st0">&quot;say&quot;</span>,<br />			<span class="st0">&quot;says&quot;</span>, <span class="st0">&quot;she&quot;</span>, <span class="st0">&quot;should&quot;</span>, <span class="st0">&quot;since&quot;</span>, <span class="st0">&quot;so&quot;</span>, <span class="st0">&quot;some&quot;</span>, <span class="st0">&quot;than&quot;</span>, <span class="st0">&quot;that&quot;</span>,<br />			<span class="st0">&quot;the&quot;</span>, <span class="st0">&quot;their&quot;</span>, <span class="st0">&quot;them&quot;</span>, <span class="st0">&quot;then&quot;</span>, <span class="st0">&quot;there&quot;</span>, <span class="st0">&quot;these&quot;</span>, <span class="st0">&quot;they&quot;</span>, <span class="st0">&quot;this&quot;</span>,<br />			<span class="st0">&quot;tis&quot;</span>, <span class="st0">&quot;to&quot;</span>, <span class="st0">&quot;too&quot;</span>, <span class="st0">&quot;twas&quot;</span>, <span class="st0">&quot;us&quot;</span>, <span class="st0">&quot;wants&quot;</span>, <span class="st0">&quot;was&quot;</span>, <span class="st0">&quot;we&quot;</span>, <span class="st0">&quot;were&quot;</span>,<br />			<span class="st0">&quot;what&quot;</span>, <span class="st0">&quot;when&quot;</span>, <span class="st0">&quot;where&quot;</span>, <span class="st0">&quot;which&quot;</span>, <span class="st0">&quot;while&quot;</span>, <span class="st0">&quot;who&quot;</span>, <span class="st0">&quot;whom&quot;</span>, <span class="st0">&quot;why&quot;</span>,<br />			<span class="st0">&quot;will&quot;</span>, <span class="st0">&quot;with&quot;</span>, <span class="st0">&quot;would&quot;</span>, <span class="st0">&quot;yet&quot;</span>, <span class="st0">&quot;you&quot;</span>, <span class="st0">&quot;your&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span><br />&#160;<br />	Map<span class="sy0">&lt;</span><a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Astring+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky"><span class="kw3">String</span></a>, List<span class="sy0">&lt;</span>Tuple<span class="sy0">&gt;&gt;</span> index <span class="sy0">=</span> <span class="kw1">new</span> HashMap<span class="sy0">&lt;</span><a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Astring+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky"><span class="kw3">String</span></a>, List<span class="sy0">&lt;</span>Tuple<span class="sy0">&gt;&gt;</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span><br />	List<span class="sy0">&lt;</span>String<span class="sy0">&gt;</span> files <span class="sy0">=</span> <span class="kw1">new</span> ArrayList<span class="sy0">&lt;</span>String<span class="sy0">&gt;</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span><br />&#160;<br />	<span class="kw1">public</span> <span class="kw4">void</span> indexFile<span class="br0">&#40;</span><a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Afile+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky"><span class="kw3">File</span></a> file<span class="br0">&#41;</span> <span class="kw1">throws</span> <a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Aioexception+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky"><span class="kw3">IOException</span></a> <span class="br0">&#123;</span><br />		<span class="kw4">int</span> fileno <span class="sy0">=</span> files.<span class="me1">indexOf</span><span class="br0">&#40;</span>file.<span class="me1">getPath</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span><br />		<span class="kw1">if</span> <span class="br0">&#40;</span>fileno <span class="sy0">==</span> <span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><br />			files.<span class="me1">add</span><span class="br0">&#40;</span>file.<span class="me1">getPath</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span><br />			fileno <span class="sy0">=</span> files.<span class="me1">size</span><span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="sy0">-</span> <span class="nu0">1</span><span class="sy0">;</span><br />		<span class="br0">&#125;</span><br />&#160;<br />		<span class="kw4">int</span> pos <span class="sy0">=</span> <span class="nu0">0</span><span class="sy0">;</span><br />		<a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Abufferedreader+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky"><span class="kw3">BufferedReader</span></a> reader <span class="sy0">=</span> <span class="kw1">new</span> <a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Abufferedreader+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky"><span class="kw3">BufferedReader</span></a><span class="br0">&#40;</span><span class="kw1">new</span> <a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Afilereader+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky"><span class="kw3">FileReader</span></a><span class="br0">&#40;</span>file<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span><br />		<span class="kw1">for</span> <span class="br0">&#40;</span><a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Astring+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky"><span class="kw3">String</span></a> line <span class="sy0">=</span> reader.<span class="me1">readLine</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span> line <span class="sy0">!=</span> <span class="kw2">null</span><span class="sy0">;</span> line <span class="sy0">=</span> reader<br />				.<span class="me1">readLine</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><br />			<span class="kw1">for</span> <span class="br0">&#40;</span><a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Astring+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky"><span class="kw3">String</span></a> _word <span class="sy0">:</span> line.<span class="me1">split</span><span class="br0">&#40;</span><span class="st0">&quot;<span class="es0">\\</span>W+&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><br />				<a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Astring+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky"><span class="kw3">String</span></a> word <span class="sy0">=</span> _word.<span class="me1">toLowerCase</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span><br />				pos<span class="sy0">++;</span><br />				<span class="kw1">if</span> <span class="br0">&#40;</span>stopwords.<span class="me1">contains</span><span class="br0">&#40;</span>word<span class="br0">&#41;</span><span class="br0">&#41;</span><br />					<span class="kw1">continue</span><span class="sy0">;</span><br />				List<span class="sy0">&lt;</span>Tuple<span class="sy0">&gt;</span> idx <span class="sy0">=</span> index.<span class="me1">get</span><span class="br0">&#40;</span>word<span class="br0">&#41;</span><span class="sy0">;</span><br />				<span class="kw1">if</span> <span class="br0">&#40;</span>idx <span class="sy0">==</span> <span class="kw2">null</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><br />					idx <span class="sy0">=</span> <span class="kw1">new</span> LinkedList<span class="sy0">&lt;</span>Tuple<span class="sy0">&gt;</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span><br />					index.<span class="me1">put</span><span class="br0">&#40;</span>word, idx<span class="br0">&#41;</span><span class="sy0">;</span><br />				<span class="br0">&#125;</span><br />				idx.<span class="me1">add</span><span class="br0">&#40;</span><span class="kw1">new</span> Tuple<span class="br0">&#40;</span>fileno, pos<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span><br />			<span class="br0">&#125;</span><br />		<span class="br0">&#125;</span><br />		<a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Asystem+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky"><span class="kw3">System</span></a>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">&#40;</span><span class="st0">&quot;indexed &quot;</span> <span class="sy0">+</span> file.<span class="me1">getPath</span><span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="sy0">+</span> <span class="st0">&quot; &quot;</span> <span class="sy0">+</span> pos <span class="sy0">+</span> <span class="st0">&quot; words&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span><br />	<span class="br0">&#125;</span><br />&#160;<br />	<span class="kw1">public</span> <span class="kw4">void</span> search<span class="br0">&#40;</span>List<span class="sy0">&lt;</span>String<span class="sy0">&gt;</span> words<span class="br0">&#41;</span> <span class="br0">&#123;</span><br />		<span class="kw1">for</span> <span class="br0">&#40;</span><a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Astring+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky"><span class="kw3">String</span></a> _word <span class="sy0">:</span> words<span class="br0">&#41;</span> <span class="br0">&#123;</span><br />			Set<span class="sy0">&lt;</span>String<span class="sy0">&gt;</span> answer <span class="sy0">=</span> <span class="kw1">new</span> HashSet<span class="sy0">&lt;</span>String<span class="sy0">&gt;</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span><br />			<a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Astring+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky"><span class="kw3">String</span></a> word <span class="sy0">=</span> _word.<span class="me1">toLowerCase</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span><br />			List<span class="sy0">&lt;</span>Tuple<span class="sy0">&gt;</span> idx <span class="sy0">=</span> index.<span class="me1">get</span><span class="br0">&#40;</span>word<span class="br0">&#41;</span><span class="sy0">;</span><br />			<span class="kw1">if</span> <span class="br0">&#40;</span>idx <span class="sy0">!=</span> <span class="kw2">null</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><br />				<span class="kw1">for</span> <span class="br0">&#40;</span>Tuple t <span class="sy0">:</span> idx<span class="br0">&#41;</span> <span class="br0">&#123;</span><br />					answer.<span class="me1">add</span><span class="br0">&#40;</span>files.<span class="me1">get</span><span class="br0">&#40;</span>t.<span class="me1">fileno</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span><br />				<span class="br0">&#125;</span><br />			<span class="br0">&#125;</span><br />			<a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Asystem+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky"><span class="kw3">System</span></a>.<span class="me1">out</span>.<span class="me1">print</span><span class="br0">&#40;</span>word<span class="br0">&#41;</span><span class="sy0">;</span><br />			<span class="kw1">for</span> <span class="br0">&#40;</span><a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Astring+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky"><span class="kw3">String</span></a> f <span class="sy0">:</span> answer<span class="br0">&#41;</span> <span class="br0">&#123;</span><br />				<a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Asystem+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky"><span class="kw3">System</span></a>.<span class="me1">out</span>.<span class="me1">print</span><span class="br0">&#40;</span><span class="st0">&quot; &quot;</span> <span class="sy0">+</span> f<span class="br0">&#41;</span><span class="sy0">;</span><br />			<span class="br0">&#125;</span><br />			<a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Asystem+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky"><span class="kw3">System</span></a>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">&#40;</span><span class="st0">&quot;&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span><br />		<span class="br0">&#125;</span><br />	<span class="br0">&#125;</span><br />&#160;<br />	<span class="kw1">public</span> <span class="kw1">static</span> <span class="kw4">void</span> main<span class="br0">&#40;</span><a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Astring+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky"><span class="kw3">String</span></a><span class="br0">&#91;</span><span class="br0">&#93;</span> args<span class="br0">&#41;</span> <span class="br0">&#123;</span><br />		<span class="kw1">try</span> <span class="br0">&#123;</span><br />			InvertedIndex idx <span class="sy0">=</span> <span class="kw1">new</span> InvertedIndex<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span><br />			<span class="kw1">for</span> <span class="br0">&#40;</span><span class="kw4">int</span> i <span class="sy0">=</span> <span class="nu0">1</span><span class="sy0">;</span> i <span class="sy0">&lt;</span> args.<span class="me1">length</span><span class="sy0">;</span> i<span class="sy0">++</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><br />				idx.<span class="me1">indexFile</span><span class="br0">&#40;</span><span class="kw1">new</span> <a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Afile+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky"><span class="kw3">File</span></a><span class="br0">&#40;</span>args<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span><br />			<span class="br0">&#125;</span><br />			idx.<span class="me1">search</span><span class="br0">&#40;</span><a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Aarrays+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky"><span class="kw3">Arrays</span></a>.<span class="me1">asList</span><span class="br0">&#40;</span>args<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span>.<span class="me1">split</span><span class="br0">&#40;</span><span class="st0">&quot;,&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span><br />		<span class="br0">&#125;</span> <span class="kw1">catch</span> <span class="br0">&#40;</span><a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Aexception+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky"><span class="kw3">Exception</span></a> e<span class="br0">&#41;</span> <span class="br0">&#123;</span><br />			e.<span class="me1">printStackTrace</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span><br />		<span class="br0">&#125;</span><br />	<span class="br0">&#125;</span><br />&#160;<br />	<span class="kw1">private</span> <span class="kw1">class</span> Tuple <span class="br0">&#123;</span><br />		<span class="kw1">private</span> <span class="kw4">int</span> fileno<span class="sy0">;</span><br />		<span class="kw1">private</span> <span class="kw4">int</span> position<span class="sy0">;</span><br />&#160;<br />		<span class="kw1">public</span> Tuple<span class="br0">&#40;</span><span class="kw4">int</span> fileno, <span class="kw4">int</span> position<span class="br0">&#41;</span> <span class="br0">&#123;</span><br />			<span class="kw1">this</span>.<span class="me1">fileno</span> <span class="sy0">=</span> fileno<span class="sy0">;</span><br />			<span class="kw1">this</span>.<span class="me1">position</span> <span class="sy0">=</span> position<span class="sy0">;</span><br />		<span class="br0">&#125;</span><br />	<span class="br0">&#125;</span><br /><span class="br0">&#125;</span><br />&#160;<br />&#160;</pre>
<p>Example output:
</p>
<pre class="java highlighted_source">&#160;<br />java <span class="sy0">-</span>cp bin org.<span class="me1">rosettacode</span>.<span class="me1">InvertedIndex</span> <span class="st0">&quot;huntsman,merit,dog,the,gutenberg,lovecraft,olympian&quot;</span> pg30637.<span class="me1">txt</span> pg7025.<span class="me1">txt</span> pg82.<span class="me1">txt</span> pg9090.<span class="me1">txt</span> <br />indexed pg30637.<span class="me1">txt</span> <span class="nu0">106473</span> words<br />indexed pg7025.<span class="me1">txt</span> <span class="nu0">205714</span> words<br />indexed pg82.<span class="me1">txt</span> <span class="nu0">205060</span> words<br />indexed pg9090.<span class="me1">txt</span> <span class="nu0">68962</span> words<br />huntsman pg82.<span class="me1">txt</span> pg7025.<span class="me1">txt</span><br />merit pg9090.<span class="me1">txt</span> pg30637.<span class="me1">txt</span> pg82.<span class="me1">txt</span> pg7025.<span class="me1">txt</span><br />dog pg30637.<span class="me1">txt</span> pg82.<span class="me1">txt</span> pg7025.<span class="me1">txt</span><br />the<br />gutenberg pg9090.<span class="me1">txt</span> pg30637.<span class="me1">txt</span> pg82.<span class="me1">txt</span> pg7025.<span class="me1">txt</span><br />lovecraft pg30637.<span class="me1">txt</span><br />olympian pg30637.<span class="me1">txt</span><br />&#160;<br />&#160;</pre>
<h2><span class="mw-headline" id="jq"><a href="/wiki/Category:Jq" title="Category:Jq">jq</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/mw/index.php?title=Inverted_index&amp;action=edit&amp;section=26" title="Edit section: jq">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>In the first part of this section, the core functions for computing an inverted index and for searching it are presented.
These functions will work with jq 1.4 as well as later (and possibly earlier) versions.
</p><p>The second section shows how to accomplish the interactive task using a version of jq with support for 'input' and 'input_filename' (e.g. jq 1.5).
</p><p><b>Part 1: inverted_index and search</b>
</p>
<pre class="text highlighted_source"># Given an array of [ doc, array_of_distinct_words ]<br /># construct a lookup table: { word: array_of_docs }<br />def inverted_index:<br />  reduce .[] as $pair<br />    ({};<br />     $pair[0] as $doc<br />     | reduce $pair[1][] as $word<br />       (.; .[$word] += [$doc]));<br />&#160;<br />def search(words):<br />  def overlap(that): . as $this<br />  | reduce that[] as $item ([]; if $this|index($item) then . + [$item] else . end);<br />&#160;<br />  . as $dict<br />  | if (words|length) == 0 then []<br />    else reduce words[1:][] as $word<br />      ( $dict[words[0]]; overlap( $dict[$word] ) )<br />    end&#160;; </pre>
<p><b>Part 2: Interactive Search</b>
</p><p>In this section, a solution to the task is presented using two
invocations of jq: one parses the input files, and the other does
everything else. If your shell does not support &lt;(...) then you
could create a temporary file to hold the parsed output.
</p>
<pre class="text highlighted_source">def prompt_search:<br />  &quot;Enter a string or an array of strings to search for, quoting each string, or 0 to exit:&quot;,<br />  ( (input | if type == &quot;array&quot; then . elif type == &quot;string&quot; then [.] <br />             else empty<br />             end) as $in<br />    | search($in), prompt_search )&#160;;<br />&#160;<br />$in | inverted_index | prompt_search</pre>
<p><b>Example</b>:
</p>
<pre class="text highlighted_source">$ jq -r -c -n --argfile in &lt;(jq -R 'split(&quot; &quot;) | select(length&gt;0) | [input_filename, unique]' T?.txt) -f Inverted_index.jq<br />Enter a string or an array of strings to search for, quoting each string, or 0 to exit:<br />&quot;is&quot;<br />[&quot;T0.txt&quot;,&quot;T1.txt&quot;,&quot;T2.txt&quot;]<br />Enter a string or an array of strings to search for, quoting each string, or 0 to exit:<br />[&quot;is&quot;, &quot;banana&quot;]<br />[&quot;T2.txt&quot;]<br />Enter a string or an array of strings to search for, quoting each string, or 0 to exit:<br />0<br />$</pre>
<h2><span class="mw-headline" id="Kotlin"><a href="/wiki/Category:Kotlin" title="Category:Kotlin">Kotlin</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/mw/index.php?title=Inverted_index&amp;action=edit&amp;section=27" title="Edit section: Kotlin">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<pre class="scala highlighted_source"><span class="co1">// version 1.1.51</span><br />&#160;<br /><a href="http://scala-lang.org"><span class="kw1">import</span></a> java.<span class="me1">io</span>.<span class="me1">File</span><br />&#160;<br /><a href="http://scala-lang.org"><span class="kw1">val</span></a> invIndex  <span class="sy0">=</span> mutableMapOf<span class="sy0">&lt;</span>String, MutableList<span class="sy0">&lt;</span>Location<span class="sy0">&gt;&gt;</span><span class="br0">&#40;</span><span class="br0">&#41;</span><br /><a href="http://scala-lang.org"><span class="kw1">val</span></a> fileNames <span class="sy0">=</span> mutableListOf<span class="sy0">&lt;</span>String<span class="sy0">&gt;</span><span class="br0">&#40;</span><span class="br0">&#41;</span><br /><a href="http://scala-lang.org"><span class="kw1">val</span></a> splitter  <span class="sy0">=</span> Regex<span class="br0">&#40;</span><span class="st0">&quot;&quot;</span><span class="st0">&quot;<span class="es0">\W</span>+&quot;</span><span class="st0">&quot;&quot;</span><span class="br0">&#41;</span><br />&#160;<br /><a href="http://scala-lang.org"><span class="kw1">class</span></a> Location<span class="br0">&#40;</span><a href="http://scala-lang.org"><span class="kw1">val</span></a> fileName<span class="sy0">:</span> String, <a href="http://scala-lang.org"><span class="kw1">val</span></a> wordNum<span class="sy0">:</span> Int<span class="br0">&#41;</span> <span class="br0">&#123;</span><br />    <a href="http://scala-lang.org"><span class="kw1">override</span></a> fun toString<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="sy0">=</span> <span class="st0">&quot;{$fileName, word number $wordNum}&quot;</span><br /><span class="br0">&#125;</span><br />&#160;<br />fun indexFile<span class="br0">&#40;</span>fileName<span class="sy0">:</span> String<span class="br0">&#41;</span> <span class="br0">&#123;</span><br />    <a href="http://scala-lang.org"><span class="kw1">if</span></a> <span class="br0">&#40;</span>fileName in fileNames<span class="br0">&#41;</span> <span class="br0">&#123;</span><br />        println<span class="br0">&#40;</span><span class="st0">&quot;'$fileName' already indexed&quot;</span><span class="br0">&#41;</span><br />        <a href="http://scala-lang.org"><span class="kw1">return</span></a><br />    <span class="br0">&#125;</span><br />    fileNames.<span class="me1">add</span><span class="br0">&#40;</span>fileName<span class="br0">&#41;</span><br />    File<span class="br0">&#40;</span>fileName<span class="br0">&#41;</span>.<span class="me1">forEachLine</span> <span class="br0">&#123;</span> line -<span class="sy0">&gt;</span><br />        <a href="http://scala-lang.org"><span class="kw1">for</span></a> <span class="br0">&#40;</span><span class="br0">&#40;</span>i, w<span class="br0">&#41;</span> in line.<span class="me1">toLowerCase</span><span class="br0">&#40;</span><span class="br0">&#41;</span>.<span class="me1">split</span><span class="br0">&#40;</span>splitter<span class="br0">&#41;</span>.<span class="me1">withIndex</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><br />            <a href="http://scala-lang.org"><span class="kw1">var</span></a> locations <span class="sy0">=</span> invIndex<span class="br0">&#91;</span>w<span class="br0">&#93;</span><br />            <a href="http://scala-lang.org"><span class="kw1">if</span></a> <span class="br0">&#40;</span>locations <span class="sy0">==</span> <a href="http://scala-lang.org"><span class="kw1">null</span></a><span class="br0">&#41;</span> <span class="br0">&#123;</span><br />                locations <span class="sy0">=</span> mutableListOf<span class="sy0">&lt;</span>Location<span class="sy0">&gt;</span><span class="br0">&#40;</span><span class="br0">&#41;</span><br />                invIndex.<span class="me1">put</span><span class="br0">&#40;</span>w, locations<span class="br0">&#41;</span><br />            <span class="br0">&#125;</span><br />            locations.<span class="me1">add</span><span class="br0">&#40;</span>Location<span class="br0">&#40;</span>fileName, i + <span class="nu0">1</span><span class="br0">&#41;</span><span class="br0">&#41;</span><br />        <span class="br0">&#125;</span><br />    <span class="br0">&#125;</span><br />    println<span class="br0">&#40;</span><span class="st0">&quot;'$fileName' has been indexed&quot;</span><span class="br0">&#41;</span><br /><span class="br0">&#125;</span><br />&#160;<br />fun findWord<span class="br0">&#40;</span>word<span class="sy0">:</span> String<span class="br0">&#41;</span> <span class="br0">&#123;</span><br />    <a href="http://scala-lang.org"><span class="kw1">val</span></a> w <span class="sy0">=</span> word.<span class="me1">toLowerCase</span><span class="br0">&#40;</span><span class="br0">&#41;</span><br />    <a href="http://scala-lang.org"><span class="kw1">val</span></a> locations <span class="sy0">=</span> invIndex<span class="br0">&#91;</span>w<span class="br0">&#93;</span><br />    <a href="http://scala-lang.org"><span class="kw1">if</span></a> <span class="br0">&#40;</span>locations <span class="sy0">!=</span> <a href="http://scala-lang.org"><span class="kw1">null</span></a><span class="br0">&#41;</span> <span class="br0">&#123;</span><br />       println<span class="br0">&#40;</span><span class="st0">&quot;<span class="es1">\n</span>'$word' found in the following locations:&quot;</span><span class="br0">&#41;</span><br />       println<span class="br0">&#40;</span>locations.<span class="me1">map</span> <span class="br0">&#123;</span> <span class="st0">&quot;    $it&quot;</span> <span class="br0">&#125;</span>.<span class="me1">joinToString</span><span class="br0">&#40;</span><span class="st0">&quot;<span class="es1">\n</span>&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><br />    <span class="br0">&#125;</span><br />    <a href="http://scala-lang.org"><span class="kw1">else</span></a> println<span class="br0">&#40;</span><span class="st0">&quot;<span class="es1">\n</span>'$word' not found&quot;</span><span class="br0">&#41;</span><br />    println<span class="br0">&#40;</span><span class="br0">&#41;</span><br /><span class="br0">&#125;</span><br />&#160;<br />fun main<span class="br0">&#40;</span>args<span class="sy0">:</span> Array<span class="sy0">&lt;</span>String<span class="sy0">&gt;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><br />    <span class="co1">// files to be indexed entered as command line arguments</span><br />    <a href="http://scala-lang.org"><span class="kw1">if</span></a> <span class="br0">&#40;</span>args.<span class="me1">size</span> <span class="sy0">==</span> <span class="nu0">0</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><br />        println<span class="br0">&#40;</span><span class="st0">&quot;No file names have been supplied&quot;</span><span class="br0">&#41;</span><br />        <a href="http://scala-lang.org"><span class="kw1">return</span></a><br />    <span class="br0">&#125;</span><br />    <a href="http://scala-lang.org"><span class="kw1">for</span></a> <span class="br0">&#40;</span>arg in args<span class="br0">&#41;</span> indexFile<span class="br0">&#40;</span>arg<span class="br0">&#41;</span><br />    println<span class="br0">&#40;</span><span class="br0">&#41;</span><br />    println<span class="br0">&#40;</span><span class="st0">&quot;Enter word(s) to be searched for in these files or 'q' to quit&quot;</span><span class="br0">&#41;</span><br />    <a href="http://scala-lang.org"><span class="kw1">while</span></a> <span class="br0">&#40;</span><a href="http://scala-lang.org"><span class="kw1">true</span></a><span class="br0">&#41;</span> <span class="br0">&#123;</span><br />        print<span class="br0">&#40;</span><span class="st0">&quot; &#160;?&#160;: &quot;</span><span class="br0">&#41;</span><br />        <a href="http://scala-lang.org"><span class="kw1">val</span></a> word <span class="sy0">=</span> readLine<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">!!</span><br />        <a href="http://scala-lang.org"><span class="kw1">if</span></a> <span class="br0">&#40;</span>word.<span class="me1">toLowerCase</span><span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="sy0">==</span> <span class="st0">&quot;q&quot;</span><span class="br0">&#41;</span> <a href="http://scala-lang.org"><span class="kw1">return</span></a><br />        findWord<span class="br0">&#40;</span>word<span class="br0">&#41;</span><br />    <span class="br0">&#125;</span><br /><span class="br0">&#125;</span></pre>
<p>Contents of files:
</p>
<pre>inv1.txt  -&gt; It is what it is.
inv2.txt  -&gt; What is it?
inv3.txt  -&gt; It is a banana!
</pre>
<p>Sample output:
</p>
<pre>$ java -jar inverted_index.jar inv1.txt inv2.txt inv3.txt inv1.txt
'inv1.txt' has been indexed
'inv2.txt' has been indexed
'inv3.txt' has been indexed
'inv1.txt' already indexed

Enter word(s) to be searched for in these files or 'q' to quit
 &#160;?&#160;: cat 

'cat' not found

 &#160;?&#160;: is

'is' found in the following locations:
    {inv1.txt, word number 2}
    {inv1.txt, word number 5}
    {inv2.txt, word number 2}
    {inv3.txt, word number 2}

 &#160;?&#160;: banana

'banana' found in the following locations:
    {inv3.txt, word number 4}

 &#160;?&#160;: it

'it' found in the following locations:
    {inv1.txt, word number 1}
    {inv1.txt, word number 4}
    {inv2.txt, word number 3}
    {inv3.txt, word number 1}

 &#160;?&#160;: what

'what' found in the following locations:
    {inv1.txt, word number 3}
    {inv2.txt, word number 1}

 &#160;?&#160;: a

'a' found in the following locations:
    {inv3.txt, word number 3}

 &#160;?&#160;: q
</pre>
<h2><span class="mw-headline" id="OCaml"><a href="/wiki/Category:OCaml" title="Category:OCaml">OCaml</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/mw/index.php?title=Inverted_index&amp;action=edit&amp;section=28" title="Edit section: OCaml">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>We store the inverted index data in the file "data.inv" using the <a rel="nofollow" class="external text" href="http://www.ocaml.info/home/ocaml_sources.html#sexplib310">sexplib</a> library, so we compile with:
</p>
<pre>ocamlc -c \
  -pp "camlp4o -I `ocamlc -where`/type-conv \
               -I `ocamlc -where`/sexplib \
               pa_type_conv.cmo pa_sexp_conv.cmo" \
  unix.cma bigarray.cma nums.cma -I +sexplib sexplib.cma str.cma \
  inv.ml

ocamlc -o inv.byte unix.cma bigarray.cma nums.cma -I +sexplib sexplib.cma str.cma inv.cmo
</pre>
<pre class="ocaml highlighted_source">TYPE_CONV_PATH <span class="st0">&quot;Inverted_index&quot;</span><br />&#160;<br /><span class="kw1">type</span> files <span class="sy0">=</span> <a href="http://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#TYPEstring"><span class="kw4">string</span></a> <a href="http://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#TYPEarray"><span class="kw4">array</span></a> <span class="kw1">with</span> sexp<br /><span class="kw1">type</span> inverted_index <span class="sy0">=</span> <span class="br0">&#40;</span><a href="http://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#TYPEstring"><span class="kw4">string</span></a> <span class="sy0">*</span> <a href="http://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#TYPEint"><span class="kw4">int</span></a> <a href="http://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#TYPElist"><span class="kw4">list</span></a><span class="br0">&#41;</span> <a href="http://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#TYPElist"><span class="kw4">list</span></a> <span class="kw1">with</span> sexp<br />&#160;<br /><span class="kw1">type</span> t <span class="sy0">=</span> files <span class="sy0">*</span> inverted_index <span class="kw1">with</span> sexp<br />&#160;<br /><span class="kw1">open</span> Sexplib<br />&#160;<br /><span class="kw1">let</span> data_file <span class="sy0">=</span> <span class="st0">&quot;data.inv&quot;</span><br /><span class="kw1">let</span> data_path <span class="sy0">=</span> <a href="http://caml.inria.fr/pub/docs/manual-ocaml/libref/Filename.html"><span class="kw2">Filename</span></a><span class="sy0">.</span>concat <a href="http://caml.inria.fr/pub/docs/manual-ocaml/libref/Filename.html"><span class="kw2">Filename</span></a><span class="sy0">.</span>temp_dir_name data_file<br />&#160;<br /><span class="kw1">let</span> get_inv_index<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="sy0">=</span><br />  <span class="kw1">if</span> <a href="http://caml.inria.fr/pub/docs/manual-ocaml/libref/Sys.html"><span class="kw2">Sys</span></a><span class="sy0">.</span>file_exists data_path<br />  <span class="kw1">then</span> t_of_sexp<span class="br0">&#40;</span>Sexp<span class="sy0">.</span>load_sexp data_path<span class="br0">&#41;</span><br />  <span class="kw1">else</span> <span class="br0">&#40;</span><span class="br0">&#91;</span><span class="sy0">|</span> <span class="sy0">|</span><span class="br0">&#93;</span>, <span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#41;</span><br />&#160;<br /><span class="kw1">let</span> load_file f <span class="sy0">=</span><br />  <span class="kw1">let</span> ic <span class="sy0">=</span> <a href="http://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#VALopen_in"><span class="kw3">open_in</span></a> f <span class="kw1">in</span><br />  <span class="kw1">let</span> n <span class="sy0">=</span> <a href="http://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#VALin_channel_length"><span class="kw3">in_channel_length</span></a> ic <span class="kw1">in</span><br />  <span class="kw1">let</span> s <span class="sy0">=</span> <a href="http://caml.inria.fr/pub/docs/manual-ocaml/libref/String.html"><span class="kw2">String</span></a><span class="sy0">.</span>create n <span class="kw1">in</span><br />  <a href="http://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#VALreally_input"><span class="kw3">really_input</span></a> ic s <span class="nu0">0</span> n<span class="sy0">;</span><br />  <a href="http://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#VALclose_in"><span class="kw3">close_in</span></a> ic<span class="sy0">;</span><br />  <span class="br0">&#40;</span>s<span class="br0">&#41;</span><br />&#160;<br /><span class="kw1">let</span> array_push ar v <span class="sy0">=</span><br />  <span class="kw1">let</span> len <span class="sy0">=</span> <a href="http://caml.inria.fr/pub/docs/manual-ocaml/libref/Array.html"><span class="kw2">Array</span></a><span class="sy0">.</span>length ar <span class="kw1">in</span><br />  <a href="http://caml.inria.fr/pub/docs/manual-ocaml/libref/Array.html"><span class="kw2">Array</span></a><span class="sy0">.</span>init <span class="br0">&#40;</span><a href="http://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#VALsucc"><span class="kw3">succ</span></a> len<span class="br0">&#41;</span> <span class="br0">&#40;</span><span class="kw1">fun</span> i <span class="sy0">-&gt;</span><br />    <span class="kw1">if</span> i <span class="sy0">&lt;</span> len <span class="kw1">then</span> <a href="http://caml.inria.fr/pub/docs/manual-ocaml/libref/Array.html"><span class="kw2">Array</span></a><span class="sy0">.</span>unsafe_get ar i <span class="kw1">else</span> v<span class="br0">&#41;</span>, len<br />&#160;<br /><span class="kw1">let</span> uniq lst <span class="sy0">=</span><br />  <span class="kw1">let</span> h <span class="sy0">=</span> <a href="http://caml.inria.fr/pub/docs/manual-ocaml/libref/Hashtbl.html"><span class="kw2">Hashtbl</span></a><span class="sy0">.</span>create <span class="br0">&#40;</span><a href="http://caml.inria.fr/pub/docs/manual-ocaml/libref/List.html"><span class="kw2">List</span></a><span class="sy0">.</span>length lst<span class="br0">&#41;</span> <span class="kw1">in</span><br />  <a href="http://caml.inria.fr/pub/docs/manual-ocaml/libref/List.html"><span class="kw2">List</span></a><span class="sy0">.</span>iter <span class="br0">&#40;</span><span class="kw1">fun</span> x <span class="sy0">-&gt;</span> <a href="http://caml.inria.fr/pub/docs/manual-ocaml/libref/Hashtbl.html"><span class="kw2">Hashtbl</span></a><span class="sy0">.</span>replace h x <span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span> lst<span class="sy0">;</span><br />  <a href="http://caml.inria.fr/pub/docs/manual-ocaml/libref/Hashtbl.html"><span class="kw2">Hashtbl</span></a><span class="sy0">.</span>fold <span class="br0">&#40;</span><span class="kw1">fun</span> x <span class="br0">&#40;</span><span class="br0">&#41;</span> xs <span class="sy0">-&gt;</span> x <span class="sy0">::</span> xs<span class="br0">&#41;</span> h <span class="br0">&#91;</span><span class="br0">&#93;</span><br />&#160;<br /><span class="kw1">let</span> combine words i inv_index <span class="sy0">=</span><br />  <span class="kw1">let</span> h <span class="sy0">=</span> <a href="http://caml.inria.fr/pub/docs/manual-ocaml/libref/Hashtbl.html"><span class="kw2">Hashtbl</span></a><span class="sy0">.</span>create <span class="br0">&#40;</span><a href="http://caml.inria.fr/pub/docs/manual-ocaml/libref/List.html"><span class="kw2">List</span></a><span class="sy0">.</span>length inv_index<span class="br0">&#41;</span> <span class="kw1">in</span><br />  <a href="http://caml.inria.fr/pub/docs/manual-ocaml/libref/List.html"><span class="kw2">List</span></a><span class="sy0">.</span>iter <span class="br0">&#40;</span><span class="kw1">fun</span> <span class="br0">&#40;</span>w, from<span class="br0">&#41;</span> <span class="sy0">-&gt;</span> <a href="http://caml.inria.fr/pub/docs/manual-ocaml/libref/Hashtbl.html"><span class="kw2">Hashtbl</span></a><span class="sy0">.</span>replace h w from<span class="br0">&#41;</span> inv_index<span class="sy0">;</span><br />  <a href="http://caml.inria.fr/pub/docs/manual-ocaml/libref/List.html"><span class="kw2">List</span></a><span class="sy0">.</span>iter <span class="br0">&#40;</span><span class="kw1">fun</span> w <span class="sy0">-&gt;</span><br />    <span class="kw1">let</span> from <span class="sy0">=</span><br />      <span class="kw1">try</span> <a href="http://caml.inria.fr/pub/docs/manual-ocaml/libref/Hashtbl.html"><span class="kw2">Hashtbl</span></a><span class="sy0">.</span>find h w<br />      except Not_found <span class="sy0">-&gt;</span> <span class="br0">&#91;</span><span class="br0">&#93;</span><br />    <span class="kw1">in</span><br />    <a href="http://caml.inria.fr/pub/docs/manual-ocaml/libref/Hashtbl.html"><span class="kw2">Hashtbl</span></a><span class="sy0">.</span>replace h w <span class="br0">&#40;</span>i<span class="sy0">::</span>from<span class="br0">&#41;</span><br />  <span class="br0">&#41;</span> words<span class="sy0">;</span><br />  <a href="http://caml.inria.fr/pub/docs/manual-ocaml/libref/Hashtbl.html"><span class="kw2">Hashtbl</span></a><span class="sy0">.</span>fold <span class="br0">&#40;</span><span class="kw1">fun</span> w from acc <span class="sy0">-&gt;</span> <span class="br0">&#40;</span>w, from<span class="br0">&#41;</span> <span class="sy0">::</span> acc<span class="br0">&#41;</span> h <span class="br0">&#91;</span><span class="br0">&#93;</span><br />&#160;<br /><span class="kw1">let</span> words_of_file in_file <span class="sy0">=</span><br />  <span class="kw1">let</span> str <span class="sy0">=</span> load_file in_file <span class="kw1">in</span><br />  <span class="kw1">let</span> words <span class="sy0">=</span> <a href="http://caml.inria.fr/pub/docs/manual-ocaml/libref/Str.html"><span class="kw2">Str</span></a><span class="sy0">.</span>split <span class="br0">&#40;</span><a href="http://caml.inria.fr/pub/docs/manual-ocaml/libref/Str.html"><span class="kw2">Str</span></a><span class="sy0">.</span><span class="kw1">regexp</span> <span class="st0">&quot;[ \r\n\t,;.?!:'/\034()]&quot;</span><span class="br0">&#41;</span> str <span class="kw1">in</span><br />  <span class="kw1">let</span> words <span class="sy0">=</span> uniq words <span class="kw1">in</span><br />  <span class="br0">&#40;</span>words<span class="br0">&#41;</span><br />&#160;<br /><span class="kw1">let</span> index_file in_file <span class="sy0">=</span><br />  <span class="kw1">let</span> words <span class="sy0">=</span> words_of_file in_file <span class="kw1">in</span><br />  <span class="kw1">let</span> files, inv_index <span class="sy0">=</span> get_inv_index<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="kw1">in</span><br />  <span class="kw1">let</span> files, i <span class="sy0">=</span> array_push files in_file <span class="kw1">in</span><br />  <span class="kw1">let</span> inv_index <span class="sy0">=</span> combine words i inv_index <span class="kw1">in</span><br />  <span class="kw1">let</span> se <span class="sy0">=</span> sexp_of_t <span class="br0">&#40;</span>files, inv_index<span class="br0">&#41;</span> <span class="kw1">in</span><br />  Sexp<span class="sy0">.</span>save data_path se<br />&#160;<br /><span class="kw1">let</span> search_word word <span class="sy0">=</span><br />  <span class="kw1">let</span> files, inv_index <span class="sy0">=</span> get_inv_index<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="kw1">in</span><br />  <span class="kw1">try</span><br />    <span class="kw1">let</span> is_in <span class="sy0">=</span> <a href="http://caml.inria.fr/pub/docs/manual-ocaml/libref/List.html"><span class="kw2">List</span></a><span class="sy0">.</span>assoc word inv_index <span class="kw1">in</span><br />    <a href="http://caml.inria.fr/pub/docs/manual-ocaml/libref/List.html"><span class="kw2">List</span></a><span class="sy0">.</span>iter <span class="br0">&#40;</span><span class="kw1">fun</span> i <span class="sy0">-&gt;</span> <a href="http://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#VALprint_endline"><span class="kw3">print_endline</span></a> files<span class="sy0">.</span><span class="br0">&#40;</span>i<span class="br0">&#41;</span><span class="br0">&#41;</span> is_in<br />  <span class="kw1">with</span> Not_found <span class="sy0">-&gt;</span><br />    <a href="http://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#VALprint_endline"><span class="kw3">print_endline</span></a> <span class="st0">&quot;# Not Found&quot;</span><br />&#160;<br /><span class="kw1">let</span> usage<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="sy0">=</span><br />  <a href="http://caml.inria.fr/pub/docs/manual-ocaml/libref/Printf.html"><span class="kw2">Printf</span></a><span class="sy0">.</span>printf <span class="st0">&quot;Usage:&#160;%s \<br />    --index-file &lt;file.txt&gt; / \<br />    --search-word &lt;some-word&gt;\n%!&quot;</span> <a href="http://caml.inria.fr/pub/docs/manual-ocaml/libref/Sys.html"><span class="kw2">Sys</span></a><span class="sy0">.</span>argv<span class="sy0">.</span><span class="br0">&#40;</span><span class="nu0">0</span><span class="br0">&#41;</span><span class="sy0">;</span><br />  <a href="http://caml.inria.fr/pub/docs/manual-ocaml/libref/Pervasives.html#VALexit"><span class="kw3">exit</span></a> <span class="nu0">1</span><br />&#160;<br /><span class="kw1">let</span> <span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="sy0">=</span><br />  <span class="kw1">let</span> cmd, arg <span class="sy0">=</span> <span class="kw1">try</span> <span class="br0">&#40;</span><a href="http://caml.inria.fr/pub/docs/manual-ocaml/libref/Sys.html"><span class="kw2">Sys</span></a><span class="sy0">.</span>argv<span class="sy0">.</span><span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span>, <a href="http://caml.inria.fr/pub/docs/manual-ocaml/libref/Sys.html"><span class="kw2">Sys</span></a><span class="sy0">.</span>argv<span class="sy0">.</span><span class="br0">&#40;</span><span class="nu0">2</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">with</span> _ <span class="sy0">-&gt;</span> usage<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="kw1">in</span><br />  <span class="kw1">match</span> cmd, arg <span class="kw1">with</span><br />  <span class="sy0">|</span> <span class="st0">&quot;--index-file&quot;</span>, in_file <span class="sy0">-&gt;</span> index_file in_file<br />  <span class="sy0">|</span> <span class="st0">&quot;--search-word&quot;</span>, word <span class="sy0">-&gt;</span> search_word word<br />  <span class="sy0">|</span> _ <span class="sy0">-&gt;</span> usage<span class="br0">&#40;</span><span class="br0">&#41;</span></pre>
<h2><span class="mw-headline" id="Perl"><a href="/wiki/Category:Perl" title="Category:Perl">Perl</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/mw/index.php?title=Inverted_index&amp;action=edit&amp;section=29" title="Edit section: Perl">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<pre class="perl highlighted_source"><span class="kw2">use</span> Set<span class="sy0">::</span><span class="me2">Object</span> <span class="st_h">'set'</span><span class="sy0">;</span><br />&#160;<br /><span class="co1"># given an array of files, returns the index</span><br /><span class="kw2">sub</span> createindex<br /><span class="br0">&#123;</span><br />    <span class="kw1">my</span> <span class="re0">@files</span> <span class="sy0">=</span> <span class="co5">@_</span><span class="sy0">;</span><br />&#160;<br />    <span class="kw1">my</span> <span class="re0">%iindex</span><span class="sy0">;</span><br />&#160;<br />    <span class="kw1">foreach</span> <span class="kw1">my</span> <span class="re0">$file</span> <span class="br0">&#40;</span><span class="re0">@files</span><span class="br0">&#41;</span><br />    <span class="br0">&#123;</span><br />	<a href="http://perldoc.perl.org/functions/open.html"><span class="kw3">open</span></a><span class="br0">&#40;</span>F<span class="sy0">,</span> <span class="st0">&quot;&lt;&quot;</span><span class="sy0">,</span> <span class="re0">$file</span><span class="br0">&#41;</span> <span class="kw1">or</span> <a href="http://perldoc.perl.org/functions/die.html"><span class="kw3">die</span></a> <span class="st0">&quot;Can't read file $file: $!&quot;</span><span class="sy0">;</span><br />	<span class="kw1">while</span><span class="br0">&#40;</span><span class="re4">&lt;F&gt;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><br />            <span class="co2">s/\A\W+//</span><span class="sy0">;</span><br />	    <span class="kw1">foreach</span> <span class="kw1">my</span> <span class="re0">$w</span> <span class="br0">&#40;</span><a href="http://perldoc.perl.org/functions/map.html"><span class="kw3">map</span></a> <span class="br0">&#123;</span><a href="http://perldoc.perl.org/functions/lc.html"><span class="kw3">lc</span></a><span class="br0">&#125;</span> <a href="http://perldoc.perl.org/functions/grep.html"><span class="kw3">grep</span></a> <span class="br0">&#123;</span><a href="http://perldoc.perl.org/functions/length.html"><span class="kw3">length</span></a><span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="sy0">&gt;=</span> <span class="nu0">3</span><span class="br0">&#125;</span> <a href="http://perldoc.perl.org/functions/split.html"><span class="kw3">split</span></a> <span class="co2">/\W+/</span><span class="br0">&#41;</span><br />	    <span class="br0">&#123;</span><br />		<span class="kw1">if</span> <span class="br0">&#40;</span> <a href="http://perldoc.perl.org/functions/exists.html"><span class="kw3">exists</span></a><span class="br0">&#40;</span><span class="re0">$iindex</span><span class="br0">&#123;</span><span class="re0">$w</span><span class="br0">&#125;</span><span class="br0">&#41;</span> <span class="br0">&#41;</span><br />		<span class="br0">&#123;</span><br />		    <span class="re0">$iindex</span><span class="br0">&#123;</span><span class="re0">$w</span><span class="br0">&#125;</span><span class="sy0">-&gt;</span><span class="me1">insert</span><span class="br0">&#40;</span><span class="re0">$file</span><span class="br0">&#41;</span><span class="sy0">;</span><br />		<span class="br0">&#125;</span> <span class="kw1">else</span> <span class="br0">&#123;</span><br />		    <span class="re0">$iindex</span><span class="br0">&#123;</span><span class="re0">$w</span><span class="br0">&#125;</span> <span class="sy0">=</span> set<span class="br0">&#40;</span><span class="re0">$file</span><span class="br0">&#41;</span><span class="sy0">;</span><br />		<span class="br0">&#125;</span><br />	    <span class="br0">&#125;</span><br />	<span class="br0">&#125;</span><br />	<a href="http://perldoc.perl.org/functions/close.html"><span class="kw3">close</span></a><span class="br0">&#40;</span>F<span class="br0">&#41;</span><span class="sy0">;</span><br />    <span class="br0">&#125;</span><br />    <a href="http://perldoc.perl.org/functions/return.html"><span class="kw3">return</span></a> <span class="re0">%iindex</span><span class="sy0">;</span><br /><span class="br0">&#125;</span><br />&#160;<br /><span class="co1"># given an index, search for words</span><br /><span class="kw2">sub</span> search_words_with_index<br /><span class="br0">&#123;</span><br />    <span class="kw1">my</span> <span class="re0">%idx</span> <span class="sy0">=</span> <span class="sy0">%</span><span class="br0">&#123;</span><a href="http://perldoc.perl.org/functions/shift.html"><span class="kw3">shift</span></a><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#125;</span><span class="sy0">;</span><br />    <span class="kw1">my</span> <span class="re0">@words</span> <span class="sy0">=</span> <span class="co5">@_</span><span class="sy0">;</span><br />    <span class="kw1">my</span> <span class="re0">$res</span> <span class="sy0">=</span> set<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span><br />&#160;<br />    <span class="kw1">foreach</span> <span class="kw1">my</span> <span class="re0">$w</span> <span class="br0">&#40;</span><a href="http://perldoc.perl.org/functions/map.html"><span class="kw3">map</span></a> <span class="br0">&#123;</span><a href="http://perldoc.perl.org/functions/lc.html"><span class="kw3">lc</span></a><span class="br0">&#125;</span> <span class="re0">@words</span><span class="br0">&#41;</span><br />    <span class="br0">&#123;</span><br />	<span class="re0">$w</span> <span class="sy0">=~</span> <span class="co2">s/\W+//g</span><span class="sy0">;</span>            <span class="co1"># strip non-words chars</span><br />        <a href="http://perldoc.perl.org/functions/length.html"><span class="kw3">length</span></a> <span class="re0">$w</span> <span class="sy0">&lt;</span> <span class="nu0">3</span> <span class="kw1">and</span> <span class="kw1">next</span><span class="sy0">;</span><br />        <a href="http://perldoc.perl.org/functions/exists.html"><span class="kw3">exists</span></a> <span class="re0">$idx</span><span class="br0">&#123;</span><span class="re0">$w</span><span class="br0">&#125;</span> <span class="kw1">or</span> <a href="http://perldoc.perl.org/functions/return.html"><span class="kw3">return</span></a> set<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span><br />        <span class="re0">$res</span> <span class="sy0">=</span> <span class="re0">$res</span><span class="sy0">-&gt;</span><span class="me1">is_null</span><br />          <span class="sy0">?</span> set<span class="br0">&#40;</span><span class="sy0">@</span><span class="br0">&#123;</span><span class="re0">$idx</span><span class="br0">&#123;</span><span class="re0">$w</span><span class="br0">&#125;</span><span class="br0">&#125;</span><span class="br0">&#41;</span><br />          <span class="sy0">:</span> <span class="re0">$res</span> <span class="sy0">*</span> <span class="re0">$idx</span><span class="br0">&#123;</span><span class="re0">$w</span><span class="br0">&#125;</span><span class="sy0">;</span>       <span class="co1"># set intersection</span><br />    <span class="br0">&#125;</span><br />    <a href="http://perldoc.perl.org/functions/return.html"><span class="kw3">return</span></a> <span class="re0">@$res</span><span class="sy0">;</span><br /><span class="br0">&#125;</span><br />&#160;<br /><span class="co1"># TESTING</span><br /><span class="co1"># USAGE: invidx.pl the,list,of,words file1 file2 .. fileN</span><br /><span class="kw1">my</span> <span class="re0">@searchwords</span> <span class="sy0">=</span> <a href="http://perldoc.perl.org/functions/split.html"><span class="kw3">split</span></a> <span class="co2">/,/</span><span class="sy0">,</span> <a href="http://perldoc.perl.org/functions/shift.html"><span class="kw3">shift</span></a><span class="sy0">;</span><br /><span class="co1"># first arg is a comma-separated list of words to search for</span><br /><a href="http://perldoc.perl.org/functions/print.html"><span class="kw3">print</span></a> <span class="st0">&quot;$_<span class="es0">\n</span>&quot;</span><br />    <span class="kw1">foreach</span> search_words_with_index<span class="br0">&#40;</span><span class="br0">&#123;</span>createindex<span class="br0">&#40;</span><span class="sy0">@</span><span class="kw2">ARGV</span><span class="br0">&#41;</span><span class="br0">&#125;</span><span class="sy0">,</span> <span class="re0">@searchwords</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>
<h2><span class="mw-headline" id="Perl_6"><a href="/wiki/Category:Perl_6" title="Category:Perl 6">Perl 6</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/mw/index.php?title=Inverted_index&amp;action=edit&amp;section=30" title="Edit section: Perl 6">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<div class="examplemeta workswith"><b>Works with</b>: <a href="/wiki/Rakudo" title="Rakudo">rakudo</a> version 2015-09-16</div>
<pre class="perl6 highlighted_source"><span class="kw2">sub</span> MAIN <span class="br0">&#40;</span><span class="sy0">*</span><span class="re0">@files</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><br />    <span class="kw1">my</span> <span class="re0">%norm</span><span class="sy0">;</span> <br />    <span class="kw1">do</span> <span class="kw1">for</span> <span class="re0">@files</span> <span class="sy0">-&gt;</span> <span class="re0">$file</span> <span class="br0">&#123;</span><br />        <span class="re0">%norm</span><span class="sy0">.</span><span class="kw3">push</span><span class="sy0">:</span> <span class="re0">$file</span> <span class="kw1">X</span><span class="sy0">=&gt;</span> slurp<span class="br0">&#40;</span><span class="re0">$file</span><span class="br0">&#41;</span><span class="sy0">.</span><span class="kw3">lc</span><span class="sy0">.</span><span class="kw3">words</span><span class="sy0">;</span><br />    <span class="br0">&#125;</span><br />    <span class="br0">&#40;</span><span class="kw1">my</span> <span class="re0">%inv</span><span class="br0">&#41;</span><span class="sy0">.</span><span class="kw3">push</span><span class="sy0">:</span> <span class="re0">%norm</span><span class="sy0">.</span><span class="kw3">invert</span><span class="sy0">.</span><span class="me1">unique</span><span class="sy0">;</span><br />&#160;<br />    <span class="kw1">while</span> prompt<span class="br0">&#40;</span><span class="st0">&quot;Search terms: &quot;</span><span class="br0">&#41;</span><span class="sy0">.</span><span class="kw3">words</span> <span class="sy0">-&gt;</span> <span class="sy0">@</span><span class="kw3">words</span> <span class="br0">&#123;</span><br />        <span class="kw1">for</span> <span class="sy0">@</span><span class="kw3">words</span> <span class="sy0">-&gt;</span> <span class="re0">$word</span> <span class="br0">&#123;</span><br />            <span class="kw3">say</span> <span class="st0">&quot;$word =&gt; {%inv.{$word.lc}//'(not found)'}&quot;</span><span class="sy0">;</span><br />        <span class="br0">&#125;</span><br />    <span class="br0">&#125;</span><br /><span class="br0">&#125;</span></pre>
<h2><span class="mw-headline" id="Phix"><a href="/wiki/Category:Phix" title="Category:Phix">Phix</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/mw/index.php?title=Inverted_index&amp;action=edit&amp;section=31" title="Edit section: Phix">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The following is included in the distro as demo\rosetta\Inverted_index.exw.<br />
Loads all text files in demo\rosetta\ and builds a list of filenames and
a dictionary of {word,file_indexes}, before a handful of quick tests.<br />
Might be better (and almost as easy) for the dictionary values to be say
{total_count, {file nos}, {file counts}}.
</p>
<pre class="text highlighted_source">integer word_count = 0<br />sequence filenames = {}<br />&#160;<br />function is_ascii(string txt)<br />    for i=1 to length(txt) do<br />        integer ch = txt[i]<br />        if ch='\0' or ch&gt;=#7F then return 0 end if<br />    end for<br />    return 1<br />end function<br />&#160;<br />procedure add_words(string name, sequence words)<br />    filenames = append(filenames,name)<br />    integer fn = length(filenames)<br />    for i=1 to length(words) do<br />        string word = words[i]<br />        if word[1]&gt;='a'         -- skip numbers<br />        and word[1]&lt;='z' then<br />            integer node = getd_index(word)<br />            if node=0 then  -- not present<br />                setd(word,{fn})<br />                word_count += 1<br />            else<br />                sequence val = getd_by_index(node)<br />                if find(fn,val)=0 then<br />                    setd(word,append(val,fn))<br />                end if<br />            end if<br />        end if<br />    end for<br />end procedure<br />&#160;<br />procedure load_directory()<br />sequence d = dir(&quot;.&quot;)<br />    for i=1 to length(d) do<br />        if not find('d',d[i][D_ATTRIBUTES])     -- skip directories<br />        and d[i][D_SIZE]&lt;1024*1024*1024 then    -- and files &gt; 1GB<br />            string name = d[i][D_NAME]<br />            integer fn = open(name,&quot;rb&quot;)<br />            string txt = lower(get_text(fn))<br />            close(fn)<br />            if is_ascii(txt) then               -- skip any bitmaps etc<br />                sequence words = split_any(txt,&quot;\0\r\n\t&#160;!\&quot;#$%&amp;\'()*+,-./:;&lt;=&gt;<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="3e017e">[email&#160;protected]</a>[\\]^`{|}~&quot;,0,1)<br />                add_words(name,words)<br />            end if<br />        end if<br />    end for<br />end procedure<br />&#160;<br />function lookup(sequence words)<br />sequence files = {}     -- indexes to filenames<br />    for i=1 to length(words) do<br />        string word = words[i]<br />        integer node = getd_index(word)<br />        if node=0 then return {} end if<br />        sequence val = getd_by_index(node)<br />        if i=1 then<br />            files = val<br />        else<br />            for j=length(files) to 1 by -1 do<br />                if not find(files[j],val) then<br />                    files[j..j] = {}<br />                end if<br />            end for<br />            if length(files)=0 then return {} end if<br />        end if<br />    end for<br />    for i=1 to length(files) do<br />        files[i] = filenames[files[i]]<br />    end for<br />    return files<br />end function<br />&#160;<br />load_directory()<br />?word_count<br />?lookup({&quot;load_directory&quot;})     -- should only be this file<br />?lookup({&quot;dir&quot;})                -- currently two use this<br />?lookup({&quot;lower&quot;})              -- currently four use this<br />?lookup({&quot;lower&quot;,&quot;dir&quot;})        -- currently two use both<br />?lookup({&quot;dir&quot;,&quot;lower&quot;})        -- should be the same two<br />?lookup({&quot;ban&quot;&amp;&quot;anafish&quot;})      -- should be none ({})</pre>
<div>
<dl><dt>Output:</div></dt></dl>
<pre>3365
{&quot;Inverted_index.exw&quot;}
{&quot;Inverted_index.exw&quot;,&quot;viewppm.exw&quot;}
{&quot;AlmostPrime.exw&quot;,&quot;Inverted_index.exw&quot;,&quot;RockPaperScissors.exw&quot;,&quot;viewppm.exw&quot;}
{&quot;Inverted_index.exw&quot;,&quot;viewppm.exw&quot;}
{&quot;Inverted_index.exw&quot;,&quot;viewppm.exw&quot;}
{}
</pre>
<h2><span class="mw-headline" id="PHP"><a href="/wiki/Category:PHP" title="Category:PHP">PHP</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/mw/index.php?title=Inverted_index&amp;action=edit&amp;section=32" title="Edit section: PHP">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<pre class="php highlighted_source"><span class="kw2">&lt;?php</span><br />&#160;<br /><span class="kw2">function</span> buildInvertedIndex<span class="br0">&#40;</span><span class="re0">$filenames</span><span class="br0">&#41;</span><br /><span class="br0">&#123;</span><br />    <span class="re0">$invertedIndex</span> <span class="sy0">=</span> <span class="br0">&#91;</span><span class="br0">&#93;</span><span class="sy0">;</span><br />&#160;<br />    <span class="kw1">foreach</span><span class="br0">&#40;</span><span class="re0">$filenames</span> <span class="kw1">as</span> <span class="re0">$filename</span><span class="br0">&#41;</span><br />    <span class="br0">&#123;</span><br />        <span class="re0">$data</span> <span class="sy0">=</span> <a href="http://www.php.net/file_get_contents"><span class="kw3">file_get_contents</span></a><span class="br0">&#40;</span><span class="re0">$filename</span><span class="br0">&#41;</span><span class="sy0">;</span><br />&#160;<br />        <span class="kw1">if</span><span class="br0">&#40;</span><span class="re0">$data</span> <span class="sy0">===</span> <span class="kw4">false</span><span class="br0">&#41;</span> <a href="http://www.php.net/die"><span class="kw3">die</span></a><span class="br0">&#40;</span><span class="st_h">'Unable to read file: '</span> <span class="sy0">.</span> <span class="re0">$filename</span><span class="br0">&#41;</span><span class="sy0">;</span><br />&#160;<br />        <a href="http://www.php.net/preg_match_all"><span class="kw3">preg_match_all</span></a><span class="br0">&#40;</span><span class="st_h">'/(\w+)/'</span><span class="sy0">,</span> <span class="re0">$data</span><span class="sy0">,</span> <span class="re0">$matches</span><span class="sy0">,</span> PREG_SET_ORDER<span class="br0">&#41;</span><span class="sy0">;</span><br />&#160;<br />        <span class="kw1">foreach</span><span class="br0">&#40;</span><span class="re0">$matches</span> <span class="kw1">as</span> <span class="re0">$match</span><span class="br0">&#41;</span><br />        <span class="br0">&#123;</span><br />            <span class="re0">$word</span> <span class="sy0">=</span> <a href="http://www.php.net/strtolower"><span class="kw3">strtolower</span></a><span class="br0">&#40;</span><span class="re0">$match</span><span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">;</span><br />&#160;<br />            <span class="kw1">if</span><span class="br0">&#40;</span><span class="sy0">!</span><a href="http://www.php.net/array_key_exists"><span class="kw3">array_key_exists</span></a><span class="br0">&#40;</span><span class="re0">$word</span><span class="sy0">,</span> <span class="re0">$invertedIndex</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="re0">$invertedIndex</span><span class="br0">&#91;</span><span class="re0">$word</span><span class="br0">&#93;</span> <span class="sy0">=</span> <span class="br0">&#91;</span><span class="br0">&#93;</span><span class="sy0">;</span><br />            <span class="kw1">if</span><span class="br0">&#40;</span><span class="sy0">!</span><a href="http://www.php.net/in_array"><span class="kw3">in_array</span></a><span class="br0">&#40;</span><span class="re0">$filename</span><span class="sy0">,</span> <span class="re0">$invertedIndex</span><span class="br0">&#91;</span><span class="re0">$word</span><span class="br0">&#93;</span><span class="sy0">,</span> <span class="kw4">true</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="re0">$invertedIndex</span><span class="br0">&#91;</span><span class="re0">$word</span><span class="br0">&#93;</span><span class="br0">&#91;</span><span class="br0">&#93;</span> <span class="sy0">=</span> <span class="re0">$filename</span><span class="sy0">;</span><br />        <span class="br0">&#125;</span><br />    <span class="br0">&#125;</span><br />&#160;<br />    <span class="kw1">return</span> <span class="re0">$invertedIndex</span><span class="sy0">;</span><br /><span class="br0">&#125;</span><br />&#160;<br /><span class="kw2">function</span> lookupWord<span class="br0">&#40;</span><span class="re0">$invertedIndex</span><span class="sy0">,</span> <span class="re0">$word</span><span class="br0">&#41;</span><br /><span class="br0">&#123;</span><br />    <span class="kw1">return</span> <a href="http://www.php.net/array_key_exists"><span class="kw3">array_key_exists</span></a><span class="br0">&#40;</span><span class="re0">$word</span><span class="sy0">,</span> <span class="re0">$invertedIndex</span><span class="br0">&#41;</span>&#160;? <span class="re0">$invertedIndex</span><span class="br0">&#91;</span><span class="re0">$word</span><span class="br0">&#93;</span> <span class="sy0">:</span> <span class="kw4">false</span><span class="sy0">;</span><br /><span class="br0">&#125;</span><br />&#160;<br /><span class="re0">$invertedIndex</span> <span class="sy0">=</span> buildInvertedIndex2<span class="br0">&#40;</span><span class="br0">&#91;</span><span class="st_h">'file1.txt'</span><span class="sy0">,</span> <span class="st_h">'file2.txt'</span><span class="sy0">,</span> <span class="st_h">'file3.txt'</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">;</span><br />&#160;<br /><span class="kw1">foreach</span><span class="br0">&#40;</span><span class="br0">&#91;</span><span class="st_h">'cat'</span><span class="sy0">,</span> <span class="st_h">'is'</span><span class="sy0">,</span> <span class="st_h">'banana'</span><span class="sy0">,</span> <span class="st_h">'it'</span><span class="br0">&#93;</span> <span class="kw1">as</span> <span class="re0">$word</span><span class="br0">&#41;</span><br /><span class="br0">&#123;</span><br />    <span class="re0">$matches</span> <span class="sy0">=</span> lookupWord<span class="br0">&#40;</span><span class="re0">$invertedIndex</span><span class="sy0">,</span> <span class="re0">$word</span><span class="br0">&#41;</span><span class="sy0">;</span><br />&#160;<br />    <span class="kw1">if</span><span class="br0">&#40;</span><span class="re0">$matches</span> <span class="sy0">!==</span> <span class="kw4">false</span><span class="br0">&#41;</span><br />    <span class="br0">&#123;</span><br />        <span class="kw1">echo</span> <span class="st0">&quot;Found the word <span class="es1">\&quot;</span><span class="es4">$word</span><span class="es1">\&quot;</span> in the following files: &quot;</span> <span class="sy0">.</span> <a href="http://www.php.net/implode"><span class="kw3">implode</span></a><span class="br0">&#40;</span><span class="st_h">', '</span><span class="sy0">,</span> <span class="re0">$matches</span><span class="br0">&#41;</span> <span class="sy0">.</span> <span class="st0">&quot;<span class="es1">\n</span>&quot;</span><span class="sy0">;</span><br />    <span class="br0">&#125;</span><br />    <span class="kw1">else</span><br />    <span class="br0">&#123;</span><br />        <span class="kw1">echo</span> <span class="st0">&quot;Unable to find the word <span class="es1">\&quot;</span><span class="es4">$word</span><span class="es1">\&quot;</span> in the index<span class="es1">\n</span>&quot;</span><span class="sy0">;</span><br />    <span class="br0">&#125;</span><br /><span class="br0">&#125;</span></pre>
<h2><span class="mw-headline" id="PicoLisp"><a href="/wiki/Category:PicoLisp" title="Category:PicoLisp">PicoLisp</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/mw/index.php?title=Inverted_index&amp;action=edit&amp;section=33" title="Edit section: PicoLisp">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Assuming three files "file1", "file2" and "file3":
</p>
<pre>$ cat file1
it is what it is

$ cat file2
what is it

$ cat file3
it is a banana</pre>
<p>we can read them into a binary tree in the global variable '*MyIndex'
</p>
<pre class="text highlighted_source">(off *MyIndex)<br />&#160;<br />(use Word<br />   (for File '(&quot;file1&quot; &quot;file2&quot; &quot;file3&quot;)<br />      (in File<br />         (while (skip)<br />            (if (idx '*MyIndex (setq Word (till &quot; ^I^J^M&quot; T)) T)<br />               (push1 (car @) File)<br />               (set Word (cons File)) ) ) ) ) )<br />&#160;<br />(de searchFor @<br />   (apply sect<br />      (extract<br />         '((Word) (val (car (idx '*MyIndex Word))))<br />         (rest) ) ) )</pre>
<p>Output:
</p>
<pre>: (searchFor &quot;what&quot; &quot;is&quot; &quot;it&quot;)
-&gt; (&quot;file2&quot; &quot;file1&quot;)

: (searchFor &quot;a&quot; &quot;banana&quot;)
-&gt; (&quot;file3&quot;)

: (searchFor &quot;it&quot; &quot;is&quot;)
-&gt; (&quot;file3&quot; &quot;file2&quot; &quot;file1&quot;)</pre>
<h2><span class="mw-headline" id="PowerShell"><a href="/wiki/Category:PowerShell" title="Category:PowerShell">PowerShell</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/mw/index.php?title=Inverted_index&amp;action=edit&amp;section=34" title="Edit section: PowerShell">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<div class="examplemeta workswith"><b>Works with</b>: <a href="/wiki/PowerShell" title="PowerShell" class="mw-redirect">PowerShell</a> version 2</div>
<pre class="powershell highlighted_source"><span class="kw3">function</span> Index<span class="kw4">-File</span> <span class="br0">&#40;</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#93;</span><span class="re0">$FileList</span> <span class="br0">&#41;</span><br />    <span class="br0">&#123;</span><br />    <span class="co1">#  Create index hashtable, as needed</span><br />    <span class="kw3">If</span> <span class="br0">&#40;</span> <span class="kw4">-not</span> <span class="re0">$Script</span>:WordIndex <span class="br0">&#41;</span> <span class="br0">&#123;</span> <span class="re0">$Script</span>:WordIndex <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#123;</span><span class="br0">&#125;</span> <span class="br0">&#125;</span><br />&#160;<br />    <span class="co1">#  For each file to be indexed...</span><br />    <span class="kw3">ForEach</span> <span class="br0">&#40;</span> <span class="re0">$File</span> <span class="kw3">in</span> <span class="re0">$FileList</span> <span class="br0">&#41;</span><br />        <span class="br0">&#123;</span><br />        <span class="co1">#  Find any previously existing entries for this file</span><br />        <span class="re0">$ExistingEntries</span> <span class="sy0">=</span> <span class="re0">$Script</span>:WordIndex.Keys <span class="sy0">|</span> <span class="kw3">Where</span> <span class="br0">&#123;</span> <span class="re0">$Script</span>:WordIndex<span class="br0">&#91;</span><a href="about:blank"><span class="kw6">$_</span></a><span class="br0">&#93;</span> <span class="kw4">-contains</span> <span class="re0">$File</span> <span class="br0">&#125;</span><br />&#160;<br />        <span class="co1">#  For any previously existing entries</span><br />        <span class="co1">#    Delete them (prior to reindexing the file)</span><br />        <span class="kw3">ForEach</span> <span class="br0">&#40;</span> <span class="re0">$Key</span> <span class="kw3">in</span> <span class="re0">$ExistingEntries</span> <span class="br0">&#41;</span><br />            <span class="br0">&#123;</span><br />            <span class="re0">$Script</span>:WordIndex<span class="br0">&#91;</span><span class="re0">$Key</span><span class="br0">&#93;</span> <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#40;</span> <span class="re0">$Script</span>:WordIndex<span class="br0">&#91;</span><span class="re0">$Key</span><span class="br0">&#93;</span> <span class="sy0">|</span> <span class="kw3">Where</span> <span class="br0">&#123;</span> <a href="about:blank"><span class="kw6">$_</span></a> <span class="kw4">-ne</span> <span class="re0">$File</span> <span class="br0">&#125;</span> <span class="br0">&#41;</span><br />            <span class="br0">&#125;</span><br />&#160;<br />        <span class="co1">#  Get the contents of the file, split on non-alphanumeric characters, and remove duplicates</span><br />        <span class="re0">$Words</span> <span class="sy0">=</span> <span class="br0">&#40;</span> <span class="kw1">Get-Content</span> <span class="re0">$File</span> <span class="br0">&#41;</span> <span class="sy0">-</span>split <span class="st0">'[^a-zA-Z\d]'</span> <span class="sy0">|</span> <span class="kw2">Sort</span> <span class="kw5">-Unique</span><br />&#160;<br />        <span class="co1">#  For each word in the file...</span><br />        <span class="kw3">ForEach</span> <span class="br0">&#40;</span> <span class="re0">$Word</span> <span class="kw3">in</span> <span class="re0">$Words</span> <span class="br0">&#41;</span><br />            <span class="br0">&#123;</span><br />            <span class="co1">#  If the entry for the word already exists...</span><br />            <span class="kw3">If</span> <span class="br0">&#40;</span> <span class="re0">$Script</span>:WordIndex<span class="br0">&#91;</span><span class="re0">$Word</span><span class="br0">&#93;</span> <span class="br0">&#41;</span><br />                <span class="br0">&#123;</span><br />                <span class="co1">#  Add the file name to the entry</span><br />                <span class="re0">$Script</span>:WordIndex<span class="br0">&#91;</span><span class="re0">$Word</span><span class="br0">&#93;</span> <span class="sy0">+=</span> <span class="re0">$File</span><br />                <span class="br0">&#125;</span><br />            <span class="kw3">Else</span><br />                <span class="br0">&#123;</span><br />                <span class="co1">#  Create a new entry</span><br />                <span class="re0">$Script</span>:WordIndex<span class="br0">&#91;</span><span class="re0">$Word</span><span class="br0">&#93;</span> <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#40;</span> <span class="re0">$File</span> <span class="br0">&#41;</span><br />                <span class="br0">&#125;</span><br />            <span class="br0">&#125;</span><br />        <span class="br0">&#125;</span><br />    <span class="br0">&#125;</span><br />&#160;<br /><span class="kw3">function</span> Find<span class="sy0">-</span>Word <span class="br0">&#40;</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span><span class="re0">$Word</span> <span class="br0">&#41;</span><br />    <span class="br0">&#123;</span><br />    <span class="kw3">return</span> <span class="re0">$WordIndex</span><span class="br0">&#91;</span><span class="re0">$Word</span><span class="br0">&#93;</span><br />    <span class="br0">&#125;</span></pre>
<pre class="powershell highlighted_source"><span class="co1">#  Populate test files</span><br /><span class="sy0">@</span><span class="st0">'<br />Files full of<br />various words.<br />'</span><span class="sy0">@</span> <span class="sy0">|</span> <span class="kw1">Out<span class="kw4">-File</span></span> <span class="kw5">-FilePath</span> C:\Test\File1.txt<br />&#160;<br /><span class="sy0">@</span><span class="st0">'<br />Create an index<br />of words.<br />'</span><span class="sy0">@</span> <span class="sy0">|</span> <span class="kw1">Out<span class="kw4">-File</span></span> <span class="kw5">-FilePath</span> C:\Test\File2.txt<br />&#160;<br /><span class="sy0">@</span><span class="st0">'<br />Use the index<br />to find the files.<br />'</span><span class="sy0">@</span> <span class="sy0">|</span> <span class="kw1">Out<span class="kw4">-File</span></span> <span class="kw5">-FilePath</span> C:\Test\File3.txt</pre>
<pre class="powershell highlighted_source"><span class="co1">#  Index files</span><br />Index<span class="kw4">-File</span> C:\Test\File1.txt<span class="sy0">,</span> C:\Test\File2.txt<span class="sy0">,</span> C:\Test\File3.txt</pre>
<p>Because PowerShell is a shell language, it is "a user interface to do a search". After running the script defining the functions and running a command to index the files, the user can simply run the search function at the PowerShell command prompt.
Alternatively, one could create a more complex custom UI or GUI if desired.
</p>
<pre class="powershell highlighted_source"><span class="co1">#  Query index</span><br />Find<span class="sy0">-</span>Word files</pre>
<div>
<dl><dt>Output:</div></dt></dl>
<pre>C:\Test\File1.txt
C:\Test\File3.txt</pre>
<h2><span class="mw-headline" id="Python"><a href="/wiki/Category:Python" title="Category:Python">Python</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/mw/index.php?title=Inverted_index&amp;action=edit&amp;section=35" title="Edit section: Python">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<h3><span class="mw-headline" id="Simple_inverted_index">Simple inverted index</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/mw/index.php?title=Inverted_index&amp;action=edit&amp;section=36" title="Edit section: Simple inverted index">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>First the simple inverted index from <a href="http://en.wikipedia.org/wiki/Inverted_index" class="extiw" title="wp:Inverted index">here</a> together with an implementation of a search for (multiple) terms from that index.
</p>
<pre class="python highlighted_source"><span class="st0">'''<br />This implements: http://en.wikipedia.org/wiki/Inverted_index of 28/07/10<br />'''</span><br />&#160;<br /><span class="kw1">from</span> <span class="kw3">pprint</span> <span class="kw1">import</span> <span class="kw3">pprint</span> <span class="kw1">as</span> pp<br /><span class="kw1">from</span> <span class="kw3">glob</span> <span class="kw1">import</span> <span class="kw3">glob</span><br /><span class="kw1">try</span>: <span class="kw2">reduce</span><br /><span class="kw1">except</span>: <span class="kw1">from</span> functools <span class="kw1">import</span> <span class="kw2">reduce</span><br /><span class="kw1">try</span>:    <span class="kw2">raw_input</span><br /><span class="kw1">except</span>: <span class="kw2">raw_input</span> <span class="sy0">=</span> <span class="kw2">input</span><br />&#160;<br />&#160;<br /><span class="kw1">def</span> parsetexts<span class="br0">&#40;</span>fileglob<span class="sy0">=</span><span class="st0">'InvertedIndex/T*.txt'</span><span class="br0">&#41;</span>:<br />    texts<span class="sy0">,</span> words <span class="sy0">=</span> <span class="br0">&#123;</span><span class="br0">&#125;</span><span class="sy0">,</span> <span class="kw2">set</span><span class="br0">&#40;</span><span class="br0">&#41;</span><br />    <span class="kw1">for</span> txtfile <span class="kw1">in</span> <span class="kw3">glob</span><span class="br0">&#40;</span>fileglob<span class="br0">&#41;</span>:<br />        <span class="kw1">with</span> <span class="kw2">open</span><span class="br0">&#40;</span>txtfile<span class="sy0">,</span> <span class="st0">'r'</span><span class="br0">&#41;</span> <span class="kw1">as</span> f:<br />            txt <span class="sy0">=</span> f.<span class="me1">read</span><span class="br0">&#40;</span><span class="br0">&#41;</span>.<span class="me1">split</span><span class="br0">&#40;</span><span class="br0">&#41;</span><br />            words |<span class="sy0">=</span> <span class="kw2">set</span><span class="br0">&#40;</span>txt<span class="br0">&#41;</span><br />            texts<span class="br0">&#91;</span>txtfile.<span class="me1">split</span><span class="br0">&#40;</span><span class="st0">'<span class="es0">\\</span>'</span><span class="br0">&#41;</span><span class="br0">&#91;</span>-<span class="nu0">1</span><span class="br0">&#93;</span><span class="br0">&#93;</span> <span class="sy0">=</span> txt<br />    <span class="kw1">return</span> texts<span class="sy0">,</span> words<br />&#160;<br /><span class="kw1">def</span> termsearch<span class="br0">&#40;</span>terms<span class="br0">&#41;</span>: <span class="co1"># Searches simple inverted index</span><br />    <span class="kw1">return</span> <span class="kw2">reduce</span><span class="br0">&#40;</span><span class="kw2">set</span>.<span class="me1">intersection</span><span class="sy0">,</span><br />                  <span class="br0">&#40;</span>invindex<span class="br0">&#91;</span>term<span class="br0">&#93;</span> <span class="kw1">for</span> term <span class="kw1">in</span> terms<span class="br0">&#41;</span><span class="sy0">,</span><br />                  <span class="kw2">set</span><span class="br0">&#40;</span>texts.<span class="me1">keys</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><br />&#160;<br />texts<span class="sy0">,</span> words <span class="sy0">=</span> parsetexts<span class="br0">&#40;</span><span class="br0">&#41;</span><br /><span class="kw1">print</span><span class="br0">&#40;</span><span class="st0">'<span class="es0">\n</span>Texts'</span><span class="br0">&#41;</span><br />pp<span class="br0">&#40;</span>texts<span class="br0">&#41;</span><br /><span class="kw1">print</span><span class="br0">&#40;</span><span class="st0">'<span class="es0">\n</span>Words'</span><span class="br0">&#41;</span><br />pp<span class="br0">&#40;</span><span class="kw2">sorted</span><span class="br0">&#40;</span>words<span class="br0">&#41;</span><span class="br0">&#41;</span><br />&#160;<br />invindex <span class="sy0">=</span> <span class="br0">&#123;</span>word:<span class="kw2">set</span><span class="br0">&#40;</span>txt<br />                        <span class="kw1">for</span> txt<span class="sy0">,</span> wrds <span class="kw1">in</span> texts.<span class="me1">items</span><span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="kw1">if</span> word <span class="kw1">in</span> wrds<span class="br0">&#41;</span><br />            <span class="kw1">for</span> word <span class="kw1">in</span> words<span class="br0">&#125;</span><br /><span class="kw1">print</span><span class="br0">&#40;</span><span class="st0">'<span class="es0">\n</span>Inverted Index'</span><span class="br0">&#41;</span><br />pp<span class="br0">&#40;</span><span class="br0">&#123;</span>k:<span class="kw2">sorted</span><span class="br0">&#40;</span>v<span class="br0">&#41;</span> <span class="kw1">for</span> k<span class="sy0">,</span>v <span class="kw1">in</span> invindex.<span class="me1">items</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#125;</span><span class="br0">&#41;</span><br />&#160;<br />terms <span class="sy0">=</span> <span class="br0">&#91;</span><span class="st0">&quot;what&quot;</span><span class="sy0">,</span> <span class="st0">&quot;is&quot;</span><span class="sy0">,</span> <span class="st0">&quot;it&quot;</span><span class="br0">&#93;</span><br /><span class="kw1">print</span><span class="br0">&#40;</span><span class="st0">'<span class="es0">\n</span>Term Search for: '</span> + <span class="kw3">repr</span><span class="br0">&#40;</span>terms<span class="br0">&#41;</span><span class="br0">&#41;</span><br />pp<span class="br0">&#40;</span><span class="kw2">sorted</span><span class="br0">&#40;</span>termsearch<span class="br0">&#40;</span>terms<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span></pre>
<p><b>Sample Output</b>
</p>
<pre>Texts
{'T0.txt': ['it', 'is', 'what', 'it', 'is'],
 'T1.txt': ['what', 'is', 'it'],
 'T2.txt': ['it', 'is', 'a', 'banana']}

Words
['a', 'banana', 'is', 'it', 'what']

Inverted Index
{'a': ['T2.txt'],
 'banana': ['T2.txt'],
 'is': ['T0.txt', 'T1.txt', 'T2.txt'],
 'it': ['T0.txt', 'T1.txt', 'T2.txt'],
 'what': ['T0.txt', 'T1.txt']}

Term Search for: ['what', 'is', 'it']
['T0.txt', 'T1.txt']</pre>
<h3><span class="mw-headline" id="Full_inverted_index">Full inverted index</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/mw/index.php?title=Inverted_index&amp;action=edit&amp;section=37" title="Edit section: Full inverted index">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>There is a re-write of the <code>termsearch</code> function to work off this type of index, as well as a new <code>phrasesearch</code> function
</p><p>The <code>phrasesearch</code> function will return multiple matches in a text, and goes on to show how this can be used to pick the text with most matches.
</p><p><small>It is assumed that the following code is added to the end of the code for the simple case above and so shares its file opening and parsing results</small>
</p>
<pre class="python highlighted_source"><span class="kw1">from</span> <span class="kw3">collections</span> <span class="kw1">import</span> Counter<br />&#160;<br />&#160;<br /><span class="kw1">def</span> termsearch<span class="br0">&#40;</span>terms<span class="br0">&#41;</span>: <span class="co1"># Searches full inverted index</span><br />    <span class="kw1">if</span> <span class="kw1">not</span> <span class="kw2">set</span><span class="br0">&#40;</span>terms<span class="br0">&#41;</span>.<span class="me1">issubset</span><span class="br0">&#40;</span>words<span class="br0">&#41;</span>:<br />        <span class="kw1">return</span> <span class="kw2">set</span><span class="br0">&#40;</span><span class="br0">&#41;</span><br />    <span class="kw1">return</span> <span class="kw2">reduce</span><span class="br0">&#40;</span><span class="kw2">set</span>.<span class="me1">intersection</span><span class="sy0">,</span><br />                  <span class="br0">&#40;</span><span class="kw2">set</span><span class="br0">&#40;</span>x<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span> <span class="kw1">for</span> x <span class="kw1">in</span> txtindx<span class="br0">&#41;</span><br />                   <span class="kw1">for</span> term<span class="sy0">,</span> txtindx <span class="kw1">in</span> finvindex.<span class="me1">items</span><span class="br0">&#40;</span><span class="br0">&#41;</span><br />                   <span class="kw1">if</span> term <span class="kw1">in</span> terms<span class="br0">&#41;</span><span class="sy0">,</span><br />                  <span class="kw2">set</span><span class="br0">&#40;</span>texts.<span class="me1">keys</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="br0">&#41;</span><br />&#160;<br /><span class="kw1">def</span> phrasesearch<span class="br0">&#40;</span>phrase<span class="br0">&#41;</span>:<br />    wordsinphrase <span class="sy0">=</span> phrase.<span class="me1">strip</span><span class="br0">&#40;</span><span class="br0">&#41;</span>.<span class="me1">strip</span><span class="br0">&#40;</span><span class="st0">'&quot;'</span><span class="br0">&#41;</span>.<span class="me1">split</span><span class="br0">&#40;</span><span class="br0">&#41;</span><br />    <span class="kw1">if</span> <span class="kw1">not</span> <span class="kw2">set</span><span class="br0">&#40;</span>wordsinphrase<span class="br0">&#41;</span>.<span class="me1">issubset</span><span class="br0">&#40;</span>words<span class="br0">&#41;</span>:<br />        <span class="kw1">return</span> <span class="kw2">set</span><span class="br0">&#40;</span><span class="br0">&#41;</span><br />    <span class="co1">#firstword, *otherwords = wordsinphrase # Only Python 3</span><br />    firstword<span class="sy0">,</span> otherwords <span class="sy0">=</span> wordsinphrase<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span><span class="sy0">,</span> wordsinphrase<span class="br0">&#91;</span><span class="nu0">1</span>:<span class="br0">&#93;</span><br />    found <span class="sy0">=</span> <span class="br0">&#91;</span><span class="br0">&#93;</span><br />    <span class="kw1">for</span> txt <span class="kw1">in</span> termsearch<span class="br0">&#40;</span>wordsinphrase<span class="br0">&#41;</span>:<br />        <span class="co1"># Possible text files</span><br />        <span class="kw1">for</span> firstindx <span class="kw1">in</span> <span class="br0">&#40;</span>indx <span class="kw1">for</span> t<span class="sy0">,</span>indx <span class="kw1">in</span> finvindex<span class="br0">&#91;</span>firstword<span class="br0">&#93;</span><br />                          <span class="kw1">if</span> t <span class="sy0">==</span> txt<span class="br0">&#41;</span>:<br />            <span class="co1"># Over all positions of the first word of the phrase in this txt</span><br />            <span class="kw1">if</span> <span class="kw2">all</span><span class="br0">&#40;</span> <span class="br0">&#40;</span>txt<span class="sy0">,</span> firstindx+<span class="nu0">1</span> + otherindx<span class="br0">&#41;</span> <span class="kw1">in</span> finvindex<span class="br0">&#91;</span>otherword<span class="br0">&#93;</span><br />                    <span class="kw1">for</span> otherindx<span class="sy0">,</span> otherword <span class="kw1">in</span> <span class="kw2">enumerate</span><span class="br0">&#40;</span>otherwords<span class="br0">&#41;</span> <span class="br0">&#41;</span>:<br />                found.<span class="me1">append</span><span class="br0">&#40;</span>txt<span class="br0">&#41;</span><br />    <span class="kw1">return</span> found<br />&#160;<br />&#160;<br />finvindex <span class="sy0">=</span> <span class="br0">&#123;</span>word:<span class="kw2">set</span><span class="br0">&#40;</span><span class="br0">&#40;</span>txt<span class="sy0">,</span> wrdindx<span class="br0">&#41;</span><br />                      <span class="kw1">for</span> txt<span class="sy0">,</span> wrds <span class="kw1">in</span> texts.<span class="me1">items</span><span class="br0">&#40;</span><span class="br0">&#41;</span><br />                      <span class="kw1">for</span> wrdindx <span class="kw1">in</span> <span class="br0">&#40;</span>i <span class="kw1">for</span> i<span class="sy0">,</span>w <span class="kw1">in</span> <span class="kw2">enumerate</span><span class="br0">&#40;</span>wrds<span class="br0">&#41;</span> <span class="kw1">if</span> word<span class="sy0">==</span>w<span class="br0">&#41;</span><br />                      <span class="kw1">if</span> word <span class="kw1">in</span> wrds<span class="br0">&#41;</span><br />             <span class="kw1">for</span> word <span class="kw1">in</span> words<span class="br0">&#125;</span><br /><span class="kw1">print</span><span class="br0">&#40;</span><span class="st0">'<span class="es0">\n</span>Full Inverted Index'</span><span class="br0">&#41;</span><br />pp<span class="br0">&#40;</span><span class="br0">&#123;</span>k:<span class="kw2">sorted</span><span class="br0">&#40;</span>v<span class="br0">&#41;</span> <span class="kw1">for</span> k<span class="sy0">,</span>v <span class="kw1">in</span> finvindex.<span class="me1">items</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#125;</span><span class="br0">&#41;</span><br />&#160;<br /><span class="kw1">print</span><span class="br0">&#40;</span><span class="st0">'<span class="es0">\n</span>Term Search on full inverted index for: '</span> + <span class="kw3">repr</span><span class="br0">&#40;</span>terms<span class="br0">&#41;</span><span class="br0">&#41;</span><br />pp<span class="br0">&#40;</span><span class="kw2">sorted</span><span class="br0">&#40;</span>termsearch<span class="br0">&#40;</span>terms<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><br />&#160;<br />phrase <span class="sy0">=</span> <span class="st0">'&quot;what is it&quot;'</span><br /><span class="kw1">print</span><span class="br0">&#40;</span><span class="st0">'<span class="es0">\n</span>Phrase Search for: '</span> + phrase<span class="br0">&#41;</span><br /><span class="kw1">print</span><span class="br0">&#40;</span>phrasesearch<span class="br0">&#40;</span>phrase<span class="br0">&#41;</span><span class="br0">&#41;</span><br />&#160;<br /><span class="co1"># Show multiple match capability</span><br />phrase <span class="sy0">=</span> <span class="st0">'&quot;it is&quot;'</span><br /><span class="kw1">print</span><span class="br0">&#40;</span><span class="st0">'<span class="es0">\n</span>Phrase Search for: '</span> + phrase<span class="br0">&#41;</span><br />ans <span class="sy0">=</span> phrasesearch<span class="br0">&#40;</span>phrase<span class="br0">&#41;</span><br /><span class="kw1">print</span><span class="br0">&#40;</span>ans<span class="br0">&#41;</span><br />ans <span class="sy0">=</span> Counter<span class="br0">&#40;</span>ans<span class="br0">&#41;</span><br /><span class="kw1">print</span><span class="br0">&#40;</span><span class="st0">'  The phrase is found most commonly in text: '</span> + <span class="kw3">repr</span><span class="br0">&#40;</span>ans.<span class="me1">most_common</span><span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span><span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span><span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="br0">&#41;</span></pre>
<p><b>Sample Output</b>
</p>
<pre>Full Inverted Index
{'a': [('T2.txt', 2)],
 'banana': [('T2.txt', 3)],
 'is': [('T0.txt', 1), ('T0.txt', 4), ('T1.txt', 1), ('T2.txt', 1)],
 'it': [('T0.txt', 0), ('T0.txt', 3), ('T1.txt', 2), ('T2.txt', 0)],
 'what': [('T0.txt', 2), ('T1.txt', 0)]}

Term Search on full inverted index for: ['what', 'is', 'it']
['T0.txt', 'T1.txt']

Phrase Search for: &quot;what is it&quot;
['T1.txt']

Phrase Search for: &quot;it is&quot;
['T0.txt', 'T0.txt', 'T2.txt']
  The phrase is found most commonly in text: 'T0.txt'</pre>
<h2><span class="mw-headline" id="Racket"><a href="/wiki/Category:Racket" title="Category:Racket">Racket</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/mw/index.php?title=Inverted_index&amp;action=edit&amp;section=38" title="Edit section: Racket">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<pre class="text highlighted_source">&#160;<br />#!/usr/bin/env racket<br />#lang racket<br />(command-line<br /> #:args (term . files)<br /> (define rindex (make-hasheq))<br /> (for ([file files])<br />   (call-with-input-file file<br />     (?(in) (let loop ()<br />              (define w (regexp-match #px&quot;\\w+&quot; in))<br />              (when w<br />                (let* ([w (bytes-&gt;string/utf-8 (car w))]<br />                       [w (string-&gt;symbol (string-foldcase w))]<br />                       [r (hash-ref rindex w '())])<br />                  (unless (member file r) (hash-set! rindex w (cons file r)))<br />                  (loop)))))))<br /> (define res<br />   (for/list ([w (regexp-match* #px&quot;\\w+&quot; term)])<br />     (list-&gt;set (hash-ref rindex (string-&gt;symbol (string-foldcase w)) '()))))<br /> (define all (set-&gt;list (apply set-intersect res)))<br /> (if (null? all)<br />   (printf &quot;No matching files.\n&quot;)<br />   (printf &quot;Terms found at: ~a.\n&quot; (string-join all &quot;, &quot;))))<br />&#160;</pre>
<div>
<dl><dt>Output:</div></dt></dl>
<pre>$ echo &quot;It is what it is.&quot; &gt; F1
$ echo &quot;What is it?&quot; &gt; F2
$ echo &quot;It is a banana.&quot; &gt; F3
$ ./search.rkt &quot;what&quot; F?
Terms found at: F1, F2.
$ ./search.rkt &quot;a&quot; F?
Terms found at: F3.
$ ./search.rkt &quot;what a&quot; F?
No matching files.
$ ./search.rkt &quot;what is it&quot; F?
Terms found at: F1, F2.
</pre>
<h2><span class="mw-headline" id="REXX"><a href="/wiki/Category:REXX" title="Category:REXX">REXX</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/mw/index.php?title=Inverted_index&amp;action=edit&amp;section=39" title="Edit section: REXX">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Note: In this algorithm, word indices start at 1.
</p><p>Note: &#160; the Burma Shave signs were created from 1930 ??? 1951 &#160; and were common among the rural byways of America.
</p><p>To see more about Burma Shave signs, see the Wikipedia entry: &#160; <a rel="nofollow" class="external text" href="http://en.wikipedia.org/wiki/Burma-Shave">Burma Shave signs.</a>
</p>
<pre class="rexx highlighted_source"><span class="coMULTI">/*REXX program illustrates building a simple inverted index  and  a method of word find.*/</span><br />@<span class="sy0">.</span>=                                              <span class="coMULTI">/*a dictionary of words   (so far).    */</span><br />!=                                               <span class="coMULTI">/*a list of found words   (so far).    */</span><br /><span class="kw1">call</span> invertI <span class="nu0">0</span>, <span class="st0">'BURMA0.TXT'</span>                     <span class="coMULTI">/*read the file:  BURMA0.TXT        */</span><br /><span class="kw1">call</span> invertI <span class="nu0">1</span>, <span class="st0">'BURMA1.TXT'</span>                     <span class="coMULTI">/*  &quot;   &quot;    &quot;    BURMA1.TXT        */</span><br /><span class="kw1">call</span> invertI <span class="nu0">2</span>, <span class="st0">'BURMA2.TXT'</span>                     <span class="coMULTI">/*  &quot;   &quot;    &quot;    BURMA2.TXT        */</span><br /><span class="kw1">call</span> invertI <span class="nu0">3</span>, <span class="st0">'BURMA3.TXT'</span>                     <span class="coMULTI">/*  &quot;   &quot;    &quot;    BURMA3.TXT        */</span><br /><span class="kw1">call</span> invertI <span class="nu0">4</span>, <span class="st0">'BURMA4.TXT'</span>                     <span class="coMULTI">/*  &quot;   &quot;    &quot;    BURMA4.TXT        */</span><br /><span class="kw1">call</span> invertI <span class="nu0">5</span>, <span class="st0">'BURMA5.TXT'</span>                     <span class="coMULTI">/*  &quot;   &quot;    &quot;    BURMA5.TXT        */</span><br /><span class="kw1">call</span> invertI <span class="nu0">6</span>, <span class="st0">'BURMA6.TXT'</span>                     <span class="coMULTI">/*  &quot;   &quot;    &quot;    BURMA6.TXT        */</span><br /><span class="kw1">call</span> invertI <span class="nu0">7</span>, <span class="st0">'BURMA7.TXT'</span>                     <span class="coMULTI">/*  &quot;   &quot;    &quot;    BURMA7.TXT        */</span><br /><span class="kw1">call</span> invertI <span class="nu0">8</span>, <span class="st0">'BURMA8.TXT'</span>                     <span class="coMULTI">/*  &quot;   &quot;    &quot;    BURMA8.TXT        */</span><br /><span class="kw1">call</span> invertI <span class="nu0">9</span>, <span class="st0">'BURMA9.TXT'</span>                     <span class="coMULTI">/*  &quot;   &quot;    &quot;    BURMA9.TXT        */</span><br /><span class="kw1">call</span> findAword  <span class="st0">&quot;huz&quot;</span>                            <span class="coMULTI">/*find a word.                         */</span><br /><span class="kw1">call</span> findAword  <span class="st0">&quot;60&quot;</span>                             <span class="coMULTI">/*find another word.                   */</span><br /><span class="kw1">call</span> findAword  <span class="st0">&quot;don't&quot;</span>                          <span class="coMULTI">/*and find another word.               */</span><br /><span class="kw1">call</span> findAword  <span class="st0">&quot;burma-shave&quot;</span>                    <span class="coMULTI">/*and find yet another word.           */</span><br /><span class="kw1">exit</span>                                             <span class="coMULTI">/*stick a fork in it,  we're all done. */</span><br /><span class="coMULTI">/*??????????????????????????????????????????????????????????????????????????????????????*/</span><br />findAword: <span class="kw1">procedure</span> <span class="kw1">expose</span> @<span class="sy0">.</span>;  <span class="kw1">arg</span> x           <span class="coMULTI">/*get an uppercase version of the X arg*/</span><br />           <span class="kw1">parse</span> <span class="kw1">arg</span> ox                          <span class="coMULTI">/*get original (as-is)  value of X arg.*/</span><br />           <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="bce381fc">[email&#160;protected]</a><span class="sy0">.</span>x;    oxo=<span class="st0">'???'</span>ox<span class="st0">&quot;???&quot;</span><br />           <span class="kw1">if</span> _==<span class="st0">''</span>  <span class="kw3">then</span> <span class="kw1">do</span><br />                          <span class="kw1">say</span> <span class="st0">'word'</span>   oxo   <span class="st0">&quot;not found.&quot;</span><br />                          <span class="kw1">return</span> <span class="nu0">0</span><br />                          <span class="kw3">end</span><br />           <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="4f100f">[email&#160;protected]</a>=_                                  <span class="coMULTI">/*save _ text, pass it back to invoker.*/</span><br />           <span class="kw1">say</span> <span class="st0">'word'</span>  oxo  <span class="st0">&quot;found in:&quot;</span><br />                          <span class="kw1">do</span>  <span class="kw2">until</span> _==<span class="st0">''</span>;    <span class="kw1">parse</span> <span class="kw2">var</span>   _   f  w  _<br />                          <span class="kw1">say</span> <span class="st0">'       file='</span>f   <span class="st0">&quot;  word=&quot;</span>w<br />                          <span class="kw3">end</span>   <span class="coMULTI">/*until  */</span><br />           <span class="kw1">return</span> <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="98c7d8">[email&#160;protected]</a><br /><span class="coMULTI">/*??????????????????????????????????????????????????????????????????????????????????????*/</span><br />invertI:   <span class="kw1">procedure</span> <span class="kw1">expose</span> @<span class="sy0">.</span>&#160;!; <span class="kw1">parse</span> <span class="kw1">arg</span> #,fn <span class="coMULTI">/*the file number and the filename.    */</span><br />           <span class="kw1">call</span> <span class="kw6">lineout</span> fn                       <span class="coMULTI">/*close the file,  just in case.    */</span><br />           w=<span class="nu0">0</span>                                   <span class="coMULTI">/*the number of words found  (so far). */</span><br />               <span class="kw1">do</span>  <span class="kw2">while</span> <span class="kw6">lines</span><span class="br0">&#40;</span>fn<span class="br0">&#41;</span><span class="sy0">\</span>==<span class="nu0">0</span>           <span class="coMULTI">/* [?]   process the entire file.      */</span><br />               _=<span class="kw6">space</span><span class="br0">&#40;</span> <span class="kw2">linein</span><span class="br0">&#40;</span>fn<span class="br0">&#41;</span> <span class="br0">&#41;</span>             <span class="coMULTI">/*read a line, elide superfluous blanks*/</span><br />               <span class="kw1">if</span> _==<span class="st0">''</span>  <span class="kw3">then</span> <span class="kw1">iterate</span>            <span class="coMULTI">/*if a blank record,  then ignore it.  */</span><br />               <span class="kw1">say</span> <span class="st0">'file'</span> #<span class="st0">&quot;, record:&quot;</span> _         <span class="coMULTI">/*display the record ??? terminal.     */</span><br />&#160;<br />                  <span class="kw1">do</span>  <span class="kw2">until</span> _==<span class="st0">''</span>                <span class="coMULTI">/*pick off words from record until done*/</span><br />                  <span class="kw1">parse</span> <span class="kw2">upper</span> <span class="kw2">var</span>   _  &#160;?  _     <span class="coMULTI">/*pick off a word  (it's in uppercase).*/</span><br />                 &#160;?=stripper<span class="br0">&#40;</span>?<span class="br0">&#41;</span>                  <span class="coMULTI">/*strip any trailing punctuation.      */</span><br />                  <span class="kw1">if</span>&#160;?=<span class="st0">''</span>  <span class="kw3">then</span> <span class="kw1">iterate</span>          <span class="coMULTI">/*is the word now all blank (or null)? */</span><br />                  w=w+<span class="nu0">1</span>                          <span class="coMULTI">/*bump the word counter (index).       */</span><br />                  @<span class="sy0">.</span><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="f4cbc9b4">[email&#160;protected]</a><span class="sy0">.</span>?  #  w                  <span class="coMULTI">/*append the new word to a list.       */</span><br />                  <span class="kw1">if</span> <span class="kw6">wordpos</span><span class="br0">&#40;</span>?,!<span class="br0">&#41;</span>==<span class="nu0">0</span>  <span class="kw3">then</span>&#160;!=!&#160;? <span class="coMULTI">/*add it to the list of words found.   */</span><br />                  <span class="kw3">end</span>   <span class="coMULTI">/*until  */</span><br />               <span class="kw3">end</span>      <span class="coMULTI">/*while  */</span><br />           <span class="kw1">say</span>;     <span class="kw1">call</span> <span class="kw6">lineout</span> fn              <span class="coMULTI">/*close the file, just to be neat&amp;safe.*/</span><br />           <span class="kw1">return</span> w                              <span class="coMULTI">/*return the index of word in record.  */</span><br /><span class="coMULTI">/*??????????????????????????????????????????????????????????????????????????????????????*/</span><br />stripper:  <span class="kw1">procedure</span>;  <span class="kw1">parse</span> <span class="kw1">arg</span> q               <span class="coMULTI">/*remove punctuation at the end of word*/</span><br />           @punctuation= <span class="st0">'.,:;??!??'</span>;        <span class="kw1">do</span> j=<span class="nu0">1</span>  <span class="kw2">for</span> <span class="kw6">length</span><span class="br0">&#40;</span>@punctuation<span class="br0">&#41;</span><br />                                              q=<span class="kw6">strip</span><span class="br0">&#40;</span>q, <span class="st0">'T'</span>, <span class="kw6">substr</span><span class="br0">&#40;</span>@punctuation, j, <span class="nu0">1</span><span class="br0">&#41;</span> <span class="br0">&#41;</span><br />                                              <span class="kw3">end</span>   <span class="coMULTI">/*j*/</span><br />           <span class="kw1">return</span> q</pre>
<p><b>output</b>
</p>
<pre style="height:50ex">file 0, record: Rip a fender
file 0, record: Off your Car
file 0, record: Send it in
file 0, record: For a half-pound jar
file 0, record: Burma-Shave

file 1, record: A peach
file 1, record: Looks good
file 1, record: With lots of fuzz
file 1, record: Man's no peach
file 1, record: And never was
file 1, record: Burma-Shave

file 2, record: Does your husband
file 2, record: Misbehave
file 2, record: Grunt and grumble
file 2, record: Rant and rave&#160;?
file 2, record: Shoot the brute some
file 2, record: Burma-Shave

file 3, record: Don't take a curve
file 3, record: At 60 per
file 3, record: We hate to lose
file 3, record: A customer
file 3, record: Burma-Shave

file 4, record: Every shaver
file 4, record: Now can snore
file 4, record: Six more minutes
file 4, record: Than before
file 4, record: By using
file 4, record: Burma-Shave

file 5, record: He played
file 5, record: a sax
file 5, record: Had no B.O.
file 5, record: But his whiskers scratched
file 5, record: So she let him go
file 5, record: Burma-Shave

file 6, record: Henry the Eighth
file 6, record: Prince of Friskers
file 6, record: Lost five wives
file 6, record: But kept his whiskers
file 6, record: Burma-Shave

file 7, record: Listen birds
file 7, record: These signs cost
file 7, record: Money
file 7, record: So roost a while
file 7, record: But don't get funny
file 7, record: Burma-Shave

file 8, record: My man
file 8, record: Won't shave
file 8, record: Sez Hazel Huz
file 8, record: But I should worry
file 8, record: Dora's does
file 8, record: Burma-Shave

file 9, record: Past
file 9, record: Schoolhouses
file 9, record: Take it slow
file 9, record: Let the little
file 9, record: Shavers grow
file 9, record: Burma-Shave

word ???huz??? found in:
       file=8   word=7
word ???60??? found in:
       file=3   word=6
word ???don't??? found in:
       file=3   word=1
       file=7   word=12
word ???burma-shave??? found in:
       file=0   word=14
       file=1   word=15
       file=2   word=15
       file=3   word=14
       file=4   word=13
       file=5   word=17
       file=6   word=14
       file=7   word=15
       file=8   word=14
       file=9   word=11
</pre>
<h2><span class="mw-headline" id="Ruby"><a href="/wiki/Category:Ruby" title="Category:Ruby">Ruby</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/mw/index.php?title=Inverted_index&amp;action=edit&amp;section=40" title="Edit section: Ruby">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>I broke this into two parts, storing the index as a file on disk to better represent how this might actually be used in practice. The indexmerge part will create or update the index data file with any files given on the command line, and then indexsearch will use the data file to search for any terms listed on the command line. The example is based on <a rel="nofollow" class="external free" href="http://en.wikipedia.org/wiki/Inverted_index">http://en.wikipedia.org/wiki/Inverted_index</a> of 2010/09/10.
</p><p><b>indexmerge.rb</b>
</p>
<pre class="ruby highlighted_source"><span class="kw1">if</span> <span class="kw4">File</span>.<span class="me1">exist</span>? <span class="st0">&quot;index.dat&quot;</span><br />  <span class="re1">@data</span> = <span class="kw4">Marshal</span>.<span class="kw3">load</span> <span class="kw3">open</span><span class="br0">&#40;</span><span class="st0">&quot;index.dat&quot;</span><span class="br0">&#41;</span><br /><span class="kw1">else</span><br />  <span class="re1">@data</span> = <span class="br0">&#123;</span><span class="br0">&#125;</span><br /><span class="kw1">end</span><br />&#160;<br /><span class="co1"># Let's give the string class the ability to tokenize itsself into lowercase</span><br /><span class="co1"># words with no punctuation.</span><br /><span class="kw1">class</span> <span class="kw3">String</span><br />  <span class="kw1">def</span> index_sanitize<br />    <span class="kw2">self</span>.<span class="kw3">split</span>.<span class="me1">collect</span> <span class="kw1">do</span> <span class="sy0">|</span>token<span class="sy0">|</span><br />      token.<span class="me1">downcase</span>.<span class="kw3">gsub</span><span class="br0">&#40;</span><span class="sy0">/</span>\W<span class="sy0">/</span>, <span class="st0">''</span><span class="br0">&#41;</span><br />    <span class="kw1">end</span><br />  <span class="kw1">end</span><br /><span class="kw1">end</span><br />&#160;<br /><span class="co1"># Just implementing a simple inverted index here.</span><br />ARGV.<span class="me1">each</span> <span class="kw1">do</span> <span class="sy0">|</span>filename<span class="sy0">|</span><br />  <span class="kw3">open</span> filename <span class="kw1">do</span> <span class="sy0">|</span>file<span class="sy0">|</span><br />    file.<span class="me1">read</span>.<span class="me1">index_sanitize</span>.<span class="me1">each</span> <span class="kw1">do</span> <span class="sy0">|</span>word<span class="sy0">|</span><br />      <span class="re1">@data</span><span class="br0">&#91;</span>word<span class="br0">&#93;</span> <span class="sy0">||</span>= <span class="br0">&#91;</span><span class="br0">&#93;</span><br />      <span class="re1">@data</span><span class="br0">&#91;</span>word<span class="br0">&#93;</span> <span class="sy0">&lt;&lt;</span> filename <span class="kw1">unless</span> <span class="re1">@data</span><span class="br0">&#91;</span>word<span class="br0">&#93;</span>.<span class="kw1">include</span>? filename<br />    <span class="kw1">end</span><br />  <span class="kw1">end</span><br /><span class="kw1">end</span><br />&#160;<br /><span class="kw3">open</span><span class="br0">&#40;</span><span class="st0">&quot;index.dat&quot;</span>, <span class="st0">&quot;w&quot;</span><span class="br0">&#41;</span> <span class="kw1">do</span> <span class="sy0">|</span>index<span class="sy0">|</span><br />  index.<span class="me1">write</span> <span class="kw4">Marshal</span>.<span class="me1">dump</span><span class="br0">&#40;</span>@data<span class="br0">&#41;</span><br /><span class="kw1">end</span></pre>
<p><b>indexsearch.rb</b>
</p>
<pre class="ruby highlighted_source"><span class="kw1">if</span> <span class="kw4">File</span>.<span class="me1">exist</span>? <span class="st0">&quot;index.dat&quot;</span><br />  <span class="re1">@data</span> = <span class="kw4">Marshal</span>.<span class="kw3">load</span> <span class="kw3">open</span><span class="br0">&#40;</span><span class="st0">&quot;index.dat&quot;</span><span class="br0">&#41;</span><br /><span class="kw1">else</span><br />  <span class="kw3">raise</span> <span class="st0">&quot;The index data file could not be located.&quot;</span><br /><span class="kw1">end</span><br />&#160;<br /><span class="kw1">class</span> <span class="kw3">String</span><br />  <span class="kw1">def</span> index_sanitize<br />    <span class="kw2">self</span>.<span class="kw3">split</span>.<span class="me1">collect</span> <span class="kw1">do</span> <span class="sy0">|</span>token<span class="sy0">|</span><br />      token.<span class="me1">downcase</span>.<span class="kw3">gsub</span><span class="br0">&#40;</span><span class="sy0">/</span>\W<span class="sy0">/</span>, <span class="st0">''</span><span class="br0">&#41;</span><br />    <span class="kw1">end</span><br />  <span class="kw1">end</span><br /><span class="kw1">end</span><br />&#160;<br /><span class="co1"># Take anything passed in on the command line in any form and break it</span><br /><span class="co1"># down the same way we did when making the index.</span><br />ARGV.<span class="me1">join</span><span class="br0">&#40;</span><span class="st0">' '</span><span class="br0">&#41;</span>.<span class="me1">index_sanitize</span>.<span class="me1">each</span> <span class="kw1">do</span> <span class="sy0">|</span>word<span class="sy0">|</span><br />  <span class="re1">@result</span> <span class="sy0">||</span>= <span class="re1">@data</span><span class="br0">&#91;</span>word<span class="br0">&#93;</span><br />  <span class="re1">@result</span> <span class="sy0">&amp;</span>= <span class="re1">@data</span><span class="br0">&#91;</span>word<span class="br0">&#93;</span><br /><span class="kw1">end</span><br />&#160;<br /><span class="kw3">p</span> <span class="re1">@result</span></pre>
<p><b>Output</b>
</p>
<pre>&gt; ./indexmerge.rb file1
&gt; ./indexmerge.rb file2 file3
&gt; ./indexsearch.rb what is it
[&quot;file1&quot;, &quot;file2&quot;]
&gt; ./indexsearch.rb &quot;a banana&quot;
[&quot;file3&quot;]
&gt; ./indexsearch.rb It iS\!
[&quot;file1&quot;, &quot;file2&quot;, &quot;file3&quot;]</pre>
<h2><span class="mw-headline" id="Scala"><a href="/wiki/Category:Scala" title="Category:Scala">Scala</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/mw/index.php?title=Inverted_index&amp;action=edit&amp;section=41" title="Edit section: Scala">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<pre class="scala highlighted_source"><a href="http://scala-lang.org"><span class="kw1">object</span></a> InvertedIndex <a href="http://scala-lang.org"><span class="kw1">extends</span></a> App <span class="br0">&#123;</span><br />  <a href="http://scala-lang.org"><span class="kw1">import</span></a> java.<span class="me1">io</span>.<span class="me1">File</span><br />&#160;<br />  <span class="co1">// indexer</span><br />  <a href="http://scala-lang.org"><span class="kw1">val</span></a> WORD <span class="sy0">=</span> raw<span class="st0">&quot;(<span class="es0">\w</span>+)&quot;</span>.<span class="me1">r</span><br />  <a href="http://scala-lang.org"><span class="kw1">def</span></a> parse<span class="br0">&#40;</span>s<span class="sy0">:</span> String<span class="br0">&#41;</span> <span class="sy0">=</span> WORD.<span class="me1">findAllIn</span><span class="br0">&#40;</span>s<span class="br0">&#41;</span>.<span class="me1">map</span><span class="br0">&#40;</span><span class="sy0">_</span>.<span class="me1">toString</span>.<span class="me1">toLowerCase</span><span class="br0">&#41;</span><br />  <a href="http://scala-lang.org"><span class="kw1">def</span></a> invertedIndex<span class="br0">&#40;</span>files<span class="sy0">:</span> Seq<span class="br0">&#91;</span>File<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">:</span> Map<span class="br0">&#91;</span>String,Set<span class="br0">&#91;</span>File<span class="br0">&#93;</span><span class="br0">&#93;</span> <span class="sy0">=</span> <span class="br0">&#123;</span><br />    <a href="http://scala-lang.org"><span class="kw1">var</span></a> i <span class="sy0">=</span> Map<span class="br0">&#91;</span>String,Set<span class="br0">&#91;</span>File<span class="br0">&#93;</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="br0">&#41;</span> withDefaultValue Set.<span class="me1">empty</span><br />    files.<span class="me1">foreach</span><span class="br0">&#123;</span>f <span class="sy0">=&gt;</span> scala.<span class="me1">io</span>.<span class="me1">Source</span>.<span class="me1">fromFile</span><span class="br0">&#40;</span>f<span class="br0">&#41;</span>.<span class="me1">getLines</span> flatMap parse foreach<br />      <span class="br0">&#40;</span>w <span class="sy0">=&gt;</span> i <span class="sy0">=</span> i + <span class="br0">&#40;</span>w -<span class="sy0">&gt;</span> <span class="br0">&#40;</span>i<span class="br0">&#40;</span>w<span class="br0">&#41;</span> + f<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#125;</span><br />    i<br />  <span class="br0">&#125;</span><br />&#160;<br />  <span class="co1">// user interface</span><br />  args <a href="http://scala-lang.org"><span class="kw1">match</span></a> <span class="br0">&#123;</span><br />    <a href="http://scala-lang.org"><span class="kw1">case</span></a> <span class="sy0">_</span> <a href="http://scala-lang.org"><span class="kw1">if</span></a> args.<span class="me1">length</span> <span class="sy0">&lt;</span> <span class="nu0">2</span> <span class="sy0">=&gt;</span> println<span class="br0">&#40;</span><span class="st0">&quot;Usage: InvertedIndex ALLSEARCHWORDS FILENAME...&quot;</span><span class="br0">&#41;</span><br />    <a href="http://scala-lang.org"><span class="kw1">case</span></a> Array<span class="br0">&#40;</span>searchwords, filenames <span class="sy0">@</span> <span class="sy0">_*</span><span class="br0">&#41;</span> <span class="sy0">=&gt;</span><br />      <a href="http://scala-lang.org"><span class="kw1">val</span></a> queries <span class="sy0">=</span> parse<span class="br0">&#40;</span>searchwords<span class="br0">&#41;</span>.<span class="me1">toList</span><br />      <a href="http://scala-lang.org"><span class="kw1">val</span></a> files <span class="sy0">=</span> filenames.<span class="me1">map</span><span class="br0">&#40;</span><a href="http://scala-lang.org"><span class="kw1">new</span></a> File<span class="br0">&#40;</span><span class="sy0">_</span><span class="br0">&#41;</span><span class="br0">&#41;</span>.<span class="me1">filter</span><span class="br0">&#123;</span>f <span class="sy0">=&gt;</span> <a href="http://scala-lang.org"><span class="kw1">if</span></a> <span class="br0">&#40;</span><span class="sy0">!</span>f.<span class="me1">exists</span><span class="br0">&#41;</span> println<span class="br0">&#40;</span>s<span class="st0">&quot;Ignoring $f&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span> f.<span class="me1">exists</span><span class="br0">&#125;</span><br />      <span class="br0">&#40;</span>queries, files<span class="br0">&#41;</span> <a href="http://scala-lang.org"><span class="kw1">match</span></a> <span class="br0">&#123;</span><br />        <a href="http://scala-lang.org"><span class="kw1">case</span></a> <span class="br0">&#40;</span>q, <span class="sy0">_</span><span class="br0">&#41;</span> <a href="http://scala-lang.org"><span class="kw1">if</span></a> q.<span class="me1">isEmpty</span> <span class="sy0">=&gt;</span> println<span class="br0">&#40;</span><span class="st0">&quot;Missing search words&quot;</span><span class="br0">&#41;</span><br />        <a href="http://scala-lang.org"><span class="kw1">case</span></a> <span class="br0">&#40;</span><span class="sy0">_</span>, f<span class="br0">&#41;</span> <a href="http://scala-lang.org"><span class="kw1">if</span></a> f.<span class="me1">isEmpty</span> <span class="sy0">=&gt;</span> println<span class="br0">&#40;</span><span class="st0">&quot;Missing extant files&quot;</span><span class="br0">&#41;</span><br />        <a href="http://scala-lang.org"><span class="kw1">case</span></a> <span class="sy0">_</span> <span class="sy0">=&gt;</span> <a href="http://scala-lang.org"><span class="kw1">val</span></a> index <span class="sy0">=</span> invertedIndex<span class="br0">&#40;</span>files<span class="br0">&#41;</span><br />          println<span class="br0">&#40;</span>s<span class="st0">&quot;&quot;</span><span class="st0">&quot;Searching for ${queries map (&quot;</span>\<span class="st0">&quot;&quot;</span>+<span class="sy0">_</span>+<span class="st0">&quot;<span class="es1">\&quot;</span>&quot;</span><span class="br0">&#41;</span> mkString <span class="st0">&quot; and &quot;</span><span class="br0">&#125;</span> in $<span class="br0">&#123;</span>files.<span class="me1">size</span><span class="br0">&#125;</span> files<span class="sy0">:</span><span class="st0">&quot;&quot;</span><span class="st0">&quot;)<br />          queries.map(index).foldLeft(files.toSet)(_ intersect _) match {<br />            case m if m.isEmpty =&gt; println(&quot;</span>No matching files<span class="st0">&quot;)<br />            case m =&gt; println(m mkString &quot;</span>\n<span class="st0">&quot;)<br />          }<br />      }<br />  }<br />}</span></pre>
<div>
<dl><dt>Output:</div></dt></dl>
<pre>&gt; InvertedIndex &quot;the&quot; file1.txt file2.txt file3.txt
Searching for &quot;the&quot; in 3 files:
data/file1.txt
data/file2.txt
data/file3.txt

&gt; InvertedIndex &quot;the cat sat&quot; file1.txt file2.txt file3.txt
Searching for &quot;the&quot; and &quot;cat&quot; and &quot;sat&quot; in 3 files:
file1.txt
file2.txt

&gt; InvertedIndex fox file1.txt file2.txt file3.txt
Searching for &quot;fox&quot; in 3 files:
file3.txt

&gt; InvertedIndex abc file1.txt file2.txt file3.txt
Searching for &quot;abc&quot; in 3 files:
No matching files</pre>
<h2><span class="mw-headline" id="Tcl"><a href="/wiki/Category:Tcl" title="Category:Tcl">Tcl</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/mw/index.php?title=Inverted_index&amp;action=edit&amp;section=42" title="Edit section: Tcl">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<pre class="tcl highlighted_source"><span class="kw2">package</span> require Tcl <span class="nu0">8.5</span><br /><span class="kw1">proc</span> wordsInString str <span class="br0">&#123;</span><br />    <span class="co1"># We define &quot;words&quot; to be &quot;maximal sequences of 'word' characters&quot;.</span><br />    <span class="co1"># The other possible definition is to use 'non-space' characters.</span><br />    <span class="kw2">regexp</span> -all -inline <span class="br0">&#123;</span>\w+<span class="br0">&#125;</span> <span class="re0">$str</span><br /><span class="br0">&#125;</span><br />&#160;<br /><span class="co1"># Adds a document to the index. The index is a map from words to a map</span><br /><span class="co1"># from filenames to lists of word locations.</span><br /><span class="kw1">proc</span> addDocumentToIndex <span class="br0">&#123;</span><span class="kw3">filename</span><span class="br0">&#125;</span> <span class="br0">&#123;</span><br />    <span class="kw1">global</span> index<br />    <span class="kw1">set</span> f <span class="br0">&#91;</span><span class="kw2">open</span> <span class="re0">$filename</span><span class="br0">&#93;</span><br />    <span class="kw1">set</span> data <span class="br0">&#91;</span><span class="kw2">read</span> <span class="re0">$f</span><span class="br0">&#93;</span><br />    <span class="kw2">close</span> <span class="re0">$f</span><br />&#160;<br />    <span class="kw1">set</span> i <span class="nu0">0</span><br />    array <span class="kw1">set</span> localidx <span class="br0">&#123;</span><span class="br0">&#125;</span><br />    <span class="kw1">foreach</span> word <span class="br0">&#91;</span>wordsInString <span class="re0">$data</span><span class="br0">&#93;</span> <span class="br0">&#123;</span><br />	<span class="kw2">lappend</span> localidx<span class="br0">&#40;</span><span class="re0">$word</span><span class="br0">&#41;</span> <span class="re0">$i</span><br />	<span class="kw2">incr</span> i<br />    <span class="br0">&#125;</span><br />&#160;<br />    <span class="co1"># Transcribe into global index</span><br />    <span class="kw1">foreach</span> <span class="br0">&#123;</span>word places<span class="br0">&#125;</span> <span class="br0">&#91;</span>array get localidx<span class="br0">&#93;</span> <span class="br0">&#123;</span><br />	dict <span class="kw1">set</span> index<span class="br0">&#40;</span><span class="re0">$word</span><span class="br0">&#41;</span> <span class="re0">$filename</span> <span class="re0">$places</span><br />    <span class="br0">&#125;</span><br /><span class="br0">&#125;</span><br />&#160;<br /><span class="co1"># How to use the index to find files containing a word</span><br /><span class="kw1">proc</span> findFilesForWord <span class="br0">&#123;</span>word<span class="br0">&#125;</span> <span class="br0">&#123;</span><br />    <span class="kw1">global</span> index<br />    <span class="kw1">if</span> <span class="br0">&#123;</span><span class="br0">&#91;</span><span class="kw2">info</span> exists index<span class="br0">&#40;</span><span class="re0">$word</span><span class="br0">&#41;</span><span class="br0">&#93;</span><span class="br0">&#125;</span> <span class="br0">&#123;</span><br />	<span class="kw1">return</span> <span class="br0">&#91;</span>dict keys <span class="re0">$index</span><span class="br0">&#40;</span><span class="re0">$word</span><span class="br0">&#41;</span><span class="br0">&#93;</span><br />    <span class="br0">&#125;</span><br /><span class="br0">&#125;</span><br /><span class="co1"># How to use the index to find files containing all words from a list.</span><br /><span class="co1"># Note that this does not use the locations within the file.</span><br /><span class="kw1">proc</span> findFilesWithAllWords <span class="br0">&#123;</span>words<span class="br0">&#125;</span> <span class="br0">&#123;</span><br />    <span class="kw1">set</span> files <span class="br0">&#91;</span>findFilesForWord <span class="br0">&#91;</span><span class="kw2">lindex</span> <span class="re0">$words</span> <span class="nu0">0</span><span class="br0">&#93;</span><span class="br0">&#93;</span><br />    <span class="kw1">foreach</span> w <span class="br0">&#91;</span><span class="kw2">lrange</span> <span class="re0">$words</span> <span class="nu0">1</span> end<span class="br0">&#93;</span> <span class="br0">&#123;</span><br />	<span class="kw1">set</span> wf <span class="br0">&#91;</span>findFilesForWord <span class="re0">$w</span><span class="br0">&#93;</span><br />	<span class="kw1">set</span> newfiles <span class="br0">&#123;</span><span class="br0">&#125;</span><br />	<span class="kw1">foreach</span> f <span class="re0">$files</span> <span class="br0">&#123;</span><br />	    <span class="kw1">if</span> <span class="br0">&#123;</span><span class="re0">$f</span> <span class="kw1">in</span> <span class="re0">$wf</span><span class="br0">&#125;</span> <span class="br0">&#123;</span><span class="kw2">lappend</span> newfiles <span class="re0">$f</span><span class="br0">&#125;</span><br />	<span class="br0">&#125;</span><br />	<span class="kw1">set</span> files <span class="re0">$newfiles</span><br />    <span class="br0">&#125;</span><br />    <span class="kw1">return</span> <span class="re0">$files</span><br /><span class="br0">&#125;</span><br />&#160;<br /><span class="co1"># How to use the index to find a sequence of words in a file.</span><br /><span class="kw1">proc</span> findFilesWithWordSequence <span class="br0">&#123;</span>words<span class="br0">&#125;</span> <span class="br0">&#123;</span><br />    <span class="kw1">global</span> index<br />    <span class="kw1">set</span> files <span class="br0">&#123;</span><span class="br0">&#125;</span><br />    <span class="kw1">foreach</span> w <span class="re0">$words</span> <span class="br0">&#123;</span><br />	<span class="kw1">if</span> <span class="br0">&#123;</span><span class="sy0">!</span><span class="br0">&#91;</span><span class="kw2">info</span> exist index<span class="br0">&#40;</span><span class="re0">$w</span><span class="br0">&#41;</span><span class="br0">&#93;</span><span class="br0">&#125;</span> <span class="br0">&#123;</span><br />	    <span class="kw1">return</span><br />	<span class="br0">&#125;</span><br />    <span class="br0">&#125;</span><br />    dict <span class="kw1">for</span> <span class="br0">&#123;</span><span class="kw2">file</span> places<span class="br0">&#125;</span> <span class="re0">$index</span><span class="br0">&#40;</span><span class="br0">&#91;</span><span class="kw2">lindex</span> <span class="re0">$words</span> <span class="nu0">0</span><span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><br />	<span class="kw1">if</span> <span class="br0">&#123;</span><span class="re0">$file</span> <span class="kw1">in</span> <span class="re0">$files</span><span class="br0">&#125;</span> <span class="kw1">continue</span><br />	<span class="kw1">foreach</span> start <span class="re0">$places</span> <span class="br0">&#123;</span><br />	    <span class="kw1">set</span> gotStart <span class="nu0">1</span><br />	    <span class="kw1">foreach</span> w <span class="br0">&#91;</span><span class="kw2">lrange</span> <span class="re0">$words</span> <span class="nu0">1</span> end<span class="br0">&#93;</span> <span class="br0">&#123;</span><br />		<span class="kw2">incr</span> start<br />		<span class="kw1">set</span> gotNext <span class="nu0">0</span><br />		<span class="kw1">foreach</span> <span class="br0">&#123;</span>f ps<span class="br0">&#125;</span> <span class="re0">$index</span><span class="br0">&#40;</span><span class="re0">$w</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><br />		    <span class="kw1">if</span> <span class="br0">&#123;</span><span class="re0">$f</span> ne <span class="re0">$file</span><span class="br0">&#125;</span> <span class="kw1">continue</span><br />		    <span class="kw1">foreach</span> p <span class="re0">$ps</span> <span class="br0">&#123;</span><br />			<span class="kw1">if</span> <span class="br0">&#123;</span><span class="re0">$p</span> == <span class="re0">$start</span><span class="br0">&#125;</span> <span class="br0">&#123;</span><br />			    <span class="kw1">set</span> gotNext <span class="nu0">1</span><br />			    <span class="kw1">break</span><br />			<span class="br0">&#125;</span><br />		    <span class="br0">&#125;</span><br />		    <span class="kw1">if</span> <span class="br0">&#123;</span><span class="re0">$gotNext</span><span class="br0">&#125;</span> <span class="kw1">break</span><br />		<span class="br0">&#125;</span><br />		<span class="kw1">if</span> <span class="br0">&#123;</span><span class="sy0">!</span><span class="re0">$gotNext</span><span class="br0">&#125;</span> <span class="br0">&#123;</span><br />		    <span class="kw1">set</span> gotStart <span class="nu0">0</span><br />		    <span class="kw1">break</span><br />		<span class="br0">&#125;</span><br />	    <span class="br0">&#125;</span><br />	    <span class="kw1">if</span> <span class="br0">&#123;</span><span class="re0">$gotStart</span><span class="br0">&#125;</span> <span class="br0">&#123;</span><br />		<span class="kw2">lappend</span> files <span class="re0">$file</span><br />		<span class="kw1">break</span><br />	    <span class="br0">&#125;</span><br />	<span class="br0">&#125;</span><br />    <span class="br0">&#125;</span><br />    <span class="kw1">return</span> <span class="re0">$files</span><br /><span class="br0">&#125;</span></pre>
<p>For the GUI:
</p>
<pre class="tcl highlighted_source"><span class="kw2">package</span> require Tk<br />pack <span class="br0">&#91;</span>labelframe .files -text Files<span class="br0">&#93;</span> -side left -fill y<br />pack <span class="br0">&#91;</span>listbox .files.<span class="kw2">list</span> -listvariable files<span class="br0">&#93;</span><br />pack <span class="br0">&#91;</span>button .files.add -command AddFile -text <span class="st0">&quot;Add File to Index&quot;</span><span class="br0">&#93;</span><br />pack <span class="br0">&#91;</span>labelframe .found -text Found<span class="br0">&#93;</span> -side right -fill y<br />pack <span class="br0">&#91;</span>listbox .found.<span class="kw2">list</span> -listvariable found<span class="br0">&#93;</span> -fill x<br />pack <span class="br0">&#91;</span>entry .found.entry -textvariable terms<span class="br0">&#93;</span> -fill x<br />pack <span class="br0">&#91;</span>button .found.findAll -command FindAll \<br />	-text <span class="st0">&quot;Find File with All&quot;</span><span class="br0">&#93;</span> -side left<br />pack <span class="br0">&#91;</span>button .found.findSeq -command FindSeq \<br />	-text <span class="st0">&quot;Find File with Sequence&quot;</span><span class="br0">&#93;</span> -side right<br />&#160;<br /><span class="co1"># The actions invoked by various GUI buttons</span><br /><span class="kw1">proc</span> AddFile <span class="br0">&#123;</span><span class="br0">&#125;</span> <span class="br0">&#123;</span><br />    <span class="kw1">global</span> files<br />    <span class="kw1">set</span> f <span class="br0">&#91;</span>tk_getOpenFile<span class="br0">&#93;</span><br />    <span class="kw1">if</span> <span class="br0">&#123;</span><span class="re0">$f</span> ne <span class="st0">&quot;&quot;</span><span class="br0">&#125;</span> <span class="br0">&#123;</span><br />	addDocumentToIndex <span class="re0">$f</span><br />	<span class="kw2">lappend</span> files <span class="re0">$f</span><br />    <span class="br0">&#125;</span><br /><span class="br0">&#125;</span><br /><span class="kw1">proc</span> FindAll <span class="br0">&#123;</span><span class="br0">&#125;</span> <span class="br0">&#123;</span><br />    <span class="kw1">global</span> found terms<br />    <span class="kw1">set</span> words <span class="br0">&#91;</span>wordsInString <span class="re0">$terms</span><span class="br0">&#93;</span><br />    <span class="kw1">set</span> fs <span class="br0">&#91;</span>findFilesWithAllWords <span class="re0">$words</span><span class="br0">&#93;</span><br />    <span class="kw2">lappend</span> found <span class="st0">&quot;Searching for files with all $terms&quot;</span> <span class="br0">&#123;</span><span class="sy0">*</span><span class="br0">&#125;</span><span class="re0">$fs</span> \<br />	<span class="st0">&quot;---------------------&quot;</span><br /><span class="br0">&#125;</span><br /><span class="kw1">proc</span> FindSeq <span class="br0">&#123;</span><span class="br0">&#125;</span> <span class="br0">&#123;</span><br />    <span class="kw1">global</span> found terms<br />    <span class="kw1">set</span> words <span class="br0">&#91;</span>wordsInString <span class="re0">$terms</span><span class="br0">&#93;</span><br />    <span class="kw1">set</span> fs <span class="br0">&#91;</span>findFilesWithWordSequence <span class="re0">$words</span><span class="br0">&#93;</span><br />    <span class="kw2">lappend</span> found <span class="st0">&quot;Searching for files with <span class="es0">\&quot;</span>$terms<span class="es0">\&quot;</span>&quot;</span> <span class="br0">&#123;</span><span class="sy0">*</span><span class="br0">&#125;</span><span class="re0">$fs</span> \<br />	<span class="st0">&quot;---------------------&quot;</span><br /><span class="br0">&#125;</span></pre>
<h2><span class="mw-headline" id="TUSCRIPT"><a href="/wiki/Category:TUSCRIPT" title="Category:TUSCRIPT">TUSCRIPT</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/mw/index.php?title=Inverted_index&amp;action=edit&amp;section=43" title="Edit section: TUSCRIPT">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<pre class="text highlighted_source">&#160;<br />$$ MODE TUSCRIPT<br />&#160;<br />files=&quot;file1'file2'file3&quot;<br />LOOP file=files<br />ERROR/STOP CREATE (file,seq-o,-std-)<br />ENDLOOP<br />&#160;<br />content1=&quot;it is what it is&quot;<br />content2=&quot;what is it&quot;<br />content3=&quot;it is a banana&quot;<br />&#160;<br />FILE/ERASE &quot;file1&quot; = content1<br />FILE/ERASE &quot;file2&quot; = content2<br />FILE/ERASE &quot;file3&quot; = content3<br />&#160;<br />ASK &quot;search for&quot;: search=&quot;&quot;<br />IF (search==&quot;&quot;) STOP<br />&#160;<br />BUILD R_TABLE/USER/AND search = *<br />DATA  {search}<br />&#160;<br />LOOP/CLEAR file=files<br /> ACCESS q: READ/RECORDS $file s.z/u,content,count<br />  LOOP<br />  COUNT/NEXT/EXIT q (-; search;-;-)<br />  IF (count!=0) files=APPEND (files,&quot; &quot;,file)<br />  ENDLOOP<br /> ENDACCESs q<br />ENDLOOP<br />PRINT &quot;-&gt; &quot;,files<br />&#160;</pre>
<p>Output:
</p>
<pre>search for &gt;what is it
-&gt; file1 file2

search for &gt;banana
-&gt; file3

search for &gt;it is
-&gt; file1 file2 file3
</pre>
<h2><span class="mw-headline" id="UNIX_Shell"><a href="/wiki/Category:UNIX_Shell" title="Category:UNIX Shell">UNIX Shell</a></span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/mw/index.php?title=Inverted_index&amp;action=edit&amp;section=44" title="Edit section: UNIX Shell">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<h3><span class="mw-headline" id="Associative_array">Associative array</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/mw/index.php?title=Inverted_index&amp;action=edit&amp;section=45" title="Edit section: Associative array">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<div class="examplemeta workswith"><b>Works with</b>: <a href="/wiki/Ksh93" title="Ksh93">ksh93</a></div>
<pre class="bash highlighted_source"><span class="co0">#!/bin/ksh</span><br />&#160;<br /><span class="kw3">typeset</span> <span class="re5">-A</span> INDEX<br />&#160;<br /><span class="kw1">function</span> index <span class="br0">&#123;</span><br />  <span class="kw3">typeset</span> <span class="re2">num</span>=<span class="nu0">0</span><br />  <span class="kw1">for</span> <span class="kw2">file</span> <span class="kw1">in</span> <span class="st0">&quot;<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="331773">[email&#160;protected]</a>&quot;</span>; <span class="kw1">do</span><br />    <span class="kw2">tr</span> <span class="re5">-s</span> <span class="st_h">'[:punct:]'</span> <span class="st_h">' '</span> <span class="sy0">&lt;</span> <span class="st0">&quot;<span class="es2">$file</span>&quot;</span> <span class="sy0">|</span> <span class="kw1">while</span> <span class="kw2">read</span> line; <span class="kw1">do</span><br />      <span class="kw1">for</span> token <span class="kw1">in</span> <span class="re1">$line</span>; <span class="kw1">do</span><br />        INDEX<span class="br0">&#91;</span><span class="re1">$token</span><span class="br0">&#93;</span><span class="br0">&#91;</span><span class="re1">$num</span><span class="br0">&#93;</span>=<span class="re1">$file</span><br />      <span class="kw1">done</span><br />    <span class="kw1">done</span><br />  <span class="br0">&#40;</span><span class="br0">&#40;</span>++num<span class="br0">&#41;</span><span class="br0">&#41;</span><br />  <span class="kw1">done</span><br /><span class="br0">&#125;</span><br />&#160;<br /><span class="kw1">function</span> search <span class="br0">&#123;</span><br />  <span class="kw1">for</span> token <span class="kw1">in</span> <span class="st0">&quot;<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="123652">[email&#160;protected]</a>&quot;</span>; <span class="kw1">do</span><br />    <span class="kw1">for</span> <span class="kw2">file</span> <span class="kw1">in</span> <span class="st0">&quot;<span class="es3">${INDEX[$token][@]}</span>&quot;</span>; <span class="kw1">do</span><br />      <span class="kw3">echo</span> <span class="st0">&quot;<span class="es2">$file</span>&quot;</span><br />    <span class="kw1">done</span><br />  <span class="kw1">done</span> <span class="sy0">|</span> <span class="kw2">sort</span> <span class="sy0">|</span> <span class="kw2">uniq</span> <span class="re5">-c</span> <span class="sy0">|</span> <span class="kw1">while</span> <span class="kw2">read</span> count <span class="kw2">file</span>; <span class="kw1">do</span><br />    <span class="br0">&#40;</span><span class="br0">&#40;</span> count == <span class="re4">$#</span> <span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="sy0">&amp;&amp;</span> <span class="kw3">echo</span> <span class="re1">$file</span><br />  <span class="kw1">done</span><br /><span class="br0">&#125;</span></pre>
<p>Example use:
</p>
<pre class="text highlighted_source">index *.txt<br />search hello world<br />&#160;</pre>
<h3><span class="mw-headline" id="Directory_on_filesystem">Directory on filesystem</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/mw/index.php?title=Inverted_index&amp;action=edit&amp;section=46" title="Edit section: Directory on filesystem">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<table class="messagebox" style="text-align: center; background-color: #ffffd8; clear: both;">
<tr>
<td> This example is <b>under development</b>. It was marked thus on 20/January/2011. Please help complete the example.
</td></tr></table>
<p>The following is an attempt (not yet complete) to port the above script to <a href="/wiki/Pdksh" title="Pdksh" class="mw-redirect">pdksh</a>, and perhaps other Bourne-compatible shells.
</p>
<ul><li> TODO Fill in "search.sh".</li>
<li> Add note about slowness.</li></ul>
<pre class="bash highlighted_source"><span class="co0">#!/bin/sh</span><br /><span class="co0"># index.sh - create an inverted index</span><br />&#160;<br /><span class="kw3">unset</span> IFS<br />: <span class="co1">${INDEX:=index}</span><br />&#160;<br /><span class="co0"># Prohibit '\n' in filenames (because '\n' is</span><br /><span class="co0"># the record separator for $INDEX/all.tab).</span><br /><span class="kw1">for</span> <span class="kw2">file</span> <span class="kw1">in</span> <span class="st0">&quot;<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="e7c3a7">[email&#160;protected]</a>&quot;</span>; <span class="kw1">do</span><br />	<span class="co0"># Use printf(1), not echo, because &quot;$file&quot; might start with</span><br />	<span class="co0"># a hyphen and become an option to echo.</span><br />	<span class="kw3">test</span> <span class="nu0">0</span> <span class="re5">-eq</span> $<span class="br0">&#40;</span><span class="kw3">printf</span> <span class="sy0">%</span>s <span class="st0">&quot;<span class="es2">$file</span>&quot;</span> <span class="sy0">|</span> <span class="kw2">wc</span> -l<span class="br0">&#41;</span> <span class="sy0">||</span> <span class="br0">&#123;</span><br />		<span class="kw3">printf</span> <span class="st_h">'%s\n'</span> <span class="st0">&quot;<span class="es2">$file</span>: newline in filename&quot;</span> <span class="sy0">&gt;&amp;</span><span class="nu0">2</span><br />		<span class="kw3">exit</span> <span class="nu0">1</span><br />	<span class="br0">&#125;</span><br /><span class="kw1">done</span><br />&#160;<br /><span class="co0"># Make a new directory for the index, or else</span><br /><span class="co0"># exit with the error message from mkdir(1).</span><br /><span class="kw2">mkdir</span> <span class="st0">&quot;<span class="es2">$INDEX</span>&quot;</span> <span class="sy0">||</span> <span class="kw3">exit</span> <span class="re4">$?</span><br />&#160;<br /><span class="re2">fi</span>=<span class="nu0">1</span><br /><span class="kw1">for</span> <span class="kw2">file</span> <span class="kw1">in</span> <span class="st0">&quot;<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="0c284c">[email&#160;protected]</a>&quot;</span>; <span class="kw1">do</span><br />	<span class="kw3">printf</span> <span class="sy0">%</span>s <span class="st0">&quot;Indexing <span class="es2">$file</span>.&quot;</span> <span class="sy0">&gt;&amp;</span><span class="nu0">2</span><br />&#160;<br />	<span class="co0"># all.tab maps $fi =&gt; $file</span><br />	<span class="kw3">echo</span> <span class="st0">&quot;<span class="es2">$fi</span> <span class="es2">$file</span>&quot;</span> <span class="sy0">&gt;&gt;</span> <span class="st0">&quot;<span class="es2">$INDEX</span>/all.tab&quot;</span><br />&#160;<br />	<span class="co0"># Use punctuation ([:punct:]) and whitespace (IFS)</span><br />	<span class="co0"># to split tokens.</span><br />	<span class="re2">ti</span>=<span class="nu0">1</span><br />	<span class="kw2">tr</span> <span class="re5">-s</span> <span class="st_h">'[:punct:]'</span> <span class="st_h">' '</span> <span class="sy0">&lt;</span> <span class="st0">&quot;<span class="es2">$file</span>&quot;</span> <span class="sy0">|</span> <span class="kw1">while</span> <span class="kw2">read</span> line; <span class="kw1">do</span><br />		<span class="kw1">for</span> token <span class="kw1">in</span> <span class="re1">$line</span>; <span class="kw1">do</span><br />			<span class="co0"># Index token by position ($fi, $ti). Ignore</span><br />			<span class="co0"># error from mkdir(1) if directory exists.</span><br />			<span class="kw2">mkdir</span> <span class="st0">&quot;<span class="es2">$INDEX</span>/<span class="es2">$token</span>&quot;</span> <span class="nu0">2</span><span class="sy0">&gt;/</span>dev<span class="sy0">/</span>null<br />			<span class="kw3">echo</span> <span class="re1">$ti</span> <span class="sy0">&gt;&gt;</span> <span class="st0">&quot;<span class="es2">$INDEX</span>/<span class="es2">$token</span>/<span class="es2">$fi</span>&quot;</span><br />			: $<span class="br0">&#40;</span><span class="br0">&#40;</span>ti += <span class="nu0">1</span><span class="br0">&#41;</span><span class="br0">&#41;</span><br />&#160;<br />			<span class="co0"># Show progress. Print a dot per 1000 tokens.</span><br />			<span class="kw1">case</span> <span class="st0">&quot;<span class="es2">$ti</span>&quot;</span> <span class="kw1">in</span><br />			<span class="sy0">*</span>000<span class="br0">&#41;</span>	<span class="kw3">printf</span> .<br />			<span class="kw1">esac</span><br />		<span class="kw1">done</span><br />	<span class="kw1">done</span><br />&#160;<br />	<span class="kw3">echo</span> <span class="sy0">&gt;&amp;</span><span class="nu0">2</span><br />	: $<span class="br0">&#40;</span><span class="br0">&#40;</span><span class="kw1">fi</span> += <span class="nu0">1</span><span class="br0">&#41;</span><span class="br0">&#41;</span><br /><span class="kw1">done</span></pre>
<pre class="bash highlighted_source"><span class="co0">#!/bin/sh</span><br /><span class="co0"># search.sh - search an inverted index</span><br />&#160;<br /><span class="kw3">unset</span> IFS<br />: <span class="co1">${INDEX:=index}</span><br />&#160;<br /><span class="re2">want</span>=sequence<br /><span class="kw1">while</span> <span class="kw3">getopts</span> aos name; <span class="kw1">do</span><br />	<span class="kw1">case</span> <span class="st0">&quot;<span class="es2">$name</span>&quot;</span> <span class="kw1">in</span><br />	a<span class="br0">&#41;</span>	<span class="re2">want</span>=all<span class="sy0">;;</span><br />	o<span class="br0">&#41;</span>	<span class="re2">want</span>=one<span class="sy0">;;</span><br />	s<span class="br0">&#41;</span>	<span class="re2">want</span>=sequence<span class="sy0">;;</span><br />	<span class="sy0">*</span><span class="br0">&#41;</span>	<span class="kw3">exit</span> <span class="nu0">2</span><span class="sy0">;;</span><br />	<span class="kw1">esac</span><br /><span class="kw1">done</span><br /><span class="kw3">shift</span> $<span class="br0">&#40;</span><span class="br0">&#40;</span>OPTIND - <span class="nu0">1</span><span class="br0">&#41;</span><span class="br0">&#41;</span><br />&#160;<br />all<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><br />	<span class="kw3">echo</span> <span class="st0">&quot;TODO&quot;</span><br />	<span class="kw3">exit</span> <span class="nu0">2</span><br /><span class="br0">&#125;</span><br />&#160;<br />one<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><br />	<span class="kw3">echo</span> <span class="st0">&quot;TODO&quot;</span><br />	<span class="kw3">exit</span> <span class="nu0">2</span><br /><span class="br0">&#125;</span><br />&#160;<br />sequence<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><br />	<span class="kw3">echo</span> <span class="st0">&quot;TODO&quot;</span><br />	<span class="kw3">exit</span> <span class="nu0">2</span><br /><span class="br0">&#125;</span><br />&#160;<br /><span class="re1">$want</span> <span class="st0">&quot;<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="9abeda">[email&#160;protected]</a>&quot;</span></pre>



</div><div class="printfooter">
Retrieved from "<a dir="ltr" href="https://rosettacode.org/mw/index.php?title=Inverted_index&amp;oldid=255072">https://rosettacode.org/mw/index.php?title=Inverted_index&amp;oldid=255072</a>"</div>
</div>

<div id='catlinks' class='catlinks'><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="/wiki/Special:Categories" title="Special:Categories">Categories</a>: <ul><li><a href="/wiki/Category:Programming_Tasks" title="Category:Programming Tasks">Programming Tasks</a></li><li><a href="/wiki/Category:Classic_CS_problems_and_programs" title="Category:Classic CS problems and programs">Classic CS problems and programs</a></li><li><a href="/mw/index.php?title=Category:Search&amp;action=edit&amp;redlink=1" class="new" title="Category:Search (page does not exist)">Search</a></li><li><a href="/wiki/Category:Ada" title="Category:Ada">Ada</a></li><li><a href="/wiki/Category:AutoHotkey" title="Category:AutoHotkey">AutoHotkey</a></li><li><a href="/wiki/Category:BBC_BASIC" title="Category:BBC BASIC">BBC BASIC</a></li><li><a href="/wiki/Category:C" title="Category:C">C</a></li><li><a href="/wiki/Category:C%2B%2B" title="Category:C++">C++</a></li><li><a href="/wiki/Category:C_sharp" title="Category:C sharp">C sharp</a></li><li><a href="/wiki/Category:Clojure" title="Category:Clojure">Clojure</a></li><li><a href="/wiki/Category:CoffeeScript" title="Category:CoffeeScript">CoffeeScript</a></li><li><a href="/wiki/Category:Common_Lisp" title="Category:Common Lisp">Common Lisp</a></li><li><a href="/wiki/Category:D" title="Category:D">D</a></li><li><a href="/wiki/Category:EchoLisp" title="Category:EchoLisp">EchoLisp</a></li><li><a href="/wiki/Category:Erlang" title="Category:Erlang">Erlang</a></li><li><a href="/wiki/Category:Factor" title="Category:Factor">Factor</a></li><li><a href="/wiki/Category:F_Sharp" title="Category:F Sharp">F Sharp</a></li><li><a href="/wiki/Category:Go" title="Category:Go">Go</a></li><li><a href="/wiki/Category:Haskell" title="Category:Haskell">Haskell</a></li><li><a href="/wiki/Category:Icon" title="Category:Icon">Icon</a></li><li><a href="/wiki/Category:Unicon" title="Category:Unicon">Unicon</a></li><li><a href="/wiki/Category:J" title="Category:J">J</a></li><li><a href="/wiki/Category:Java" title="Category:Java">Java</a></li><li><a href="/wiki/Category:Jq" title="Category:Jq">Jq</a></li><li><a href="/wiki/Category:Kotlin" title="Category:Kotlin">Kotlin</a></li><li><a href="/wiki/Category:OCaml" title="Category:OCaml">OCaml</a></li><li><a href="/wiki/Category:Perl" title="Category:Perl">Perl</a></li><li><a href="/wiki/Category:Perl_6" title="Category:Perl 6">Perl 6</a></li><li><a href="/wiki/Category:Phix" title="Category:Phix">Phix</a></li><li><a href="/wiki/Category:PHP" title="Category:PHP">PHP</a></li><li><a href="/wiki/Category:PicoLisp" title="Category:PicoLisp">PicoLisp</a></li><li><a href="/wiki/Category:PowerShell" title="Category:PowerShell">PowerShell</a></li><li><a href="/wiki/Category:Python" title="Category:Python">Python</a></li><li><a href="/wiki/Category:Racket" title="Category:Racket">Racket</a></li><li><a href="/wiki/Category:REXX" title="Category:REXX">REXX</a></li><li><a href="/wiki/Category:Ruby" title="Category:Ruby">Ruby</a></li><li><a href="/wiki/Category:Scala" title="Category:Scala">Scala</a></li><li><a href="/wiki/Category:Tcl" title="Category:Tcl">Tcl</a></li><li><a href="/wiki/Category:TUSCRIPT" title="Category:TUSCRIPT">TUSCRIPT</a></li><li><a href="/wiki/Category:UNIX_Shell" title="Category:UNIX Shell">UNIX Shell</a></li><li><a href="/wiki/Category:UNIX_Shell_examples_needing_attention" title="Category:UNIX Shell examples needing attention">UNIX Shell examples needing attention</a></li><li><a href="/wiki/Category:Examples_needing_attention" title="Category:Examples needing attention">Examples needing attention</a></li></ul></div></div>
</div>
</div>
</div>
<div class="row">
<div class="col-lg-12">

<nav class="navbar navbar-default p-tb " id="p-tb">
<ul class="nav navbar-nav small">
<li id="t-whatlinkshere"><a href="/wiki/Special:WhatLinksHere/Inverted_index" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
<li id="t-recentchangeslinked"><a href="/wiki/Special:RecentChangesLinked/Inverted_index" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
<li id="t-specialpages"><a href="/wiki/Special:SpecialPages" title="A list of all special pages [q]" accesskey="q">Special pages</a></li>
<li id="t-print"><a href="/mw/index.php?title=Inverted_index&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>
<li id="t-permalink"><a href="/mw/index.php?title=Inverted_index&amp;oldid=255072" title="Permanent link to this revision of the page">Permanent link</a></li>
<li id="t-info"><a href="/mw/index.php?title=Inverted_index&amp;action=info" title="More information about this page">Page information</a></li>
<li id="t-smwbrowselink"><a href="/wiki/Special:Browse/Inverted_index" rel="smw-browse">Browse properties</a></li>
</ul>
</nav>
</div>
</div>
<div class="row">
<div class="col-lg-12">

<ul class="footer-info list-unstyled small" id="footer-info">

<li> This page was last modified on 27 October 2017, at 12:53.</li>
<li>Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/licenses/fdl-1.2.html">GNU Free Documentation License 1.2</a> unless otherwise noted.</li>
</ul>
</div>
</div>
<div class="row">
<div class="col-lg-6">

<ul class="list-inline footer-places " id="footer-places">
<li><small><a href="/wiki/Rosetta_Code:Privacy_policy" title="Rosetta Code:Privacy policy">Privacy policy</a></small></li>
<li><small><a href="/wiki/Rosetta_Code:About" title="Rosetta Code:About">About Rosetta Code</a></small></li>
<li><small><a href="/wiki/Rosetta_Code:General_disclaimer" title="Rosetta Code:General disclaimer">Disclaimers</a></small></li>
</ul>
</div>
<div class="col-lg-6">

<ul class="list-inline pull-right footer-icons " id="footer-icons">

<li><a href="http://www.gnu.org/licenses/fdl-1.2.html"><img src="/mw/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.2" width="88" height="31" /></a></li>

<li><a href="//www.mediawiki.org/"><img src="/mw/resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/mw/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /mw/resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" /></a></li>
<li><a href="https://www.semantic-mediawiki.org/wiki/Semantic_MediaWiki"><img src="/mw/extensions/SemanticMediaWiki/includes/../resources/images/smw_button.png" alt="Powered by Semantic MediaWiki" width="88" height="31" /></a></li>
</ul>
</div>
</div>
</div><script data-cfasync="false" src="/cdn-cgi/scripts/d07b1474/cloudflare-static/email-decode.min.js"></script><script type="text/rocketscript">window.RLQ = window.RLQ || []; window.RLQ.push( function () {
mw.loader.state({"user":"ready","user.groups":"ready"});mw.loader.load(["mediawiki.toc","mediawiki.action.view.postEdit","site","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest","ext.bootstrap.scripts"]);
} );</script>
<script type="text/rocketscript">
  var _gaq = _gaq || [];
  _gaq.push(["_setAccount", "UA-1219419-1"]);
  _gaq.push(["_trackPageview"]);

  (function() {
    var ga = document.createElement("script"); ga.type = "text/javascript"; ga.async = true;
    ga.src = ("https:" == document.location.protocol ? "https://ssl" : "http://www") + ".google-analytics.com/ga.js";
    var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<script type="text/rocketscript">window.RLQ = window.RLQ || []; window.RLQ.push( function () {
mw.config.set({"wgBackendResponseTime":451});
} );</script></body>
</html>